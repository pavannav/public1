# 7.4 Step-04- Create Kubernetes Manifests for MySQL Deployment & ClusterIP Service

-: Welcome back in this lecture we are going tocreate the Myas scale deployment manifest.As part of that we are going to create environmentalvariables related to or myas scale deployment relatedto route password and all those stuff.And we are going to create the volume mountsand then also create the volumes for our container, right?In addition to that, we are also going tocreate my skill flash IP service manifest.So let's go ahead and then do that now.So let's go to our visual studio cordand we will start with our myas skill deployment.So as we should we'll startwith a version and then kind metadata and spec, right?And now our kind is nothing but we are going touse deployment and it's question is apps slash V oneand we are going to say metadata.We are going to say the nameas we are going to create a Myas skill deployment.So I'll just say Myas skilland under spec we'll have three top level objects.Okay? So ideally we'll have something called replicasand we'll have selector in generaland then template which is nothing but our port templatewhatever we are going to write.But here we are also going to have one more extrawhich is nothing.But if you want we can define usually strategy.Okay? So our strategy type is going to be rollingup data recreate, okay?So we are going to say recreate, it's a database, right?So whenever this pod pyramids again recreate that pod, okay?So that's what we are saying.It'll always be only one replica, this databaseand we really don't need to have any rolling updatesof those stuff.Okay? And the selector, we knowthat we'll have something called match labels under that.So let's define our match label is appis equal to Myas skill.Okay? So the same thing we need to definefor our container related template.Metadata labels also.Okay, so nowunder template again we are going to have two things, right?So one is metadata of your part and second is spec.Okay? So nowunder metadata you are going to define if ideally itwe really don't need to define the name of our part herebecause it is part of the deployment, right?So if we define labels, that will be sufficient, okay?And it should be same as our perspective match labelswhatever we define here, app is equal to Myas skill.So now under the spec we'll have the child elementsone is containers and the other is volumes.Okay? So two things earlier we used to have only containersin our previous whateverin our Kubernetes fundamentals are everywhere.So now we are introducing the concept of volumes.So we are going to also add volumes here.Okay? So now in the pod template spec we have createdwe are going to add containers and then volumes.So let's start with the containers now.So under containers we are going to have a nameof my container, okay?And image name, right?And so name of my container is myas skill and I'm going touse the myki 5.6 container image, okay?And now container is done.So something I need to provide for con myas skillcontainer is and environmental variables.Okay? So I'm going to define those things, okay?So that is going to be what are those things?Okay, my SQ underscore root underscore passwordand it's value is going to be DB password one month.So we are going to use DB password one one, right?So for the container, one more thing important isright ports.So let's define that portsright? So I'll sayContainer port is equal 3, 3 0 6 and name up this port.I can say Maya skill port, right?So that's the thing so far.Now we'll leave it here and then we'll under containersfor this container we have the environmental variableand all those stuff defined.So, now if you see here you can find a little bitof mistake here you can see, right?So under containers you have a container named Myas skilland the image.So this and ENV and then ports also part of this containerright name Myas skill.So we need to do this way.So now if you see name, image, ENV ports all areunder single line, you can see that, right?So that's good.So now the next thing is volumes.Okay? So these are again one more top level, rightunder spec one is containers, another is volumes.So we are going to define two volumes here.Okay? So now let's start with the first volume.Okay? So, and the name of the volume isMyas skill Persistent Storage.And here we are going to mount persistent volumeclaim and claim name.I am going to provide this EBS Myas skill PV claim.So whatever we have created here, right?EBS myas skill, Levy claim the same thing,it should be here.Okay? So now what happened is we have mountedfor our respective container one volume, which isMyas Skill persistent storage with name and weare mounting the persistent volume claimNamer EBS myas skill claim.So one more we need to map, which is nothing but ourConfig map user management DB creation scriptwe are going to map it.Okay so user, so we can go here and then get that name.So it's a big name.So let's copy it here and then come back.Where is this?Here right and paste the name here.Okay. And now we are going to have something called, it isoff type config map, right?And what is the name of the config map?It is going to be the same thing, whatever we havecopied just now.Okay, and I'll say script.Good. So now we have mounted volumes also.So now these volumes we are going to use as volume mountsinside our container, right?So these are the volumes available for us which we need tomount in our respective container.Namer Myas skill, okay, so let's go ahead and thenmount those volumes in our container.So for that purpose equal and like how name image Eand reports at the same level you need to write somethingcalled volume mounts.Okay? So now you can define here name of the mountand the mount path.Okay so now name of the mount isMyas skill Persistent Storage.So I can give thatSame name here, right?And Mount Path I'm going to use is where Live Myas skillokay? So which is nothing but the storageof Myas skill will be presenting via lab Myas skill.So we are mounting that folderto our container Myas skill container.So one more we will have, so again meand then mount but okay and we are going tomount the user management DB creation script.Okay? And when you want to mount itduring the docker entry point initiation db dot D.Okay? So we'll see what it is shortly.Okay, so Docker entry point in DB dot D.So let's come back.What does Docker entry point in DB do?So when a container is startedfor the first time a new databasewith the specified name will be createdand initialized with the provided configuration variables.So we are going to create user MGMT database thereand using the data skill, my db script do skill, okayso whenever the container starts for the first timeso it is going to create that.So that's what we have created it in our config mapthe drop if any database existsand then create that database, User mgmtand then mount it.Okay, so mount it here so thatand then use that docker entry point.You need DB here.Whenever you mount then the mount part you aregoing to use docker entry point.You need db so that it isit is going to run this script wheneverthe first time the container is going to start.So it'll run this Myas skill user managementdot skill script.So that's about it.So now we are going to go aheadand then create our plus tripe service Now.So we have completed that deployment partwhich is nothing but the Myas skill deployment.We have completed if you want we can see one more time.So we have created the base template here and thenafter that we under the spec we have somethingcan the replica selector strategy and then template.So template is port template strategiesas it is database it need to recreate.There is no rollingor another strategies upload, standard recreate type.We are going to applyand selector is going to be under match labels app.Myas skill and replica always it is going to be one part.So it is one.And now under the port templateas usual metadata and spec will be availableand the metadata we have defined our part labelas app is equal to myas skill.And then a spec will have two things herecontainers and then volumes.So we have created two volumes.One is further persistent storage, mapping it with our ebsmyas skill PV claim, whatever we have created.And the second is user management DB creation script.That is nothing but the config map.We have map those two volumesand then these two volumes will be mapto our respect to part.And from part we are going to mount it to our containerwhich is nothing but our volume mounts here.And in the volume mount we are going to create a mountfor myas skill persistent storageunder the mount point where live Myas skillwhich is nothingbut the core Myas skill database storage data files partand the another is user management DB creation scriptunder the mound pathDocker entry point in it, db, which is nothingbut whenever our container is going to startfor the first time, so whatever is presentin the config map, it is going to run.So that's about the myas skill deployment.In our next step we are going tocreate the cluster tripe service.So let's go ahead and then create the first timewhich is nothing, but we one and the kind is equalto service and I'm going to say metadataand I'm going to say name, which is going to be Myas skill.Okay? So and next is going to be spec and it is a service.So and it is a cluster P servicewhatever we are going to create.So we are going to have selector and then ports usually.Okay? So, and I'm going to give the ports 33 0 6, okay?And selector is going to be app is equal to myas skillwhich means whatever that traffic comes to this serviceit need to route to the pod.Who's the selector who label matcheswith app is called myas skill.Now another thing important here is we alreadyknow that Myas skill deployment is going tobe always only one pod.So which is nothing, but this is the only one part.So we are not going to scale itor we are not going to have multiple replicasif we know that is going to happen.So we can do one more setting in our servicewhich is nothing, but cluster IP is equal to none.What does this mean?This means, okayso we are going to use for IP directly, okay?So we really don't need to allocate a separate IP addressin our network for this respect to cluster IP service.Myas skill, we can leverage directly using the port ip.Whenever you say cluster IP is none.So that's about the entire spec creationwhatever we have created for myas skill deploymentand then myas skill service.So this completes the step twowhich is nothing but creating off our entire manifest, okay?Storage class, persistent volume claim, user managementconfig map, myas skill deploymentand then myas skill cluster strip service.Okay? So in our next lecture we are going tocreate these things and then test these things, connectto that Myas skill database and then test it end to end.So I'll see you in the next lecture.Until then, bye bye.Thank you.