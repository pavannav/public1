# 25.2 Step-02- Microservices Deployment on EKS - Introduction

-: Welcome back.In this section we are going to workon a microservices deployment.So in addition to whatever we have used earlierelastic load balancing, classic networkall these load balancers,we are also going to add one more AWS serviceas part of this, which is simple email service.So we'll see why we are going to use additional serviceof AWS for our microservices.We are going to look into now.So we are going to have two microservicesand one is user management microserviceand which are going to have the following APIs inside that.So create user API, list users, delete userand then health status.Even we'll have some other APIswhich we really don't need, update API and other stuff.And so whenever we create a userit is going to store that user in the users DB.So now we are going to have one more microservice.Already we have discussed that microservicesare independent units of our corewhich means like they're completely independentand then we will be able to call from one microserviceto another microservice.So with that said, so we are going to have one moremicroservice named notification microservice.So it is going to have somethingcalled send notification API and its own health status API.So what happens now?So and when you need to send a notificationit need to connect to the SMTP server.So what does this notification mean?So whenever a user is createdit is going to send an email using SMTP server.So let's see, in a step by step manner.So as a API developer or API user or whoever it isso if he tries to create a user using Postman Client, right?So whenever we create a user,so the user gets first stored in users DBand then this respective create user APIfrom user management microservicegoing to call the send notification API.So whenever a new user is createdso we need to send a notificationfor that respective user's email address.So we'll call the send notification API.So the email will be triggeredand using the AWS SMTP service.So we are going to send the email to the end user.So this is what the overall use casefrom microservices perspective.So which we are going to deployon the elastic Kubernetes service.So let's see all these things in a architectural pattern.So we have seen in a functional patternhow this is going to work so far, right?So let's see in architectural patternhow this is going to fiton elastic Kubernetes service on AWS.Moving on.So microservices deployment on AWS EKS.So we are in AWS cloudand whenever we create the EKS cluster,so which is nothing but the cluster control planewe can call it asand it creates our VPC respective subnetsand public, private subnets and equivalent not gateways.Okay? So now whenever we create a node groupEKS manager node groupand we are creating it in private subnetwhich will be more real to the real time use case.So we are not trying something on public subnet.So we are trying to be more realisticin real time how it is going to be.So we are creating it on the private subnet.So in this we have created a two node node group.So which will have worker node one and then worker node two.So as soon as these are createdthe outbound communication for these worker noteswill be via NAT gatewayand even to the EKS cluster control plan.Are any workload deployed here want to accessto the external environment?They go where? NAT gateway only. Okay.So now moving on the next step is,so notification microservice deployment.So right, as usual, we already know thatif you want to create any, create a deployment on Kuberneteswe already know that we are going to havea deployment manifestand to expose it we are going to have a service manifest,correct? Right?So notification microservice, we are going todeploy that respective application as two pods.And then what we are going to do isthis notification microservice needs accessto our SMTP server.So we are going to use SMTP serveras simple email servicing AWS.So we are going to create a SMTP external name servicein our Kubernetes cluster.So wherein this notification servicecalls this simple email service end pointsvia external name service present inside this worker nodes.Okay, So now the next thing isthis notification service should be calledby the user management service.So for that purpose, this notification service needsit means like this notification microserviceneeds a notification cluster IP service which we created.Then what happens, right?So we are going to have a RDS DBfor our user management microservice.So for user management microservice deploymentwhenever we deploy it, it's equal in pods get deployedand using my SQ external name servicethey are going to connect to the Amazon RDS database, right?So now once they connect to the Amazon RDS databasethis application inside UMS podwhich is user management microservice applicationis going to come up online.So now the next thing isyou want to expose this user management microserviceto the internet world.So what are the options availableif I am sitting inside the private subnet?So the options available for mewhen I'm sitting in the private subnetis either the load balancer of any type.In AWS, it is going to be network load balancer,classic load balancer or Ingress load balancer.And we as we try to always use the latest and the greatestand as we are going to use microservicesin future we might have multiple microservicesconsidering the design in such a way.So we are going to use the Ingress servicewhich is nothing but application load balancer.So first we will create a UMS node port service hereand then we are going to create a Ingress service.So which is nothing but UMS Ingress service.So this UMS Ingress service will be pointedto this respective UMS node port service.So now the next thingis whenever the UMS Ingress service is created, right?So automatically it is going to use our Q1 cloud stardot Q1 cloud dot com related SSL certificatefrom the certificate managerand we are also going to use the external DNS, right?So for that purpose it is going to registerour UMS dot Q1 cloud dot com automatically here.Okay, so we are also going to register one more DNSwhich is services dot Q1 cloud dot com.So now with Ingresswe also have our route 53 DNS also registered.So as an user, my next step is to access itand then test it.So I'll try to use user management slash useror health status or whatever I want to use.I'll try to use it to access it.So all this testing, I'm going to do it via Postman.So this is the endpoint for our create user.So when I'm trying to create a user, what happens?The request will come to the Ingress serviceand from there slash starwe have directly routing to all to the UMS bot.So the request will come to UMS node port service,and then from there it will splitand then do the load balancingbetween UMS pods present there. Okay?And then from there it will go aheadand then go to the external name serviceand then create that user inside the RDS database.So once the user is created in the RDS databasethen it need to call the notification service, right?So it will call the notification cluster IP servicewhich will send that trafficto the notification respective pod.And then notification servicewill call the SMTP external name serviceto send the email via simple email service.So now the simple email servicewill send the email to the respective end userand then there they'll be able to see the email.So this is the entire architecturewe are going to build now, right?Means like this is the entire stuffwe are going to implementas part of microservices deployment on AWS E case.So I'll see you in the next lecture.Until then, bye bye.Thank you.