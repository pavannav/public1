# 5.5 Step-06- Create ReplicaSets using YAML

-: Welcome back.In this lecture,we are going to create the definition,YAML definition for our ReplicaSets.So this is nothing but 08-ReplicaSets.So let's go here,and as a step one,we are going to create the ReplicaSet definition.And then as a step two,we are going to create ReplicaSet and then verify it.And as a step three,we are going to create the NodePort service,and then access it via browser,and then test it, right?So let's go to our Visual Studio Code.And if you see here,01 is the kube-base-definition,which will have apiVersion, kind, metadata, and then spec.So let me copy this.Go to our 02-replicaset-definition, which is empty.I copied these things.And then, let's move on to find the API versionby referring our documentation here, okay?So Kubenetes API Reference Doc for ReplicaSetis v1 apps, okay?So, which is nothing but group is appsand then version is v1.So let's make it as apps/v1, okay?So if it is core,we really don't need to mention it is core.Just if you type v1, it is good.But if it is apps, then we can say apps/v1.And the kind is going to be ReplicaSet.We can see it here.So now one important thing here is,90% of the cases, or many cases what we know,always a ReplicaSet will get createdor triggered by creating a deployment.So which means like 99.99% we try to create a deployment,and automatically a ReplicaSet get created.But why we are learning first ReplicaSetand then moving to deploymentis both are same.It's not a different thing.But if you change this to deployment,the same thing, entire definition,whatever we are going to create nowis going to match with the ReplicaSet.And in addition to ReplicaSet,we can keep adding more and more features under the specwhen you add as a deployment, okay?But when it is a ReplicaSet,it is only a few things you can add here.But let's learn few things now,and then extend it to become a deploymentin our next lectures, okay?Always a deployment is a superset of the ReplicaSet,or you can say that ReplicaSetis a small subset of the deployment features, okay?So now let's go to metadata.In metadata, we already know,Enter and then Tab, and then name, right?So this is a dictionary.So we are going to say name is going to bewhatever we want, okay?So, myapp2-rs.rs is nothing but ReplicaSet, okay?So, and now let's start with the specin our ReplicaSet, okay?So we'll have three things here to discuss.So one is replicas, okay?So second is selector,and third is template, okay?So now replicas are going to benothing but how many replicas.Again, these are,spec is a dictionary object,and then you have three types of properties under it.Replica, selector, and then template, okay?So let's start with replicas.So we need three pods to be created using this ReplicaSet.So that type of definition you can provide herefor the replicas.And now the selector.Selector will have something called matchLabels, okay?Okay. So what does this mean?Is like, what is your pod definition,how I need to identify your pod definition label,and then have the same thing here.Means like whatever we define the label for our pod,the same thing need to be defined hereso that ReplicaSet will identify this is my pod definitionand that respective pod definitionneed to be ensure that it scales accordinglyor it need to be increased or decreased, everything.Means like ReplicaSet will identify your respective podbased on the label you have identified in the podand then the same labelif you mention in the match labels, okay?So let's not define anything here.Let's move to that template first, okay?So template is nothingbut your entire pod definition copyshould be present under the template.So you already know that we have defined a pod definitionin our respective pods with YAML, okay?So let me copy.Means like let me open it in a parallel window.So how to open here is likelet's catch Ctrl and then right-clickand open to the side, okay?And let's make this simple.So now you have your pod definition here.So the entire pod definition from metadata, okay?So kind and apiVersion is not required from here, okay?So from metadataand whatever is there that is your pod definitioncomes under your template section of your ReplicaSet.So go to the starting and then paste it.So is it aligned?So now let me close this pod definitionwe really don't need, right?We copied it, okay?So now it doesn't look like aligned.So why? Because it came at the root element.But ideally, it should be under templateas a child element, okay?So what I'll say is select,and one tab, it came directly equal and to template.So I'll again type tab one more time,so that now, under template, metadata is a child element,and it has the pod name as myapp2-pod.So we are checking for two, right?So in the labels, I'll say app is equal to myapp2, okay?And spec, containers,and then container near myapp2 containeror whatever you want to put it here,that is fine, okay?So that's all.Now this is the template section.So now we need to discuss about match labels.Means like selector match labels for our ReplicaSet.So whatever the label we havepresent in our pod definition here, right,or my pod label,the same thing should be present here, okay?So I'll paste it here.So if you see now,under matchLabels, you have myapp2,which means like the ReplicaSet will identify thisas your respective pod it need to scale up or scale down.Okay? So this pod, okay?So one more change we will do here is this one, okay?So earlier, for the pods with YAML,we have done 1.0.0.So now what we'll do is like we'll use 2.0.0.So now your tag is app2.This will not be in confusion with the existing myapp-pod,whatever you have created as a single pod, okay?So you'll not have any issues related to that, okay?So now let's go ahead and then create this pod,and then test it, okay?So now we'll go here,and then now we are going to create our pod, okay?So let's go back here,and I should be in the section08-ReplicaSets-with-YAML/kube-manifests.I am inside of that.So I'll say kubectl apply -fand 02-replicaset-definition.yml.So if any issues, it is going to throw an error for us.It didn't throw any error.So get rs, it looks good.Okay, so let's wait for the response to come back.So all are running current and ready, everything is ready.Kubectl get pods, and we should see the pods running.So kubectl describe pod.And then myapp2 pod, let's describe it, okay?And see if it is 2.0.0 images running here, okay?So yeah, I download it,and then using that 2.0.0.So now one thing we can do is,we already know ReplicaSet will ensurethat always whatever the defined replicaspresent inside that,it is going to maintain the same number of replicas.So what we are going to do is kubectl get pods,and then we are going to delete one pod.And then automatically,your ReplicaSet should recreate that pod.So it's taking time.So now my ReplicaSet-related pods are running.So I'll say kubectl delete pod,and I will delete this respective pod, okay?And it's age now should be not 93 seconds, okay?So it should be lesser than that once ReplicaSet creates it.Let's cross-check that now after the deletion is completed.So one more time, kubectl get pods.So I got a timeout error. We can ignore that.So now if you see here,these two pods are with the age of two minutes,but whatever we have deleted,it automatically recreated, ReplicaSet recreated,and it is 34 seconds, okay?So in our next lecture,we'll go ahead and then create the NodePort servicefor this ReplicaSetand ensure that we access it via browser.And then in browser,we get the v2 version of our application.So I'll see you in the next lecture.Until then, bye bye. Thank you.