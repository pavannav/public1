# 25.6 Step-06- UMS & NS Microservices Deployment & Test

-: Welcome back.In this lecture, we are going to deploy all these manifestswhich is nothing but ingress service, NodePort service,microservices deployment, notification deployment,all these seven manifests,and then test it now.Okay, so let's go back to our GitHub reportand we are in our step nine,and then step 10, we are doing it right now.And then, even we'll do the health status, which is step 11.And then even step 12, okay?So which is step 12 and then step 13,all these testings we are going to perform now.So, let's go back to our step nine and then deploy it.So to deploy it, we need to bein the respective folder, right?So CD12 is nothing, but microservices deployment done EKS.So I'll say kubectl apply-f kube-manifest.Okay, so this should deploy all our Kubernetes manifestcreated as part of microservices,so which is nothing but my SQL user management microserviceand its db_password=secret,and NodePort service, notification microservice,SMTP service, notification ClusterIP service,and then EKS microservices demo ingress service, okay?So now, if I say kubectl get ports,so it's running,so which means, like, notification already up.So we can say kubectl logs -f,and then we have, straight away,of multiple ports are running.We can even run the commands like this, okay?So I will say this way, so...Okay, we really don't need to worryabout the what is present here.So it is a part related extra name, okay?So I have added this with EIGRPso that you can just take this commandand then cross secure locks, okay?So started notification service,we really don't have anything issuewith notification service.So now, we'll also verify our user management service, okay?So I'll paste it now here,verifying the logs of our user management service.So it also started, so which means everything is good.So I'll also execute kubectl get ports,so all are running, ready, ready, ready, ready.Okay, so, good.So now, we are going to also verify our external DNS logs,so it should add the stuffrelated to our two new DNS entries for us, right?So which is services and then UMS, okay?So whatever we have configuredon our prospective ingress manifest,services and then services.kubeoncloud.comand then ums.kubeoncloud.com.Good, so they have created it.So now, we will go back to our EC2, right?So and verify our load balancer also.So only we should have user managementstandard deployment only,so it should be running,user management microservice related stuff.So load balancer is provisioning, it'll go to target groups,so it is still waiting.So it is waiting for the registration,so we'll wait for it to get completed.In meantime, if you want, we can crosscheck,go to route 53 and then crosscheck our DNS names.So let me close this hosted zonesand, if you see here, go inside that.And if you go here, so we have services.kubeoncloud.comand then ums.kubeoncloud.com.So everything looks good.So now our next step is to go aheadand then verify the stuffonce the load balancer is open running.So here, kubectl get ingress, so it's good.So go to load balancer and it is active now.So as usual, we always do the NS lookup test,so copy, and then I'll say nslookup and then paste it.So I got the IPS 104 here, something,and then something.63.So I'll say nslookup.nslookup services.kubeoncloud.com.So same, 63 and then 104.In the same way, I'll also say, "For UMS," right?So user management microservice.It's the same, 104 and then 63.Good, so now we'll go aheadand then verify our...These things, okay?User management microservice health status, okay?And it should be up and running, see?User management microservices up and running.So from user management microservice only,you can call the notification health status.So I have done the coding in such a way.So now, why?Because whatever you want,you can call from your notification,means, like, from user management,you can call the notification for send notification, right?In the same way, for health status also,you can call the same way.So I am calling it, okay?And what happens?We'll see notification services up and running V1.And if you want, you can even additionalnotification service information will be there,so which is related to printing the hostname, okay?So you can see notification microservice 655 something,and then BJKXF, okay?So this should be related to our kubectl get ports, right?So you can see notification port is BJKXFwhich matches here we are printing the hostnameof our notification microservice, okay?Means like the Docker container respective hostname.So this completes the verification, right?So, verification of microservice health status stuff.But now, we need to import our Postman projectand then test it, okay?So we need to import the Postman project for us,so it should be available here,AWS EKS masterclass, microservices, Postman collection.So you can go to your Postmanand then just import that file, okay?Or you already has done this work in step 0403 also,once when you're doingwith the user management microservice with MySQL DB,so when you are doing this in your EBS block store,you have done this step already.But just for additional thing,I also added the same Postman project here alsofor your referencing dual microservices deployment on EKS.Okay, so now let's go back to our Postmanand then, first, what we need to dowhenever we go into the Postman,the first step for our series in the step 12is to create our environment, okay?So, let's go here and then add environmental URL,which is nothing but services.kubeoncloud.com.So here is the Settings, Manage Environments,so I'll click on this,and then earlier we tested ALB ingress, CLB, NLB,UMS, NodePort,now, we are testing this one, right?So what is this?This section is related to microservices,microservices on EKS,and the URL will be this one,and this value, initial value should be this one,HTTPS and whatever your domain.comMine is kubeoncloud.com.Whenever I put it here,current value also should be the same thing.So, always the same valueshould be initial value on current valueand always it picks from the current value only.So, you need to ensure that whenever you enter the datain initial value,current value is auto-populated.Add it, close it, and now if you go here,no environment, too.I need to select microservices on EKS.So, this is the environment we created,microservices on EKS.First, I'll test the health status and we got it.This is good, okay?And I'll list the users, right?So mostly admin two, admin three, ALB test two,some users are there here, okay, right?So we can leave those users as isor, if you want, we can delete all those.Okay, so I'll say ALB test two, so I'll delete those,ALB test three.So some users are there, which I have deleted,so, which I really don't need them.So now, if I go and then list all users,so I should have admin two, admin three,and then alb some basic, okay?So that's fine. Three users are there.No, I'm going to create a user.So I'm going to say, "Body."And one thing we need to be importantis what is the, in SCS,what is the thing you have identifiedas your second email address?Two email address, right?So, that one you need to crosscheck.Okay, so let's go to simple email addressand go to email addresses.So we designated stacks, this as our from email addressand then dkalyanreddy as my two email address.So now, here are the two email addresses,dkalyanreddy@gmail.com.So I'm going to test microtest1.My username is microtest1,and first name is Micro F nameand Micro L name, okay.So now, I'm going to create the user.So earlier, you have seen that you usedto get notification related, service related, 500 error.So now, that should not be the case.So sent request, so I got the 200, right?So which means if you list the users,so micro-related user should be created now.So microtest1 user got created.So now if I go to my Gmail and verify it,so I got the email now, you can see it."Hello, micro EF name,your Stack Simplify account is created successfully," right?So which means, just now, I got it zero minutes back.'Hello, micro EF name,your Stack Simplify account is created successfully."So which confirms us that.So whenever from here I have done a Create User,so that user, whatever is created using UMS parthas been stored in RDS DB.So that's what the list users tell us, right?So user is successfully stored in RDS DB.And then, UMS next call the notification service,which went to the notification service part,and then, from there, it called the simple email serviceand then send the email to the end user.So that's the thing.If you want, we can even test one more user, okay?So, let's go here to our Create User,and we can even say microtest2, right?And then, I will say, "Send," right?So see, "User with email address already exists,"so you cannot use the same email addressfor your multiple users.So, that's the exception I have created in the course,in the respect to code.So that's the reason,one more email address with that is not accepting.So what you can do,so now, if you want to add one more email address,so you need to go hereand then first verify a new email address.So I'll say stacksimplifydev2@gmail.com.Verify this email address, okay?So I will go here and I'll go to stacksimplifydev2,and I got the verification email, right?So this should be successful.Now, I verified it.So I'll go back here and then refresh it.So one more email, I have added stacksimplifydev2.So now, I'll go here, which one?Postman and my micro test, right?So if you see list all users,I have only microtest1, right?Right, user not created.So test two with the email as stacksimplifydev2, right?And save and then send.Okay, user got created.So let's see in the list users if user exists, right?So microtest2 came here,and let's go here, and then verify the email.So you can see email."Hello, Micro F Name.Your Stack simplify account is created."That's all. Good, right?So this completes the microservices implementation here,end-to-end in a Kubernetes cluster on AWSwith the AWS related services.So you have user, the EKS cluster,you have user Route 53, you have user certificate manager,you have user simply email service, RDS service,all this stuff, right?Our application load balancer. So, like this.And then NAT gateway was for outbound communication, right?So whatever you are seeing,simple external email service, the outbound,so this is going via NAT gateway, if you see here.So I just put it directly, but it goes via NAT gatewayand then go to the simple email service, in general, why?Because from private subnet,it cannot go direct to simple email service, right?So it goes via NAT gateway,and from NAT gateway, it goes to the simple email service.So that's about it.All in all, this is what the entire microservicesdeployment on AWS EKS.So I'll see you in the next lecture until then, bye-bye.Thank you.So if you want to clean up,so then we can go ahead and then do the same step as usual.So kubectl delete -f kube-manifest, okay?So, but what we are going to doin our next four or five steps is like, before cleanup,we are going to perform additional stuff herewhich is nothing but roll out new deploymentswith the three options we have,which is set image option, QCTL edit,and then update manifests.So how to roll out new releases to our applications?We are going to see all those three optionsand then do the cleanup.So I'll see you in the next lecture.Until then, bye-bye. Thank you.