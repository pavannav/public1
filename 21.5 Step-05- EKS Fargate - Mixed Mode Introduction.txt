# 21.5 Step-05- EKS Fargate - Mixed Mode Introduction

-: Welcome back.In this lecture we are going to understandabout Fargate profiles creation with YAML.So let's see what we are going to learn.All in all, so we are goinginto inside 0 9 0 2 Fargate profiles, advanced YAML.So as part of this, what are we going to learn isso we are going to deploy three appsin a mixer mode deployment.So which means one app to our EKS manager node groupwhich is with EC2 and two appswe are going to deploy to two different Fargate profiles.So as part of that, to create those two Fargate profileswe need to write the YAMLand then create those two Fargate profiles at a time.Earlier we have user the command to create itin our 0 9 0 1.So to create a Fargate profile.So we have user the command.So like this if you want to create 10 profilesso you need to run 10 times the command.Instead of that, we are going to do that using a YAML file.So like this, so we'll discussabout this later but for now we'll go backand then understand what are the three apps andthen how we are going to deploy the detailed architecture.Let's see what are those three apps and thenhow we are going to deploy in a visual manner, right?So in AWS cloud we have a VPCand inside VPC we are going to haveboth the EKS manager node groupsand then EKS Fargate profiles.So in a EKS cluster we are going to have both Fargateprofiles and then manage the node groups together.So that is nothing but we call it as mix it more, right?So what happens here is like as usual we'll haveour availability zones and then subnets, right?Sofrom Fargate perspective it only supports private subnets.So if you see here, here we have only private subnetsand managing node groups can be createdin both private and public subnets.But as partof this section we are only, we have alreadyan existing private subnet related EKS manage node group.So that's the reason I have rounded it to only this partand the in this public subnets we are going todeploy our ingress related services.So now what happens is as part ofFargatewhenever we bring the Fargate into the pictureso the organizationof apps is going to be with the name spaces, right?So how we are going to organize this with name spaces.So for this EKS manager node groupwhatever the application NS app one meanslike app one whatever we are going to deployfor that we have created a name space NS app onein the same way for app two we are going tocreate a namespace app two and then for application UMSwhich is user management microservice.So we are going to have the name space as NS UMS.So now NS app two will be part of one Fargate profileNS UMS will be part of another Fargate profileand NS app one is going to be for manage node groups meanslike these namespaces are not tied to anything specifically.So, but high levelif we have that name space tied to Fargate profileso those apps will be scheduledto that respect to Fargate profile.So it's the other way around, but whatever may be the case.So now if you take my app one, rightso app one related ports I have deployedon the easy to worker notes here.So, and it'll have its own note port serviceand its own app one ingress service, okay?And in the same wayfor app two we'll have a Fargate profile with app twoand then inside that we'll deploy our app to applicationand it also will have the its own separate appto ingress service.So why we are having separate set of serviceswe'll see the next slide means like why we aregoing to have separate ingress services here.Okay? So we have seen the concepts of contextpart based routing in ALB, but why we are notusing here when we are using this mixed mode deployments.Okay? So there is a reason for that.So we'll see in the next slide.Okay, so now another thing is UMS is nothingbut user management microserviceit's ingress service need to be deployed and UMS partwhich is nothing but EMS deployment will be deployedand it's not port service and it's external limb service.And this external limb service is going to connectto the RDS database, right?So whatever we have created, soif this RDS database is not and up, up and runningfrom previous sections, whatever we have created, right?So if it is down and then if you want to start ityou can start it up.Okay? Why?Because whenever you deploy UMS, if this is notup then this port keeps failing.So now the next thing is as soon as these thingsare created, one more thing will be therewhich is external DNS to digital the DNS namesand also also say for SSL certificate certificate managerrelated certificate will be associatedin our ingress survey.Okay? So now it'll resist three DNS names app one dot cubone cloud.com app two dot cube coupon cloud.comand then UMS dot cube coupon cloud.com.So now as a user, so if I'm using means likeif I'm using app one cube coupon cloud.com and thenif I access the application I come to, I come to appon ingress and then from there I'll go to appon note port service and then from there it'll beload balancer two app, one ports, okay?Using note port service stuff.Okay? So nownow if you go to app to cuban cloud.com, it'llgo to app to ingress here and thenwe directly go to the portbecause we are going to use for target partswe are going to use target type IP our manifestin the same way for UMS UMS cuban cloud.com.So we are going to access it and the request comesto UMS part and if the request is health statusthen directly from here it'll be solve.But if the request is going to be somethinglike list users or something which is slash usersso then the request will goto external name service and then it'll go backto RDS database and then serve it back to the user.So this is the mixer mode with three appswhatever we are going to deploy mixer mode.Again, I am going to reiterate nothingbut in a same EKS cluster we are going to haveboth fargate profilesand then EKS manager easy to notes also in the same cluster.Okay? So that is nothing but the mixer mode.So moving on.So we have discussedabout why can't we use the app only one ingressfor all these things, right?So it means like one ingress for app, one UMS, and alsofor app two and then route it if it comes to app one ingressand then if it is slash app one go here and thenif it is UMS go this way and then have to go this way.So why can't we do that?Okay, so which is nothing but ingress withcross name spaces.You call it as why because you created a ingressand then this ingress whatever you are going to createright? So if you go back to the previous picture, right?So this ingress whatever the app one ingresseven though we are not specifying herein the picture app, one ingress will be partof NS app one namespace, okay?And UMS ingress will be part of NS UMS, namespaceand app two ingress will be part of NS app two namespace.Now if you see here thisone app one,this respectto ingress, if it is not part of any name spaces areif it need to go across name spaces to send that traffic.So that's not possible as on today, which means like ingresswith cross name spaces is not supportedas on today even there is a GitHub openback from 2015 onwards.But till date that is not resolved as on today.So not only in LB ingress,this is not supported as on today.So now which means this concept is not applicable here.So always if you are dealing with multiple name spacesthen always it islike each name space one ingress should be thereand inside this name space you have 10 appsthen 10 contact path based routingor host editor base at routing.Whatever the routing you want to implementyou can implement inside that name space.But outside of name spacewhich means across cross name spaces with single ingresswe will not be able to do the context path based routingor any host head based routingor any ingress related conceptswith single ingress to multiple name spaces.So with that saidwe have completed our introductory sectionand then we'll move on to advanceat Fargate profile with YAML in our next lecture.So I'll see you in the next lecture.Until then, bye bye.Thank you.