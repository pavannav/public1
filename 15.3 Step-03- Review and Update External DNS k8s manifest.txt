# 15.3 Step-03- Review and Update External DNS k8s manifest

Instructor: Welcome back. In this step,we are going to update the external DNS Kubernetes manifest.So let's go to our visual studio code here,and we are in 0806 deploy external DNS on EKSand we have the Kubernetes Kube manifest folder.And inside that we have 01 deploy external DNS.yaml.And this is the external DNS related Kubernetes manifest.And inside this, we are going to update the IM role here,whatever the role we are in we have created.So we can update it.So let's go back here.And so this is the role (indistinct), right?So let me copy it and come back here and add it here.And now the next thing, right?So let's come back here,and if you see change one line number nine,IAM role update is completed,and we'll go to line number 56-- 55 and 56,and then comment them.We used EKS CTL to create the IAM role and attach itthe allow external DNS updates policy.So we didn't use Kiam or kube2iam,so we didn't need to add these two lines.So these things are not required herein line 55 and then 56, right?So let's come back here. Where is it?So these things are commented herebecause we are not using any Kiam or kube2iam tools hereand now in this, right?So if you see here, this is the deployment specification.So if you go top, so this is theservice account related Kubernetes manifest,and these are related to cluster role,and then cluster role bindings related external DNS things.And now here you'll find the external DNS deploymentrelated Kubernetes manifest.And inside that in the pod template specificationyou are using the service account name as external DNS,and containers, you are using k8s.gcr.ioSo whatever the latest external DNS pod version available...So, we are taking today, which is as on todayV0.10.2 is the latest.So we are using this. And, in future, if it changes...So, you can change the version here accordingly.And in addition to that as part of change threeif you come back here to the documentation, right?So line 65 and 67 commented here.So what exactly that means?So this is a very important step.So 65 and 67 were commented and inside those thingsyou'll find something called domain filter ex.So if you want to filter your domain, so currentlyI remove the domain filter or I commented itwhich means this external DNS is applicableto all the hosted zones available in my AWS Route 53.So if you go back hereand go to route 53 service here or let me go from hereand go to route 53 and you'll find lotof domains available here for me in the hosted zones.So you can see here all Cloud Guru DevOpsin CloudStack simplified Terraform Guru.So like there are multiple domains available here,and for all these domains, right?So this external DNS can update, delete, create,-: -inside that, the DNS records.But if you want to do only for specific domains,-: -so, you can filter those domainsand only provide those domains.Example, if you want to provide onlyfor Stacksimplify.com, then you can providefor Stacksimplify.com like that, okay?So matching provider domain,omit it, o-- omit to process all available hosted zones.So I omitted it or commented it so that it is,it'll process all the available hosted zones for me.So I commented it and in the same way,this is another important settingwhich is policy absurd only, right?If you see here policy absurd only.So when you enable this, right?What happens is it'll be able to create the DNSbut it'll not be able to delete the DNS.So would prevent external DNS from deleting any regards.So omit to enable full synchronization.So which means if you commend thisthen this path policy absurd only when you comment itwhich means whenever you create an ingress service and thenthere you have the external DNS annotation related DNS name,so it'll go ahead and then create it.So whenever you delete that ingress service,then automatically the recordinside route 53 also will get deleted.So for full synchronization, comment this part.So, accordingly I have commented it, butif you want the external DNS to only create the DNSs,but it should not delete them at that point,un-comment this, right?And that is not going to be a full synchronizationand AWS zone type, only look at public hosted zonesand valid values are public, private are no value for both.So these are the things available for us.-: -additional setting for us. And registry type is txt,txt owner IDs, my hosted zone, identify some identifieryou can put it.So these are the things you need to pass to the external DNSpod as an argument so that it will take those things.And if you see here, it'll take the sourceas a service or a source as a ingress.So which we have discussed here, right?So if you go back here and see this, right?So your source can be, means like, your ingress service.Y--Your source can be, means like...the Kubernetes manifest can be a ingress serviceor a regular Kubernetes service of type load balancer.So that what happens is those can go ahead and thencreate the route 53 record automatically by external DNSwhenever you provide this respective annotation.So this is good. So now we have successfully reviewed this.And another important thing:You will have something here is the image name.So get the latest docker image name so you can click on thisand get a latest docker image name available and use it.So as on today it is V 0 10 0 2 available latest.So that's what we have updated here in our container's name.And then in image name we have updated this.So in our next lecture, we are going to go aheadand then deploy this external DNS.So I'll see you in the next lecture.Until then, bye bye. Thank you.