Welcome back and in this lesson I want to cover EC2 Purchase Options.
Now EC2 Purchase Options are often referred to as Launch Types, but the official way to
refer to them from AWS is Purchase Options, and so to be consistent I think it's worth
focusing on that name, so EC2 Purchase Options.
So let's step through all of the main types with a focus on the situations where you would
and wouldn't use each of them.
So let's jump in and get started.
The first purchase option that I want to talk about is the default, which is On Demand.
And On Demand is simple to explain because it's entirely unremarkable in every way.
It's the default because it's the average of anything with no specific pros or cons.
Now the way that it works, let's start with two EC2 hosts.
Obviously AWS has more, but it's easy to diagram with just the two.
Now instances of different sizes when launched using On Demand will run on these EC2 hosts,
and different AWS customers, they're all mixed up on the shared pool of EC2 hosts.
So even though instances are isolated and protected, different AWS customers launch
instances which share the same pool of underlying hardware.
Now this means that AWS can efficiently allocate resources, which is why the starting price
for On Demand in EC2 is so reasonable.
Now in terms of the price, On Demand uses per second billing, and this happens while
instances are running, so you're paying for the resources that you consume.
If you shut an instance down, logically, you don't pay for those resources.
Now other associated services such as storage, which do consume resources regardless of
if the instance is running or in a shutdown state, do charge constantly while those resources
are being consumed.
So remember this, while instances only charge while in the running state, other associated
resources may charge regardless.
So this is how On Demand works, but what types of situations should it be used for?
Well, it's the default purchase option, and so you should always start your evaluation
process by considering On Demand as your default.
For all projects, assume On Demand and move to something else if you can justify that
alternative purchase option.
With On Demand, there are no interruptions.
You launch an instance, you pay a per second charge, and barring any failures, the instance
runs until you decide otherwise.
You don't receive any capacity reservations with On Demand.
If AWS has a major failure and capacity is limited, the reserved purchase option receives
highest provisioning priority on whatever capacity remains.
And so if something is critical to your business, then you should consider an alternative rather
than using On Demand.
So On Demand does not give you any priority access to remaining capacity if there are
any major failures.
Now On Demand offers predictable pricing.
It's defined upfront.
You pay a constant price.
But there are no specific discounts.
This consistent pricing applies to the duration that you use instances.
So On Demand is suitable for short-term workloads.
Anything which you just need to provision, perform a workload, and then terminate is
ideal for On Demand.
If you're unsure about the duration or the type of workload, then again, On Demand is
ideal.
And then lastly, if you have short-term or unknown workloads which definitely can't tolerate
any interruption, then On Demand is the perfect purchase option.
Next let's talk about Spot Pricing.
And Spot is the cheapest way to get access to EC2 capacity.
Let's look at how this works visually.
Let's start with the same two EC2 hosts.
On the left we have A and on the right B.
Then on these EC2 hosts we're currently running four EC2 instances, two per host.
And let's assume for this example that all of these four instances are using the On Demand
purchase option.
So right now, with what you see on screen, the hosts are wasting capacity.
Enough capacity for four additional instances on each host is being wasted.
Spot Pricing is AWS selling that spare capacity at a discounted rate.
The way that it works is that within each region, for each type of instance, there is
a given amount of free capacity on EC2 hosts at any time.
AWS tracks this and it publishes a price for how much it costs to use that capacity.
And this price is the Spot Price.
Now you can offer to pay more than the Spot Price, but this is a maximum.
You'll only ever pay the current Spot Price for the type of instance in the specific region
where you provision services.
So let's say that there are two different customers who want to provision four instances
each.
The first customer sets a maximum price of four gold coins and the other customer sets
a maximum price of two gold coins.
Now obviously AWS don't charge in gold coins and there are more than two EC2 hosts, but
it's just easier to represent it in this way.
Now because the current Spot Price set by AWS is only two gold coins, then both customers
are only paying two gold coins a second for their instances.
Even though customer one has offered to pay more, this is their maximum and they only
ever pay the current Spot Price.
So let's say now that the free capacity is getting a little bit on the low side, AWS
are getting nervous, they know that they need to free up capacity for the normal on-demand
instances which they know are about to launch, and so they up the Spot Price to four gold
coins.
Now customer one is fine because they've set a maximum price of four coins, and so now
they start paying four coins because that's what the current Spot Price is.
Customer two, they've set their maximum price at two coins, and so their instances are terminated.
If the Spot Price goes above your maximum price, then any Spot Instances which you have
are terminated.
That's the critical part to understand, because Spot Instances should not be viewed as reliable.
At this point in our example, maybe another customer decides to launch four on-demand
instances, AWS sell that capacity at the normal on-demand rates which are higher and
no capacity is wasted.
Spot Pricing offers up to a 90% reduction versus the price of on-demand, and there are
some significant trade-offs that you need to be aware of.
You should never use the Spot Purchase option for workloads which can't tolerate interruptions.
No matter how well you manage your maximum Spot Price, there are going to be periods
when instances are terminated.
If you run workloads where that's a problem, don't use Spot.
This means that workloads such as domain controllers, mail servers, traditional websites, or even
flight control systems are all bad fits for Spot Instances.
The types of scenarios which are good fits for using Spot Instances are things which
are not time critical.
Since the Spot Price changes throughout each day and throughout days of the week, if you're
able to process workloads around this, then you can take advantage of the maximum cost
benefits for using Spot.
Anything which can tolerate interruption and just rerun is ideal for Spot Instances.
So if you have highly parallel workloads which can be broken into hundreds or thousands of
pieces, maybe scientific analysis, and if any parts which fail can be rerun, then Spot
is ideal.
Anything which has a bursty capacity need, maybe media processing, image processing,
any cost-sensitive workloads which wouldn't be economical to do using normal on-demand
instances, assuming they can tolerate interruption, these are ideal for Spot.
Anything which is stateless, where the state of the user session is not stored on the
instances themselves, meaning they can handle disruption, again, ideal for using Spot.
Don't use Spot for anything that's long-term, anything that requires consistent, reliable
compute, any business-critical things or things which cannot tolerate disruption.
For those type of workloads, you should not use Spot.
It's an anti-pattern.
OK, so this is the end of part one of this lesson.
It was getting a little bit on the long side and I wanted to give you the opportunity to
take a small break, maybe stretch your legs or make a coffee.
Now part two will continue immediately from this point, so go ahead, complete this video
and when you're ready, I'll look forward to you joining me in part two.
