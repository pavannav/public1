Welcome back and in this lesson I want to cover something which starts to feature much more in AWS exams
and that's CloudFront Lambda at Edge
You don't need to have any experience implementing it
but you do need to know how it's architected and what it's capable of doing
so let's jump in and get started
Lambda at Edge is a feature of CloudFront which allows you to run lightweight Lambda functions
at CloudFront Edge locations
Now these Lambda functions can adjust traffic between the viewer and the origin in a number of interesting ways
and we'll talk about some of those soon
Now there are some limitations that you need to be aware of
because the Lambda functions are running at the Edge they don't have the full Lambda feature set
so currently only Node.js and Python are supported as runtimes
You can't access any VPC based resources since the functions are running in the AWS public zone
and additionally Lambda layers are not supported
Lastly the functions have different size and execution time limits versus normal Lambda
Now you don't need to memorize all of these facts
what's more important is a good understanding of the architecture
so let's look at that next
Lambda at the Edge starts with the traditional CloudFront architecture
so customers on the left, the edge locations in the middle and the origins on the right
Now any interaction between a customer, edge location and origin consists of four individual parts of that communication
The connection between the customer and the edge location which is known as the viewer request
Then you've got the connection between the edge location and the origin known as the origin request
Next when the origin responds there's a connection between the origin and the CloudFront edge
known as the origin response
and then finally the connection between the edge location and the customer known as the viewer response
Now with Lambda at the Edge each of these individual components of the wider communication
can run a Lambda function and this Lambda function can influence the traffic as part of that connection
So a viewer request Lambda function runs after the CloudFront edge location receives a request from a viewer
an origin request function runs before CloudFront forwards that request onto the origin
an origin response function runs after CloudFront receives a reply from the origin
and then finally a viewer response function runs before the response is forwarded back to the viewer
Now there are limits on how the Lambda functions can run in each part of the architecture
At the viewer side a Lambda at Edge function has a limit of 128 MB for memory allocation and a function timeout of 5 seconds
At the origin side the memory limits are the same as a normal Lambda but with a 30 second timeout
Now again don't worry too much about these limits, for now try to focus at a high level on what these limits mean
what types of architectures and what type of adjustments these Lambda functions can perform on each of these different components
of the flow of data between a viewer and an origin and back again
Now let's look at some example solutions which involve Lambda at the Edge
Now I've included a link attached to this lesson which gives a few examples of situations where you would use Lambda at the Edge
Now I can't give an exhaustive list in this lesson because just like Lambda itself you can pretty much do anything that you want
as long as you can code it within a Lambda environment
but a couple of common examples that you might find useful for the exam
First you can use Lambda at the Edge to perform A-B testing and this is generally done with a viewer request function
You can use a viewer request function in an A-B testing scenario to present two different versions of an image
without creating redirects or changing the URL
In this architecture the function views the viewer request and modifies the request URL
based on which version of an image you want the viewer to receive
With this architecture the Lambda function can modify the viewer request and change the URL based on any logic that you can define inside a Lambda function
It can be things like a percentage based algorithm or it can be random chance
Another scenario which you might use Lambda at the Edge for is running a function as part of the origin request
and this can be used to perform a gradual migration between different S3 origins
You can use a function running in this part of the architecture to gradually transfer traffic from an existing S3 origin over to a new one
and you can do so in a controlled way
For example based on a weighted value which represents a percentage of the traffic of your application
So over time you can increase the percentage of traffic which goes to the new S3 origin versus the old
and all of this can be done in a controlled way without updating the CloudFront distribution
Now you can also use Lambda at the Edge to customize behavior based on the type of device that your customer has
So given a particular type of device or a particular capability of that device you can display different objects
Now this might include different sizes of objects or objects with different quality levels
For example if you have a device which has a high DPI screen so a higher dots per inch
then you might want to display objects which themselves have a higher DPI value
and save lower DPI objects for devices which can't support high DPI
So again that's something that you can use Lambda at the Edge for rather than making any changes to the CloudFront distribution
You can also use Lambda at the Edge to vary the content displayed by country
So a Lambda function that's running in the origin request component of the communication
can be used to adjust what gets displayed based on the country of the customer
Now the link that I've included attached to this lesson gives a lot more examples of the types of scenarios
that would benefit from Lambda at the Edge
And in addition to the scenarios most of these include example Lambda function code that you can implement in your own environments
So this is going to be something that's outside of the scope of this course
You only need to be aware of the architecture of Lambda at the Edge for this certification
But if you do want to experiment with this in your own time then you can use the examples contained on this page
And again the URL is attached to the lesson and you can do your own experimentation
But at this point that's all of the architecture that I wanted to cover in this lesson
I just want you to be aware of exactly what Lambda at Edge can be used for because you might get a question on it in the exam
So make sure that you're comfortable with all of the examples that I've given in this lesson
and all of the examples which are included on the link that I've attached to this lesson
Again you won't need to remember all of the different facts and the execution limits and the memory amounts
It's all about the architecture
So if you familiarise yourself with all of the examples that are on screen now and the ones that are in the link attached to this lesson
Then you'll have all of the information that you need to answer questions about this topic in the exam
But at this point that's all of the theory that I wanted to cover in this lesson
So go ahead, complete the lesson and then when you're ready I'll look forward to you joining me in the next
lesson
