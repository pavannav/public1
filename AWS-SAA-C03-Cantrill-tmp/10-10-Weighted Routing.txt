Welcome back, in this video I want to talk about weighted routing, which is another routing
policy available within Route 53.
So let's jump in and get started straight away.
Weighted routing can be used when you're looking for a simple form of load balancing
or when you want to test new versions of software.
Like all other types of routing policy, it starts with a hosted zone.
And in this hosted zone, you guessed it, records.
In this case, three WWW records.
Now these are all A records, and so they point at IP addresses.
And let's assume that these are three EC2 instances.
With weighted routing, you're able to specify a weight for each record, and this is called
the record weight.
Let's assume 40 for the top record, 40 for the middle, and 20 for the record at the bottom.
Now how this record weight works is that for a given name, WWW in this case, the total
weight is calculated.
So 40 plus 40 plus 20 for a total of 100.
Each record then gets returned based on its weighting versus the total weight.
So in this example, it means that the top record is returned 40% of the time, the middle
also 40% of the time, and the bottom record gets returned 20% of the time.
Setting a record weight to 0 means that it's never returned, so you can do this if temporarily
you don't want a particular record to be returned, unless all of the records are set
to 0, in which case they're all returned.
So any of the records with the same name are returned based on its weight versus the total
weight.
I've kept this example simple by using record weights that total 100 so it makes it easy
to view them as percentages, but the same formula is used regardless.
An individual record is returned based on its weight versus the total weight.
Now you can combine weighted routing with health checks, and if you do so, when a record
is selected based on the above weight calculation, if that record is unhealthy, then the process
repeats.
It's skipped over until a healthy record is selected, and then that one's returned.
Health checks don't remove records from the calculation, and so don't adjust the total
weight.
The process is followed normally, but if an unhealthy record is selected to be returned,
it's just skipped over and the process repeats until a healthy record is selected.
Now weighted routing, as I mentioned at the start, is great for very simple load balancing
or when you want to test new software versions.
If you want to have 5% of resolution requests go to a particular server which is running
a new version of Catagram, then you have that option.
So weighted routing is really useful when you have a group of records with the same
name and want to control the distribution, so the amount of time that each of them is
returned in response to queries.
Now that's everything I wanted to cover in this video, so go ahead, finish the video,
and when you're ready, I'll look forward to you joining me in the next.
