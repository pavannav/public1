Welcome back and in this lesson I want to quickly step through the architecture of CloudFront behaviors.
Now I've introduced them earlier in this section. You need to have a good grasp of what options are set at the distribution level and what is configured within a behavior.
Now as I've already introduced behaviors, it's going to be easier for me to show you rather than tell you the detail of behaviors and how behaviors fit in to the wider CloudFront components.
So I'm going to switch over to my console and step through all of the features and exactly how things work.
Okay, so let's take a look at some behaviors. So I'm going to go ahead and move to the CloudFront console.
So I'll click on services and type CloudFront. Select it from the list.
Now I've got two CloudFront distributions. One of them is production and one of them is for my testing.
So the production one's blurred out. I'm just going to go ahead and move into my testing distribution.
So distributions are the unit of configuration within CloudFront and you'll see that there are lots of high level options which are configured at a distribution level.
So it's here where all of the main important configuration options for the distribution are configured.
So let's take a look at some of them. So first we've got the price class.
The price class determines which edge locations your distribution is deployed to.
So you can make CloudFront slightly cheaper by selecting to only deploy the distribution to US, Canada and Europe based edge locations.
This will result in a slightly reduced level of performance for any users not in those regions.
You can elect to use all of the edge locations which provides the best performance or use the option in between which deploys to only the US, Canada, Europe, Asia, the Middle East and Africa.
So normally I like to deploy out to all edge locations because I prioritize customer performance.
But you do have the ability to narrow this down and select only the US, Canada and Europe for deployment.
So just keep that in mind. It's also to a distribution that you're able to associate a web application firewall.
So this is a layer 7 firewall product available within AWS.
Now I'll be covering this elsewhere in the course, but it's at a distribution level that you can configure this integration.
So you create a web ACL within the WAF product and then associate it with a CloudFront distribution.
It's also at a distribution level that you can configure alternate domain names for your CloudFront distribution.
So notice how my CloudFront distribution has this default domain name which is the random string which is unique for this distribution and then followed by CloudFront.net.
So this is the default, but I did configure an alternate domain name which is labs-bucket.cantrell.io and this is added at a distribution level.
It's also at the distribution level that you can configure the type of SSL certificate that you want to use with the CloudFront distribution.
Now I'll be talking about this elsewhere in this section where I focus specifically on CloudFront and SSL,
but you're able to use the default certificate as long as you're using that default DNS name.
If you want to use an alternate domain name and use that with HTTPS, then you need to use a custom SSL certificate.
And when you're using a custom SSL certificate that's defined also at the distribution level, it uses ACM and you have to pick between SNI and non-SNI.
And I'll be talking about exactly what that means in a dedicated lesson elsewhere in this section.
Now for the exam this is important, you can select the security policy to use.
So there are various different security policies and AWS update these periodically.
Now this is generally a trade-off because if you pick a more recent security policy,
then potentially you can prevent any customers with older browsers accessing your distribution.
So you need to pick the one that's the best balance of security and accessibility for your users.
Now as well as that, all the things that are configured at a distribution level are supported HTTP versions,
whether you want logging on or off, which again I'll have another lesson coming up elsewhere in the course that talks about this.
So this is all of the high-level things which can be configured at a distribution level.
There's also a lot which can be configured from a behavior perspective.
Now a single distribution can have multiple behaviors.
And I've mentioned that there's always going to be the one default behavior.
So let's open that up. I'll select it and then click on edit.
Now the way that behaviors work is for any requests which are incoming to an edge location,
they're pattern matched against any behaviors for that distribution using this path pattern.
Now the default behavior has a wildcard or star path pattern,
and so it matches anything which is not matched by another more specific behavior.
Once a path pattern is matched against an incoming request,
it's then subject to any of the options specified within this behavior.
The most important one is which origin or origin group to use,
but you can also select the viewer protocol policy,
so which policy is used between the viewer and the edge location.
Options include insecure or secure HTTPS.
You can redirect insecure towards secure HTTPS or only accept secure HTTPS.
So these are configurable on a per behavior basis. That's important to understand.
You can also select to allow different HTTP methods, and again, that's configured on a behavior.
You can configure field level encryption, and I talk about this in a dedicated lesson elsewhere in this section,
so I won't go over it here in detail, but this allows you to encrypt data
from the point that it enters the edge location through the cloud front network,
and again, this is configured on a per behavior basis.
You're also able to set all the cache directives within a behavior,
and you can do this either using legacy cache settings,
which mine is configured using because this is an older distribution,
or you can use the newer cache policy and origin request policy settings,
and these are recommended by AWS.
So this is the methods that are cached, the cache and origin request settings.
You're able to set whether you want to cache based on any request headers,
so options include non, whitelist, or all, and again, this is per behavior.
The minimum TTL, maximum TTL, and default TTL, again, is set on a per behavior basis,
and I talk about this in much more detail elsewhere in this section of the course.
An important one for the exam is that you're also able to restrict viewer access to a behavior,
so this is different than restricting access to an S3 origin.
This is the option that sets the entire behavior to be restricted or private,
and if you select this, you need to specify the trusted authorization type,
which is trusted key groups or trusted signers.
Now, key groups are the new way of doing this, and signers are the legacy way.
And for the exam, if you see trusted key groups or trusted signer,
then you know that it is set to restrict viewer access,
and you need things like signed cookies or signed URLs in order to access the content,
and I'll be discussing this, if appropriate, elsewhere in the course.
And many distributions which are in use in the real world will have some behaviors
which are non-restricted, for example, sign-on,
and then some behaviors which are restricted, and these control access to sensitive content.
It's on a behavior that you can set to compress objects automatically,
and it's also on a per behavior basis that you can associate lambda at edge functions with CloudFront.
So I talk about lambda at edge elsewhere in this section of the course,
but it's at the behavior level that you associate these lambda functions.
Now, from a real world perspective, you're obviously always going to have access to Google and the console,
so you can easily remind yourself exactly which options are set on a per behavior basis versus the distribution.
For the exam, do your best to try and commit these to memory.
Specifically, you need to understand that all of the caching controls are set on a behavior
as well as the restrict viewer access.
If you remember those are behavior-based, you'll also remember that you can have different settings
for those options for different behaviors in the same distribution,
and that will help you answer some of the more complex exam questions which you might encounter.
With that being said, though, that's everything I wanted to cover in this lesson.
I just wanted to give you a quick walkthrough to help you understand the different components.
Go ahead, complete this lesson, and when you're ready, I'll look forward to you joining me in the next.
