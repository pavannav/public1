Welcome back, and in this lesson I want to talk about how you can use Direct Connect,
public VIFs and IPsec VPNs to provide end-to-end encrypted access to private VPC networks across
Direct Connect.
Let's just jump in and get started covering this really useful feature of Direct Connect
and virtual private gateways.
Now using a VPN gives you an encrypted and authenticated tunnel, and this is true whether
you use the public internet or run a VPN over Direct Connect.
By running a VPN over Direct Connect though you get that plus low latency and consistent
latency.
You get great performance together with great security.
Now architecturally this uses a public VIF, and many students get confused by this because
it provides access to a private VPC, so why not use a private VIF?
Well remember I said that a private VIF gives access to private IPs only, a public VIF gives
access to public zones, meaning public IP addresses owned by AWS.
Well with a VPN what you're connecting to are public IPs which belong to a virtual private
gateway or transit gateway, and so to access these public IPs you need a public VIF.
When you're thinking about VIFs focus on what it is that you're trying to access and that
should inform you whether you should use a public VIF or a private VIF.
Now a VPN is great because it's transit agnostic, you can connect using a VPN to a virtual private
gateway or a transit gateway over the public internet or over a public VIF.
The VPN configuration is the same, it's just the transit which differs, public internet
or public VIF.
A VPN is end-to-end encryption from a customer gateway through to a transit or virtual private gateway.
Compare this to Maxec which I've covered in another lesson of the course which is single
hop based between the AWS DX router and whatever your cross-connect is terminated into.
I say this so that you understand that a VPN and Maxec are not competitors, they do different things.
A VPN provides an end-to-end encrypted tunnel between a customer gateway and an AWS virtual
private gateway or transit gateway and a Maxec connection is between two hops in the same
layer 2 local area network.
VPNs have wide vendor support, getting a router which supports IPsec VPN is easier than getting
a switch which supports Maxec, although this will change over time.
VPNs also have more cryptographic overhead versus Maxec, meaning VPN speeds tend to be
very limited based on the hardware that you use, Maxec is much faster and designed for
terabit or above network speeds.
Now one very common pattern for using an IPsec VPN and DirectConnect together is that a VPN
can be provided immediately, in minutes using software, whereas DirectConnect takes time.
This means you can start with a VPN, get your traffic flows working over that and then add
a DirectConnect later, either leaving the VPN in place to encrypt primary traffic over
the DirectConnect or using it as a backup to the DirectConnect, or both.
A common form of resilience in many of my clients is to have a normal internet connection,
Over this you also run an IPsec VPN into AWS, then you have a DirectConnect also running
another IPsec VPN tunnel, this way traffic is always encrypted.
The DirectConnect is the primary so the organisation benefits from great performance and you have
a backup in the form of a completely separate network connection and a completely separate
IPsec tunnel.
Now visually the architecture of using a VPN and DirectConnect looks like this.
So this is a typical architecture.
We have two AWS regions on the left, US East 1 at the top and AP South East 2 in the middle.
We also have a DirectConnect location in AP South East 2 in the middle of your screen
and a business premises on the right.
When using a VPN with AWS, in this case let's assume that we're going to use a virtual
private gateway, what actually happens is that two VPN endpoints are created within
the AWS public zone in that region, so one in each of two availability zones and these
endpoints have public addressing.
This means that you can either connect from the customer site to these endpoints using
the public internet for transit, which means lots of hops as well as a fairly varied latency
or you can create the IPsec VPN across the public vif, which means you'll benefit from
DirectConnect's low and consistent latency.
In both cases it's the same encrypted tunnel between the customer on premises gateway and
the AWS VPN endpoint, only using a DirectConnect means using a public vif as transit, so you'll
benefit from the performance improvements that DirectConnect provides.
You can even connect to VPN gateways in other AWS regions using the same public vif across
the AWS global network and this is often a great way to provide global encrypted transit
between VPCs and your business network.
What I want you to take away from this lesson is that IPsec running over a DirectConnect
it doesn't compete with Macsec.
VPN is for when you need end-to-end encryption of data from AWS to on-premises networks using
something which can work equally as well over the public internet and the public vif.
It also means that you can connect to VPCs in remote regions using the same grade of equipment.
Focus on understanding why we're using a public vif with this architecture because
we're connecting from the customer gateway to a public IP or public IPs which are provided
by the virtual private gateway or transit gateway.
Because we're connecting to public IPs we need to use a public vif.
With that being said that's everything I wanted to cover about this topic.
Go ahead and complete this video and when you're ready I look forward to you joining
me in the next lesson.
