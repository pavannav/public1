Welcome to this mini project where you're going to get some experience working with Amazon Macy and Macy is a machine
learning based service which can automatically evaluate any data that you have stored in s3 and
Identify and take action based on any sensitive data stored within s3 now in order to complete this mini project as
Always make sure that you're logged into an AWS account
Using an identity with admin permissions if you're using any of my courses
Then you can use the I am admin user in the general AWS account
So that's the management account of the organization if you're not using my courses
Then just make sure that you're logged in with an identity which has admin permissions now this mini project should work in most
AWS regions you should make sure that you're just using the same region throughout and of course it would be my strong
Recommendation to use the Northern Virginia or us-e-1 region
That's the region I'm going to be using and this mini project has been thoroughly tested in that region now attached to this as some
Sample data that we're going to be using as part of this mini project
So specifically there's data for a CC or credit card dot txt
employee information so employees dot txt
Access credentials so keys dot txt and then some custom data for license plates of
Australian vehicles and that's going to be stored in plates dot txt
So what I recommend is go to these text-based instructions and just at the top
Copy and paste all of that data into the correct file names because you'll be using those throughout this mini project
Now to get started we need to move across to the s3 console
So type s3 and the search box at the top and then open that in a new tab
We're going to be creating a new bucket. So go ahead and click on create bucket
We'll use the name mixed hyphen data
But I want you to prefix this with your initials and then add a suffix at the end of a random number
So in my case AC hyphen mixed hyphen data
Hyphen one three three seven and then just make sure for the region you pick the same region that you're operating in which is US
hyphen East hyphen one
Once you've done that you can scroll all the way down to the bottom and click on create bucket
Now once you've done that I want you to go inside the bucket and then click on upload and then add files and we're going
To add all of those files that you've just created into that bucket
So in my case, I'm going to add all four of those files and all of these contain sensitive data
So I'll click on open scroll down and click on upload
Once I've done that I'm also going to add some other data. I'm going to add bunny the cat
So this is an image of bunny the cat and clearly she is the most fluffy cat in the world
That's just some non sensitive data to go along with our sensitive data in those text files
So once you've got all of those five objects in the bucket
We're good to move on to the next step and to do that click in the search box at the top and type
Macy and then open that in a new tab
So once again, Macy is a machine learning service and it's going to be configured to identify any
Sensitive data in our bucket and this same process could be applied across all of the buckets of your organization
Now if you haven't used Macy before we need to enable it. So to do that click on get started and
Then click on enable Macy
Now go ahead and wait until you see a console screen like this and then we're good to proceed to the next step
What we need to do next is create a job for our s3 bucket
We need to tell Macy to begin analyzing objects within our s3 bucket
So to do that go ahead and click on s3 buckets and then check the box
Next to the bucket that you've created in my case AC hyphen mixed hyphen data hyphen one
337 and once you've selected that bucket click on create job
Then click on next we don't need to set anything on this page
This is going to be a one-time job. You can configure Macy to run regularly, but for this mini project
We're just going to do it the once
So select one time job and then click on next now at this point you're able to select the managed data
Identifier options now a managed data identifier as this screen suggests
It's a set of criteria that detects a specific type of sensitive data now
You can create your own custom data identifiers and on this screen you have the option of selecting all you can check everything
But a set that you exclude or you can check only the set that you include or check none
Now for this mini project, we're going to use all so make sure all is selected and then click on next
Now at this point in the mini project, we're not going to be adding any custom data identifiers
But we are going to be doing that later on in the mini project
We're going to use it to detect vehicle license plates with an Australian format
But we'll do that later on for now. Just go ahead and click on next
We won't be setting any allow lists. So click on next again
For job name, you can enter anything you want
You could put risky data or scary data or something that you choose
just go ahead and enter a job name and then scroll down and click on next and
Then you're given one last opportunity to review all of the job configuration
Everything looks good scroll down to the bottom and click submit
Now this can take up to 20 minutes to complete so you need to go ahead and pause the video
Wait for the status of this job to change to complete and once it has then you're good to resume the video
Welcome back. And now that the job's complete we can go ahead and click on show results and then in the drop down put show
Findings you'll be able to see the type of sensitive data that's been identified
By Macy in this case
We have personal data
Credentials and credit card information and all of these have been identified together with the resources that are affected
So we can see here. We've got employee data
We've got some keys or credentials stored in this object and we've got credit card information in the bottom object
Now just as a reminder if we look at one of these text files, so let's open one in our code editor
This is an example of the employees dot txt object
So this is the type of data that we have stored within these objects and this has been identified by Macy as potentially
Sensitive and likewise, we've got data in these other files
We've got keys dot txt and then CC dot txt which contains credit card information
Now note that it didn't identify this plates dot txt as sensitive
and this is because these vehicle license plates are in an
Australian specific format and we need to configure Macy specifically to identify these and that's one of the things we're going to do next
Before we do that though, let's go ahead and move back to the AWS console and we're going to configure some
Notifications so that Macy can notify us when any sensitive data is identified
So click in the search box at the top and type SNS and then right-click on simple
Notification service and open that in a new tab then go to that tab click on topics and create a topic
It's going to be a standard topic and for topic name go ahead and type Macy hyphen alerts
Then scroll down and expand access policy leave the method on basic
But we're going to configure this account so it can be a publisher and a subscriber
So click in the publishers drop-down and then click on only the specified AWS accounts
Then click the drop-down at the top right
Click to copy your account ID
Paste it into the publisher account ID box
then under subscribers click
again only the specified AWS accounts and
Paste in your account ID again, then scroll down and click on create topic
Then we need to configure you as a subscriber. So click on subscribers and then create subscription in
The protocol drop-down click and select email and then enter your email address in this box
I'm going to enter mine, but you need to enter your email address
Then scroll down and create subscription
Now you're going to receive an email and this will contain a link to approve this subscription
So go ahead and click that link and once you've done so if you click on the topic name at the top so Macy alerts
The status should change to confirmed
And that means we're good to continue
Next we're going to use event bridge so that we're notified whenever Macy has any findings
So click in the search box at the top
Type event and then right click on Amazon event bridge and open that in a new tab and then move to that tab
We're going to create an event bridge rule
So make sure the event bridge rule option is selected and then click on create rule for the rule name
Go ahead and use Macy hyphen events and it's going to be a rule with an event pattern
And as well just make sure that this rule is enabled so make sure the toggle is enabled for this specific rule and
Then click on next
It's going to be an AWS event or an event bridge partner event. So make sure that option is selected and
Then scroll down past the sample event dialog and then for method make sure that use pattern form is selected
Make sure event source is set to AWS services and then in the AWS service drop-down click
Type Macy and then click on Macy for the event type select Macy finding
So we want this rule to trigger whenever Macy identifies any sensitive data. Once you've done that go ahead and click on next
For the targets it's going to be an AWS service
So make sure that's selected then click in the selector target drop-down
Type SNS and then click SNS topic
Pick the topic you created in the previous step. So Macy hyphen alerts click next
next again
Then scroll down and create the rule
So this means whenever Macy identifies any sensitive data this event bridge rule will be triggered and it will send that event
Through to SNS and you'll be notified now next we're going to add a custom
Identifier so that Macy's capable of identifying
Vehicle license plates in an Australian format. So go back to the Macy console. You should still have it open in a tab
Then on the menu on the left
Under settings click custom data
Identifiers and then click on create for the name type
License plates with an uppercase L and P and then in the instructions attached for this lesson. There's a regular
Expression which you can copy and paste which will identify
Australian license plates so go ahead and copy that regular expression and then paste it in to the regular expression box
once you've done that scroll down and
click submit
Now using this custom data identifier. It means that Macy will now be capable of identifying any
Australian license plates and to configure that we need to configure a job
So click on s3 buckets and select the s3 bucket containing your data and then click on create job
Then click next. It's going to be a one-time job again. So select that option
Then click next
Leave managed data identifier set to all and click on next then under custom data identifiers
Select license plates and this is the custom identifier that you just created
So select that and click on next
We won't be setting any allow lists. So click on next again
for job name type license plates
click next
We can review this and then click submit
Now again, this will take some time to complete you will receive some email notifications while this job is in progress
But pause the video and wait for the status to change to complete and then we good to continue
Okay, at this point the job has finished. You should have received some JSON formatted
Notifications to your email and that's okay. They were just for illustration purposes, but this job has completed
So if we click on show results and then show findings we can see that it's now identified another medium
Severity set of findings and these are within our plates dot txt file
So this is the object which contains our
Australian formatted vehicle license plates and you can create custom data
Identifiers which identify any business specific or region specific sensitive data that you want
Macy to be able to identify and when you do that
You can either perform ad hoc one-off jobs or you can configure
Regular jobs and then have a vent bridge set up to perform other tasks such as automated
notification or automated remediation
When those findings occur and that's a really powerful form of event driven security within AWS
Now at this point that is everything I wanted to cover in this mini project
The only thing which remains is to tidy up the account and return it into the same state as it was at the start
Of this mini project to do that we need to move back to SNS
Select the topic that you created click delete and then confirm that deletion
Then go to subscriptions and delete any subscriptions that you created for this mini project
Then go to Macy
Then click on settings and if you did enable Macy specifically for this mini project
Then you can go ahead and click this button to disable Macy
You'll need to confirm that by typing disable and then clicking to disable Macy if it was already enabled
Then you'll need to make the decision yourself whether to disable it or not
Then we need to move to the event bridge console click on rules select the Macy events rule and click delete and
Then confirm that deletion
Then move back to s3
Go to buckets
Select the bucket that you created click on empty and confirm that empty process and then once done select it again
click delete and confirm that deletion and
At this point the account is back in the same state as it was at the start of this mini project
So I hope this has been a fun and useful mini project
It has been fairly simple
But the techniques and skills that you've learned can be applied to much larger production projects at this point
You can go ahead and complete the video, and I hope you'll join me soon in another exciting mini project
