Welcome back, and in this lesson I want to finish my coverage of IAM users.
You already gained some exposure to IAM users earlier in the course.
Remember you created an IAM admin user in both your general and production AWS accounts.
As well as creating these users, you secured them using MFA,
and you attached an AWS managed policy to give this IAM user admin rights in both of those accounts.
So for now I just want to build upon your knowledge of IAM users
by adding some extra detail that you'll need for the exam.
So let's get started.
Now before I go into more detail, let's just establish a foundation.
Let's use a definition.
Simply put, IAM users are an identity used for anything requiring long-term AWS access.
For example, humans, applications or service accounts.
If you need to give something access to your AWS account,
and if you can picture one thing, one person or one application,
so James from accounts, Mike from architecture or Miles from development,
99% of the time you would use an IAM user.
If you need to give an application access to your AWS account,
for example a backup application running on people's laptops,
then each laptop generally would use an IAM user.
If you have need for a service account,
generally a service account which needs to access AWS,
then generally this will use an IAM user.
If you can picture one thing, a named thing,
then 99% of the time the correct identity to select is an IAM user,
and remember this because it will help in the exam.
IAM starts with a principle,
and this is a word which represents an entity trying to access an AWS account.
At this point, it's unidentified.
Principles can be individual people, computers, services,
or a group of any of those things.
For a principle to be able to do anything,
it needs to authenticate and be authorized,
and that's the process that I want to step through now.
A principle, which in this example is a person or an application,
makes requests to IAM to interact with resources.
Now to be able to interact with resources,
it needs to authenticate against an identity within IAM.
An IAM user is an identity which can be used in this way,
and authentication is this first step.
Authentication is a process where the principle on the left
proves to IAM that it is an identity that it claims to be.
So an example of this is that the principle on the left
might claim to be Sally, and before it can use AWS,
it needs to prove that it is indeed Sally,
and it does this by authenticating.
Authentication for IAM users is done either using username and password or access keys.
These are both examples of long-term credentials.
Generally, username and passwords are used if a human is accessing AWS
and accessing via the console UI.
Access keys are used if it's an application,
or as you experienced earlier in the course,
if it's a human attempting to use the AWS command line tools.
Now once a principle goes through the authentication process,
the principle is now known as an authenticated identity.
An authenticated identity has been able to prove to AWS
that it is indeed the identity that it claims to be.
So it needs to be able to prove that it's Sally,
and to prove that it's Sally, it needs to provide Sally's username and password,
or be able to use Sally's secret access key,
which is a component of the access key set.
If it can do that, then AWS will know that it is the identity that it claims to be,
and so it can start interacting with AWS.
Once the principle becomes an authenticated identity,
then AWS knows which policies apply to that identity.
So in the previous lesson I talked about policy documents,
how they could have one or more statements,
and if an identity attempted to access AWS resources,
then AWS would know which statements apply to that identity.
That's the process of authorization.
So once a principle becomes an authenticated identity,
and once that authenticated identity tries to upload to an S3 bucket,
or terminate an EC2 instance,
then AWS checks that that identity is authorized to do so.
And that's the process of authorization.
So they're two very distinct things.
Authentication is how a principle can prove to IAM
that it is the identity that it claims to be,
using username and password or access keys,
and authorization is IAM checking the statements that apply to that identity,
and either allowing or denying that access.
Okay, let's move on to the next thing that I want to talk about,
which is Amazon resource names, or ARNs.
ARNs do one thing,
and that's to uniquely identify resources within any AWS accounts.
When you're working with resources using the command line or APIs,
you need a way to refer to these resources in an unambiguous way.
ARNs allow you to refer to a single resource if needed,
or in some cases, a group of resources using wildcards.
Now this is required because things can be named in a similar way.
You might have an EC2 instance in your account
with similar characteristics to one in my account,
or you might have two instances in your account
but in different regions with similar characteristics.
ARNs can always identify single resources,
whether they're individual resources in the same account or in different accounts.
Now ARNs are used in IAM policies,
which are generally attached to identities such as IAM users,
and they have a defined format.
Now there are some slight differences depending on the service,
but as you go through this course,
you'll gain enough exposure to be able to confidently answer
any exam questions that involve ARNs.
So don't worry about memorising the format at this stage,
you will gain plenty of experience as we go.
These are two similar, yet very different, ARNs.
They both look to identify something related to the Cat GIFs bucket.
They specify the S3 service.
They don't need to specify a region or an account
because the naming of S3 is globally unique.
If I use a bucket name, then nobody else can use that bucket name
in any account worldwide.
The difference between these two ARNs is the forward slash star
on the end of the second one.
And this difference is one of the most common ways
mistakes can be made inside policies.
It trips up almost all architects or admin at one point or another.
The top ARN references an actual bucket.
If you wanted to allow or deny access to a bucket,
or any actions on that bucket,
then you would use this ARN, which refers to the bucket itself.
But a bucket and objects in that bucket are not the same thing.
This ARN references anything in that bucket,
but not the bucket itself.
So by specifying forward slash star,
that's a wildcard that matches any keys in that bucket,
so any object names in that bucket.
This is really important.
These two ARNs don't overlap.
The top one refers to just the bucket,
and not the objects in the bucket.
The bottom one refers to the objects in the bucket,
but not the bucket itself.
Now some actions that you want to allow or deny in a policy,
they operate at a bucket level, or actually create buckets.
And this would need something like the top ARN.
Some actions work on objects,
so would need something similar to the bottom ARN.
And you need to make sure that you use the right one.
In some cases, creating a policy that allows a set of actions will need both.
If you want to allow access to create a bucket,
and interact with objects in that bucket,
then you would potentially need both of these ARNs in a policy.
ARNs are collections of fields split by a colon.
And if you see a double colon, it means that nothing is between it.
It doesn't need to be specified.
So in this example, you'll see a number of double colons,
because you don't need to specify the region or account number for an S3 bucket,
because the bucket name is globally unique.
A star can also be used, which is a wild card.
Now keep in mind they're not the same thing.
So not specifying a region and specifying star don't mean the same thing.
You might use a star when you want to refer to all regions inside an AWS account.
Maybe you want to give permissions to interact with EC2 in all regions.
But you can't simply omit this.
The only place you'll generally use the double colon is when something doesn't need to be specified.
You'd use a star when you want to refer to a wild card collection of a set of things.
So they're not the same thing.
Keep that in mind, and I'll give you plenty of examples as we go through the course.
So the first field is the partition, and this is the partition that the resource is in.
For standard AWS regions, the partition is AWS.
If you have resources in other partitions, the partition is AWS hyphen partition name.
This is almost never anything but AWS.
But for example, if you do have resources in the China Beijing region, then this is AWS hyphen CN.
The next part is service, and this is a service namespace that identifies the AWS product.
For example, S3, IAM or RDS.
The next field is region.
So this is the region that the resource you're referring to resides in.
Some ARNs do not require a region, so this might be omitted.
And certain ARNs require a wild card.
And you'll gain exposure through the course as to what different services require for their ARNs.
The next field is the account ID.
This is the account ID of the AWS account that owns the resource.
So for example, 123456789012.
So if you're referring to an EC2 instance in a certain account,
you will have to specify the account number inside the ARN.
Some resources don't require that.
So this example is S3 because it is globally unique across every AWS account.
You don't need to specify the account number.
And then at the end, we've got resource or resource type.
And the content of this part of the ARN varies depending on the service.
A resource identifier can be the name or ID of an object.
For example, user forward slash Sally or instance forward slash and then the instance ID.
Or it can be a resource path.
But again, I'm only introducing this at this point.
You will get plenty of exposure as you go through the course.
I just want to give you this advanced knowledge so you know what to expect.
So let's quickly talk about an exam power-up.
I tend not to include useless facts and figures in my course, but some of them are important.
This is one such occasion.
Now first, you can only ever have 5,000 IAM users in a single account.
IAM is a global service, so this is a per account limit, not per region.
And second, an IAM user can be a member of 10 IAM groups.
So that's a maximum.
Now both of these have design impacts.
You need to be aware of that.
What it means is that if you have a system which requires more than 5,000 identities,
then you can't use one IAM user for each identity.
So this might be a limit for internet scale applications with millions of users.
Or it might be a limit for large organizations which have more than 5,000 staff.
Or it might be a limit when large organizations are merging together.
If you have any scenario or project with more than 5,000 identifiable users, so identities,
then it's likely that IAM users are not the right identity to pick for that solution.
Now there are solutions which fix this.
We can use IAM roles or identity federation, and I'll be talking about both of those later
in the course.
But in summary, it means using your own existing identities rather than using IAM users.
And I'll be covering the architecture and the implementation of this later in the course.
At this stage I want you to take away one key fact, and that is this 5,000 user limit.
If you are faced with an exam question which mentions more than 5,000 users or talks about
an application that's used on the internet which could have millions of users, and if
you see an answer saying create an IAM user for every user of that application, that is
the wrong answer.
Generally with internet scale applications or enterprise access or company mergers, you'll
be using federation or IAM roles, and I'll be talking about all of that later in the
course.
OK, so that's everything I wanted to cover in this lesson, so go ahead, complete the
video, and when you're ready, I'll look forward to you joining me in the next.
