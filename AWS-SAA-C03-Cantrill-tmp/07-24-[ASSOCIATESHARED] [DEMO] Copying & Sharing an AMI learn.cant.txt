Welcome back, and in this demo lesson, either you're going to get the experience, or you can watch me interacting with an Amazon machine image.
So we created an Amazon machine image, or AMI, in a previous demo lesson, and if you recall, it was customised for animals for life,
it had an install of WordPress, and it had the Cowsay application installed and a custom login banner.
Now this is a really simple example of an AMI, but I want to step you through some of the options that you have when dealing with AMIs.
So if we go to the EC2 console, and if you are following along with this in your own environment,
do make sure that you're logged in as the IM admin user of the general AWS account, so the management account of the organisation,
and you have the Northern Virginia region selected.
The reason for being so specific about the region is that AMIs are regional entities, so you create an AMI in a particular region.
So if I go and select AMIs under images within the EC2 console, I'll see the animals for life AMI that I created in a previous demo lesson.
Now if I go ahead and change the region, maybe from Northern Virginia, which is US-E-1, to US-East Ohio, which is US-E-2,
if I make that change, what we'll see is we'll go back to the same area of the console, only now we won't see any AMIs.
That's because an AMI is tied to the region in which it's created. Every AMI belongs in one region, and it has a unique AMI ID.
So let's move back to Northern Virginia. Now we are able to copy AMIs between regions.
This allows us to make one AMI and use it for a global infrastructure platform.
So we can right-click and select Copy AMI, then select the destination region, and then for this example, let's say that I did want to copy it to Ohio,
then I would select that in the drop-down. It would allow me to change the name if I wanted, or I could keep it the same.
For description, it would show that it's been copied from this AMI ID in this region, and then it would have the existing description at the end.
So at this point, I'm going to go ahead and click Copy AMI, and that process has now started.
So if I close down this dialogue, and then change it from US-East 1 to US-East 2, so select that,
now we have a pending AMI, and this is the AMI that's being copied from the US-East-1 region into this region.
If we go ahead and click on Snapshots under Elastic Block Store, then we're going to see the snapshot or snapshots which belong to this AMI.
Now, depending on how busy AWS is, it can take a few minutes for the snapshots to appear on this screen.
Just go ahead and keep refreshing until they appear.
And in our case, we only have the one, which is the boot volume that's used for our custom AMI.
Now, the time taken to copy a snapshot between regions depends on many factors, what the source and destination region are,
and the distance between the two, the size of the snapshot, and the amount of data it contains.
And it can take anywhere from a few minutes to much, much longer, so this is not an immediate process.
Once the snapshot copy completes, then the AMI copy process will complete, and that AMI is then available in the destination region.
But an important thing that I want to keep stressing throughout this course is that this copied AMI is a completely different AMI.
AMIs are regional. Don't fall for any exam questions which attempt to have you use one AMI for several regions.
If we're copying this Animals for Life AMI from one region to another region, in effect, we're creating two different AMIs.
So take note of this AMI ID in this region, and if we switch back to the original source region, so US-E-1,
note how this AMI has a different ID. So they are different AMIs, completely different AMIs.
You're creating a new one as part of the copy process.
So while the data is going to be the same, conceptually, they are completely separate objects,
and that's critical for you to understand, both for production usage and when answering any exam questions.
Now while that's copying, I want to demonstrate the other important thing which I wanted to show you in this demo lesson, and that's permissions of AMIs.
So if I right-click on this AMI and edit AMI permissions, by default an AMI is private.
Being private means that it's only accessible within the AWS account which has created the AMI,
and so only identities within that account that you grant permissions are able to access it and use it.
Now you can change the permission of the AMI. You could set it to be public, and if you set it to public,
it means that any AWS account can access this AMI.
And so you need to be really careful if you select this option because you don't want any sensitive information contained in that snapshot to be leaked to external AWS accounts.
A much safer way is if you do want to share the AMI with anyone else, then you can select private,
but explicitly add other AWS accounts to be able to interact with this AMI.
So I could click in this box, and then for example if I clicked on services, and I just moved to the AWS organization service,
I'll open that in a new tab, and let's say that I chose to share this AMI with my production account.
So I selected my production account ID, and then I could add this into this box,
which would grant my production AWS account the ability to access this AMI.
Now note how there's also this check box, and this adds create volume permissions to the snapshots associated with this AMI.
So this is something that you need to keep in mind.
Generally, if you are sharing an AMI to another account inside your organization, then you can afford to be relatively liberal with permissions.
So generally, if you're sharing this internally, I would definitely check this box,
and that gives full permissions on the AMI as well as the snapshots so that anyone can create volumes from those snapshots as well as accessing the AMI.
So these are all things that you need to consider.
Generally, it's much preferred to explicitly grant an AWS account permissions on an AMI rather than making that AMI public.
If you do make it public, you need to be really sure that you haven't leaked any sensitive information, specifically access keys.
While you do need to be careful of that as well if you're explicitly sharing it with accounts,
generally if you're sharing it with accounts, then you're going to be sharing it with trusted entities.
You need to be very, very careful if ever you're using this public option,
and I'll make sure I include a link attached to this lesson which steps through all of the best practice steps that you need to follow if you're sharing an AMI publicly.
There are a number of really common steps that you can use to minimize lots of common security issues,
and that's something you should definitely do if you're sharing an AMI.
Now, if you wanted to, you could also share an AMI with an organizational unit or organization, and you can do that using this option.
This makes it easier if you want to share an AMI with all AWS accounts within your organization.
At this point, though, I'm not going to do that. We don't need to do that in this demo.
What we're going to do now, though, is move back to US-East-2.
That's everything I wanted to cover in this demo lesson.
Now this AMI is available. We can right-click and select Deregister and move back to US-East-1.
And now that we've done this demo lesson, we can do the same process with this AMI.
So we can right-click, select Deregister, and that will remove that AMI.
Click on Snapshots. This is the snapshot created by this AMI, so we need to delete this as well.
Right-click, delete that snapshot, confirm that, and we'll need to do the same process in the region that we copied the AMI and the snapshots to.
So select US-East-2. It should be the only snapshot in the region. Make sure it is the correct one.
Right-click, delete, confirm that deletion, and now you've cleared up all of the extra things created within this demo lesson.
Now that's everything that I wanted to cover. I just wanted to give you an overview of how to work with AMIs from the console UI from a copying and sharing perspective.
Go ahead and complete this video, and when you're ready, I'll look forward to you joining me in the next.
