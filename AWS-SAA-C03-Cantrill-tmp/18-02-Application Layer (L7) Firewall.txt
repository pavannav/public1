Welcome back and in this video I want to talk in general about application layer firewalls also known as layer 7 firewalls
Named after the layer of the OSI model that they operate at
Now I want to keep this video pretty generic and talk about how AWS implement this within their product set in a separate video
So let's just jump in and get started
Now before I talk about the high level architecture and features of layer 7 firewalls
Let's quickly refresh our knowledge of layer 3, 4 and 5
So we start with a layer 3 and 4 firewall which is helping to secure the Categram application
Now this is accessed by millions of people globally because it's that amazing
Now because this is layer 3 and 4, the firewall sees packets and segments, IP addresses and ports
It sees two flows of communications, requests from the laptop to the server and then responses from the server back to the laptop
Because this firewall is limited to layer 3 and 4 only, these are viewed as separate and unrelated
You need to think of these as different streams of data, request and response
Even though they're part of the same communication from a human perspective
Now if we enhance the firewall, this time adding session capability
Then the same communication between the laptop and server can be viewed as one
The firewall understands that the request and the response are part of the same session
And this small difference both reduces the admin overhead, so one rule instead of two
But this also lets you implement more contextual security
Where you can think of response traffic in the context that it's response to an original request
And treat that differently than traffic in the same direction which is not a response
Now this next point is really important
In both cases these firewalls don't understand anything above the layer at which they operate
The top firewall operates at layer 3 and 4, so it understands layers 1, 2, 3 and 4
The bottom firewall does this plus layer 5
Now what this means is that both of them can see IP addresses, ports, flags
And the bottom one can do all of this and additionally it can understand sessions
Neither of them though can understand the data which flows over the top of this
They have no visibility into layer 7, for example HTTP
So they can't see headers or any of the other data that's been transferred over HTTP
To them the layer 7 stuff is opaque
A cat image is the same as a dog image is the same as some malware
And this is a significant limitation
And it exposes the things that we're protecting to a wide range of attacks
Now layer 7 firewalls fix many of these limitations
So let's take a look at how
Let's consider the same architecture where we have a client on the left
And then a server or application on the right that we're trying to protect
In the middle we have a layer 7 firewall
And so that you'll remember it's a layer 7 firewall
Let's add a robot, a smart robot
With this firewall we still have the same flow of packets and segments
And a layer 7 firewall can understand all of the lower layers
But it adds additional capabilities
Let's consider this example where the Categram application is connected using a HTTPS connection
So encrypted HTTP and HTTP is the layer 7 protocol
The first important thing to realize is that layer 7 firewalls understand various layer 7 protocols
And the example we're stepping through is HTTP
So they understand how that protocol transfers data, its architecture, headers, data, hosts
All of the things which happen at layer 7 or below
It also means that it can identify normal or abnormal elements of a layer 7 connection
Which means it can protect against various protocol specific attacks or weaknesses
In this example, so a HTTPS connection to the Categram server
The HTTPS connection would be terminated on the layer 7 firewall
So while the client thinks that it's connecting to the server
The HTTPS tunnel would be stripped away, leaving just HTTP
Which it could analyze as it transits through the firewall
So a new HTTPS connection would be created between the layer 7 firewall and the backend server
So from the server and client perspective, this process is occurring transparently
The crucial part of this is that between the original HTTPS connection and the new HTTPS connection
The layer 7 firewall sees an unencrypted HTTP connection
So this is plain text and because the firewall understands the layer 7 protocol
It can see and understand everything about this protocol stream
Data at layer 7 can be inspected, blocked, replaced or tagged
And this might be protecting against adult content, spam, off-topic content or even malware
So in this example you might be looking to protect the integrity of the Categram application
You'll logically allow cat pictures but might be less okay with doggos
You might draw a line and not allow other animals
Sheep for example might be considered spam
Maybe you're pretty open and inclusive and only block truly dangerous content such as malware and other exploits
Because you can see and understand one or more application protocols
You can be very granular in how you allow or block content
You can even replace content so if adult images flow through
These can be replaced with a nice kitten picture or other baby animals
You can even block specific applications such as Facebook
And even block the flow of business data leaving the organization onto services such as Dropbox
The key thing to understand is that a layer 7 firewall keeps all of the layer 3, 4 and 5 features
But can react to layer 7 elements
This includes things like DNS names which are used, the rate of flow, so how many connections per second
You can even react to content or headers
Whatever elements are contained in that specific layer 7 protocol which the firewall understands
Now some layer 7 firewalls only understand HTTP
Some understand SMTP which is the protocol used for email delivery
The limit is only based on what the firewall software supports
Now that's everything that I wanted to cover at a high level
Coming up in future videos I'm going to be covering how AWS implements
Layer 7 firewall capability into its product set
For now though this high level understanding is what I wanted to help with in this video
So go ahead and complete the video
Thanks for watching and when you're ready I look forward to you joining me in the next
