Welcome back. Over the next two lessons I'll be covering a topic which is usually one of the most difficult identity related topics in AWS to understand, and that's IAM roles.
In this lesson I'll step through how roles work, their architecture and how you technically use a role.
In the following lesson I'll compare roles to IAM users and go into a little bit more detail on when you generally use a role, so some good scenarios which fit using an IAM role.
My recommendation is that you watch both these lessons back to back in order to fully understand IAM roles.
So let's get started. A role is one type of identity which exists inside an AWS account.
The other type which we've already covered are IAM users. Remember the term principle that I introduced in the previous few lessons?
This is a physical person, application, device or process which wants to authenticate with AWS.
And we defined authentication as proving to AWS that you are who you say you are.
And if you authenticate and if you're authorized you can then access one or more resources.
Now I also previously mentioned that an IAM user is generally designed for situations where a single principle uses that IAM user.
I've talked about the way that I decide if something should use an IAM user is that if I can imagine a single thing, one person or one application who uses an identity,
then generally under most circumstances I'd select to use an IAM user.
IAM roles are also identities, but they're used much differently than IAM users.
A role is generally best suited to be used by an unknown number or multiple principles, not just the one.
So this might be multiple AWS users inside the same AWS account, or it could be humans, applications or services inside or outside of your AWS account who make use of that role.
If you can't identify the number of principles which use an identity, then it could be a candidate for an IAM role.
Or if you have more than 5,000 principles, because of the number limit for IAM users, it could also be a candidate for an IAM role.
Roles are also something which is generally used on a temporary basis.
Something becomes that role for a short period of time and then stops.
The role isn't something that represents you.
A role is something which represents a level of access inside an AWS account.
It's a thing that can be used short term by other identities.
These identities assume the role for a short time, they become that role, they use the permissions that that role has and then they stop being that role.
It's not like an IAM user where you log in and it's a representation of you long term.
With a role, you essentially borrow the permissions for a short period of time.
I want to make a point of stressing that distinction.
If you're an external identity, a mobile application maybe, and you assume a role inside my AWS account,
then you become that role and you gain access to any access rights that that role has for a short time.
You essentially become an identity in my account for a short period of time.
Now this is a point where most people get a bit confused and I was no different when I first learned about roles.
What's the difference between logging into a user and assuming a role?
In both cases, you get the access rights that that identity has.
Now before we get to the end of this pair of lessons, so this one and the next,
I think it's going to make a little bit more sense and definitely as you go through the course and get some practical exposure to roles,
I know it's going to become second nature.
IAM users can have identity permissions policies attached to them, either inline JSON or via attached managed policies.
We know now that these control what permissions the identity gets inside AWS,
so whether these policies are inline or managed, they're properly referred to as permissions policies.
Policies which grant, so allow or deny, permissions to whatever they're associated with.
IAM roles have two types of policies which can be attached.
The trust policy and the permissions policy.
The trust policy controls which identities can assume that role.
With the onscreen example, identity A is allowed to assume the role because identity A is allowed in the trust policy.
Identity B is denied because that identity is not specified as being allowed to assume the role in the trust policy.
Now the trust policy can reference different things.
It can reference identities in the same account, so other IAM users, other roles and even AWS services such as EC2.
And a trust policy can also reference identities in other AWS accounts.
As you'll learn later in the course, it can even allow anonymous usage of that role and other types of identities such as Facebook, Twitter and Google.
If a role gets assumed by something which is allowed to assume it, then AWS generates temporary security credentials.
And these are made available to the identity which assumed the role.
Temporary credentials are very much like access keys which I covered earlier in the course.
But instead of being long term, they're time limited.
So they only work for a certain period of time before they expire.
Once they expire, the identity will need to renew them by re-assuming the role.
And at that point, new credentials are generated and given to the identity again which assumed that role.
Now these temporary credentials will be able to access whatever AWS resources are specified within the permissions policy.
Every time the temporary credentials are used, the access is checked against this permissions policy.
If you change the permissions policy, the permissions of those temporary credentials also change.
Now roles are real identities.
And just like IAM users, roles can be referenced within resource policies.
So if a role can access an S3 bucket because a resource policy allows it or because the role permissions policy allows it,
then anything which successfully assumes the role can also access that resource.
Now you'll get a chance to use roles later in this section when we talk about AWS organizations.
We're going to take all the AWS accounts that we've created so far and join them into a single organization
which is AWS's multi-account management product.
Roles are used within AWS organizations to allow us to log into one account in that organization
and access different accounts without having to log in again.
So they become really useful when managing large number of accounts.
Now when you assume a role, temporary credentials are generated by an AWS service called STS or the Secure Token Service.
And this is the operation that's used to assume the role and get the credentials.
So STS colon assume role.
In this lesson I focused on the technical aspect of roles.
So mainly how they work.
I've talked about the trust policy, the permissions policy, and how when you assume a role, you get temporary security credentials.
In the next lesson, I want to step through some example scenarios of where roles are used.
And I hope by the end of that, you're going to be clearer on when you should and shouldn't use roles.
So go ahead, finish up this video and when you're ready, you can join me in the next lesson.
