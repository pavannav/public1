Welcome back, this is part two of this lesson. We're going to continue immediately from the end of part one, so let's get started.
Now in this part of the demo lesson we're going to define an area of interest in the world and perform a query based on that area of interest.
I'm going to use Brisbane and you can either choose to use the same area as me or pick one that's relevant to you, maybe an area around where you live.
Now the way that this works is we're going to use latitude and longitude coordinates.
Now for latitude, we start off with a zero value at the equator. As you move north, this value increases, so it's a plus value.
As you move south, the value decreases, so it's a negative value.
With longitude, we start off with a line that goes through the prime meridian, and as you move east, the value increases, and as you move west, the value decreases.
So east is positive, west is negative.
And using a combination of both of these coordinates, you can define a single location on the planet, and using multiple of these coordinates, you can define an area.
When you're going to do that in this demo lesson, you're going to define a square or rectangle area and perform queries based in that area.
Now to define the area, we're going to use Google Earth because this is a really nice visual way that you can identify global coordinates.
Now I've linked this in the lesson description. You can either download it as an application or use the web app.
Now to start with, to make things easier, we need to make some configuration changes.
So click on the hamburger menu at the top left, click on settings, scroll down, and make sure the latitude and longitude formatting is set to decimal.
Depending on your region, it might default to degrees, minutes, and seconds, so just make sure that it's set to decimal.
Once you've changed that, click on save, click on the hamburger menu again, go to map style, and then toggle turn on grid lines.
And this will provide grid lines with coordinates, and that makes it much easier to manage.
So once you've done that, you can collapse this menu.
Now next, you can either use the plus and minus buttons and navigate around the world until you find your area, or you can use the search functionality.
Now if you do want to keep it simple and avoid any potential for error, you can use the coordinates that I've got stored inside the lesson files,
because I've already pre-prepared a valid set of coordinates that you can use for the Brisbane, Australia area.
So you can define an area on this map by clicking on draw line or shape, and then just clicking to draw a shape.
So you can draw a shape on this map, and that will give you four different coordinates.
So let's finish that shape and just give it a name, so Brisbane example, and click on save.
Now for that example, if you look on the bottom right, so right at the bottom right of my screen,
you're going to see a set of coordinates that adjusts as I move my mouse pointer.
So you'll see two coordinates. You'll see a value with an S listed next to it, and a value with an E listed next to it.
So those are the latitude and longitude coordinates.
Now the important thing to remember is if the first value has an S, then it's a minus value.
So in this case, where my mouse pointer is right now, it's minus 27.4.
If I move down to the bottom, it's now minus 27.5.
And for the second value, if it's an E, then it's a plus value, and if it's a W or West, then it's a negative value.
So using all these values, you can define this square.
So this square goes from minus 27.39 to minus 27.55, and then on the other coordinate, it goes from 152.9 to 153.19.
And so using that, you can create maximum and minimum values for latitude and longitude that you can use to define any area of the planet.
Now obviously that's beyond the scope of this course, and I do have an example that you can use to make things easier, which is the Brisbane, Australia area.
So let's move on to that next.
So now move back to the Athena console, and let's go ahead and click on the plus to open a new query window.
And now we're going to actually query the data inside the OpenStreetMap database.
So click in this window.
Further down in the lesson commands document have included an example query.
And I do recommend that you run this to keep things simple unless you're completely comfortable with latitude and longitude coordinates.
So this is the query that I created earlier.
So what this query does is select from the planet table where the type equals node.
Now nodes are things inside the OpenStreetMap database.
So any objects, businesses or particular landmarks, anything that is a thing has the type of node inside the database.
Now for every node in the database, there are also tags which can be used to filter based on certain types of things.
Now one of the things that we can do is to filter this down.
So look for nodes that are amenities and then filter that down further.
So look for ones that are classed as veterinary.
So these are vets, places where you can take your animals if they have any health issues or vaccination requirements.
So if I just ran this component, then this would actually display every veterinary node globally that's recorded inside this database.
Now clearly we don't want to do that. We want to be a little bit more filtered.
What we can also do is specify these two final lines and say that we only want to see node types where there are amenities,
where there are also veterinary nodes and where they exist in a certain range of latitude and longitude coordinates.
So I've pre-configured this as an example.
I just followed the process that I just demonstrated and I created a square that was covering the Greater Brisbane, Australia area.
So that has a latitude between minus 27.8 and minus 27.3 and a longitude between 152.2 and 153.5.
So this defines a square around the Greater Brisbane, Australia area.
So if you run this query, it's going to go through the entire planet data looking for any veterinary amenities inside this database
that exist within these particular latitude and longitude ranges.
So let's go ahead and do that. Go ahead and click on Run Query.
Now this is going to scan through a huge amount of data.
And remember, all that you're paying for is the data that's consumed by this query.
There are no base costs, no infrastructure to manage, no data that you need to perform extract, transforms and loads on.
You can simply perform ad hoc queries using the Athena product.
And what this is going to do is produce a list of all the vets within this area that we've specified.
So these are all of the vets that are in the Greater Brisbane area.
And if I expand this to make it a little bit easier to see,
unless you live in Brisbane, this won't mean much.
But we've got Green Cross Vet, the GAP Vet Surgery, Albion Veterinary Surgery, all of the vet surgeries within my local Brisbane area.
So the OpenStreetMaps database allows contributors to store data into the database
and they have the flexibility of providing any additional metadata which they have access to.
And as you can see, for different data items, that metadata does vary considerably.
So some of these items do have opening hours, some of them have boarding information, whereas some only have the name of the facility.
But what you've been able to do, using Athena, is query a huge set of data
without having any infrastructure or management overhead and got some useful data.
Now let's just clear up the account and put it back in the same state as it was before this demo lesson.
So go ahead and click on the plus and type drop table planet and then a semicolon.
And then go ahead and run that query.
Then click on the plus again.
This time type drop database a4l and then a semicolon.
And then go ahead and run that query.
And once done, the account will be back in the same state as before this demo lesson.
So that's everything that I wanted you to do in this demo lesson.
You've used Athena for a pretty cool piece of functionality.
So just to reiterate, you've loaded data from the OpenStreetMap database
and this is raw data that's stored in a number of huge data files in an S3 bucket.
You've defined a schema to use when that data is read.
So that's created a number of table definitions.
You've defined a geographic area or used My Brisbane example.
You've used all of that information to create a SQL query
and use that query to load data through this schema on read
and use that to produce some output data which is all of the facilities in a local area
which can perform pet vaccinations.
Now that's a pretty simple example of what Athena can be used for.
It can be used to query open data like what we've just done.
It can be used to query various different types of AWS data
such as load balancer logs, cloud trail logs, VPC flow logs and much more.
And you can also use it to query federated data sources.
And you can do that by using Lambda and a federation style architecture
to get access to that data, query it using Athena
and generate meaningful data in an ad hoc and serverless way.
Now using Athena in detail is something that's beyond the scope of this course
but it is something that I'll be covering extensively
within the data specialty courses that are part of the wider AWS certification set.
So I hope this has been a useful and enjoyable demo lesson.
It has been a very, very small subset of the functionality that Athena provides
but it does give you the practical experience so that you know how it works
and if you do want to experiment further then you should go ahead and do that.
There is a cost for using Athena.
Remember that it's billed based on the data that you consume
so it's not something that you can use for free
but if you do want to experiment with it, if you've got specific data querying needs
then it is an absolutely fantastic product to use.
But at this point that is everything that I wanted to cover in this demo lesson
so go ahead, finish the video and when you're ready
I'll look forward to you joining me in the next.
