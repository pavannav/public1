Welcome back and in this lesson I want to talk about S3 lifecycle configuration.
Now you can create lifecycle rules on S3 buckets which can automatically transition or expire objects in the bucket.
They're a great way to optimize the costs for larger S3 buckets and so they're an important skill to have as a solutions architect, developer or operational engineer.
Let's jump in and explore exactly what features lifecycle configuration adds to S3 buckets.
A lifecycle configuration at its foundation is a set of rules which you apply to a bucket.
These rules consist of actions which apply based on criteria. So do X if Y is true.
These rules can apply to a whole bucket or they can apply to groups of objects in that bucket defined by prefix or tags.
The actions which are applied are one of two types.
Transition actions which change the storage class of whichever object or objects are affected.
So an example of this is that you could transition objects from S3 standard to say S3 in frequent access after 30 days.
And you do this if you're sure that the objects will be more infrequently accessed after that initial 30 day period.
You could then maybe transition the objects from infrequent access to S3 glacier deep archive after 90 days when you're certain that they will be rarely if ever accessed after that point.
Now the other type of rule are expiration actions which can delete whatever object or objects or object versions are affected.
So you might want to expire objects or versions entirely after a certain time period.
And this can be useful to keep buckets tidy.
Now both of these can work on versions as well if you have a version enabled bucket.
But this can become complex and so it's something that you need to carefully plan before implementing.
Life cycle configurations offer a way to automate the deletion of objects or object versions or change the storage class of objects to optimize costs over time.
An important thing to understand is that these rules aren't based on access.
So you can't move objects between classes based on how frequently they're accessed.
This is something which a different feature, intelligent tiering, does on your behalf.
Now you can combine these S3 life cycle actions to manage an object's complete life cycle.
For example, suppose that objects you create have a well defined life cycle.
Initially the objects are frequently accessed over a period of 30 days.
Then objects are infrequently accessed for up to 90 days and after that the objects are no longer required.
In this scenario you can create an S3 life cycle rule in which you specify the initial transition action to S3 intelligent tiering,
S3 standard IA or even S3 one zone IA storage.
Then you might have another transition action through to one of the glacier storage classes for archiving
and then potentially even an expiration action when you're sure you no longer require the object.
As you move the objects from one storage class to another you save on the storage costs.
Now let's look visually at the life cycle process.
So with life cycle configuration, specifically the transitions between different storage classes, you can think of this as a waterfall.
So we start with all of the storage classes.
So we've got standard, infrequent access, intelligent tiering, one zone infrequent access,
Glacier instant retrieval, Glacier flexible retrieval and then Glacier deep archive.
And it's important to understand that this transition process like a waterfall flows down.
So Glacier flexible retrieval can transition into Glacier deep archive.
Glacier instant retrieval can transition into Glacier flexible and Glacier deep archive.
One zone infrequent access can transition into Glacier flexible or Glacier deep archive.
Importantly, not into Glacier instant retrieval.
This is one of the exceptions that you need to be aware of.
Intelligent tiering, this one can transition into one zone infrequent access,
Glacier instant, Glacier flexible and Glacier deep archive.
Then we've got standard infrequent access which can transition into more classes still.
So intelligent tiering, one zone infrequent access, Glacier instant, Glacier flexible and Glacier deep archive.
And then finally we've got S3 standard and this can transition into all of the other classes.
So transitioning flows down like a waterfall.
But generally you won't go directly.
Finally, most of the lifecycle configuration that I've been exposed to operates with multiple different stages
as the access patterns of objects change over time.
If you do have any use cases though, you can go directly between most of the different classes.
Whichever storage classes you do make use of, transition can't happen in an upward direction, only down.
And finally there are some restrictions or considerations that you need to be aware of.
Firstly, be careful when transitioning smaller objects from standard through to infrequent access,
intelligent tiering or one zone infrequent access.
And this is because of the minimums on those classes.
For larger collections of smaller objects you can end up with equal or more costs
because of the minimums of these different storage classes.
Additionally, and this is important to understand for the exam,
there's a 30 day minimum period where an object needs to remain on S3 standard
before then moving into infrequent access or one zone infrequent access.
So you can store objects when you upload them directly into standard IA and one zone IA, and that's okay.
But if you first store that object into S3 standard
and then you want to transition that into standard IA or one zone IA,
then that object needs to have been in S3 standard for 30 days
before you can lifecycle transition that into either of those infrequent access tiers.
That's really important to understand.
You can always directly adjust the storage class of an object from the CLI or console UI,
but when you're using lifecycle configuration,
an object needs to be in S3 standard for 30 days before it can be transitioned
into standard infrequent access or one zone infrequent access.
And then finally, and this one is a little bit more obscure still,
if you want to create a single rule which transitions objects from standard
through to infrequent access or one zone infrequent access,
you have to wait an additional 30 days before then transitioning those objects
through to any of the Glacier classes.
You can't have a single rule which moves something from S3 standard
through to the infrequent access classes,
and then sooner than 30 days moves those same objects through to the Glacier classes.
With a single rule, the object has to be within standard infrequent access
or one zone infrequent access for 30 days
before that same rule can then move those objects through to any of the Glacier classes.
You can have two rules which do that process without that 30-day gap,
but a single rule there has to be a 30-day period
where the object is in the infrequent access tiers before moving into the Glacier tiers.
Now depending on the course that you're watching,
there might be a demo coming up elsewhere in the course where you'll use lifecycle rules.
If this doesn't apply for the course that you're on, don't be alarmed if there isn't a demo.
In any case though, that's all I wanted to cover in this theory lesson,
so go ahead and complete the video and when you're ready, we can move on to the next.
