Welcome to this lesson where I'm going to introduce the theory and architecture of CloudWatch logs.
I've already covered the metrics side of CloudWatch earlier in the course
and I'm covering the logs part now because you'll be using it when we cover CloudTrail.
So in the CloudTrail demo, we'll be setting up CloudTrail and using CloudWatch logs as a destination for those logs.
So you'll need to understand it and so we'll be covering the architecture in this lesson.
So let's jump in and get started.
CloudWatch logs is a public service.
The endpoint which applications connect to is hosted in the AWS public zone,
which means you can use the product within AWS VPCs or from on-premises environments
and even other cloud platforms assuming that you have network connectivity as well as AWS permissions.
The CloudWatch logs product allows you to store, monitor and access logging data.
Logging data at a very basic level is a piece of information data and a timestamp.
So the timestamp is generally year, month, day, hour, minute, second and time zone.
Now there can be more fields but at a minimum it's generally a timestamp and some data.
Now CloudWatch logs has some built-in integrations with many AWS services.
These include EC2, VPC flow logs, Lambda, CloudTrail, Route 53 and many more.
Any services which integrate with CloudWatch logs can store data directly inside the product
and the security for this is generally provided by using IAM roles or service roles.
For anything outside AWS or for logging custom application or OS logs on EC2 for example,
you can use the unified CloudWatch agent.
Now I've mentioned this before and I'll be demoing it later in the EC2 section of the course
but this is how anything outside of AWS products and services can log data into CloudWatch logs.
So it's either AWS services which can log into CloudWatch directly
or you use the unified CloudWatch agent and that's how you integrate.
There is a third way in which you can use the development kits for AWS
and implement logging into CloudWatch logs directly into your application
but that tends to be something that we'll cover in the developer and the DevOps AWS courses.
For now, just remember either AWS service integrations or the unified CloudWatch agent.
Now CloudWatch logs are also capable of taking logging data and generating a metric from it
and this is known as a metric filter.
Imagine a situation where you have a Linux instance
and one of the operating system log files logs any failed connection attempts via SSH.
If this logging information was injected into CloudWatch logs
then a metric filter can scan those logs constantly
and anytime it sees a mention of a failed SSH connection
it can increment a metric within CloudWatch
and on that you can have alarms which can do things based on that metric
and I'll be demoing that very thing later in the course.
Now let's look at the architecture visually
because I'll be showing you how this works in practice in the CloudTrail demo
which will be coming up later in this section.
Architecturally CloudWatch logs looks like this.
First, it's a regional service
so let's assume for this example we're talking about US East 1.
Now the starting point are our logging sources
which can include AWS products and services,
mobile or server-based applications,
external compute services so virtual or physical servers,
databases or even external APIs
and these sources inject data into CloudWatch logs as log events.
Now log events look like this.
They have a timestamp and a message block.
CloudWatch logs treats this message as a raw block of data
so it can be anything you want
but there are ways that the data can be interpreted
and fields and columns defined.
Log events are stored inside log streams
and log streams are essentially a sequence of log events from the same source.
So let's say that you had one log file
that was stored on multiple EC2 instances
that you wanted to inject into CloudWatch logs.
So for example, var log messages
which stores system diagnostics under Linux.
Well, each log stream would represent var log messages for one instance.
So you'd have one log stream for instance one for var log messages
and one log stream for instance two for var log messages.
So each log stream is an ordered set of log events
for a specific source for a specific thing.
Now we also have log groups
and log groups are containers for multiple log streams
for the same type of logging.
So continuing the var log messages example
we would have one log group containing everything for var log messages.
So we'd set this for var log messages
and then inside this log group would be lots of different log streams
and each log stream would represent one source.
So one EC2 instance where we were receiving data for var log messages.
Each log stream would then be a collection of log events.
So every time an item was added to var log messages on a single EC2 instance
there would be one log event inside one log stream for that EC2 instance.
Now a log group is also the place that stores configuration settings.
So it's on the log group where we define things like retention settings and permissions.
And when we define these settings on a log group
they obviously apply to all log streams inside that log group.
It's also on log groups where metric filters are defined.
So these metric filters are constantly reviewing any log events
for any log streams in that log group looking for certain patterns
maybe an application error code or a failed SSH login.
When detected these metric filters increment a metric
and metrics can have associated alarms
and these alarms can be used either to notify administrators
or to integrate with AWS or external systems to take action.
So CloudWatch Logs is a really powerful product.
This is the high level architecture but don't worry
you'll get plenty of exposure to it all the way through this course
because lots of AWS products integrate with CloudWatch Logs
and use it to store their logging data.
So we'll be coming back to this product time and time again as we go through the course.
CloudTrail uses CloudWatch Logs.
Lambda uses CloudWatch Logs.
VPC Flow Logs use CloudWatch Logs.
There's lots of examples of AWS products
where we'll be integrating them with CloudWatch Logs.
So I just wanted to introduce it at this early stage of the course.
But that's everything I wanted to cover in this theory lesson.
So thanks for watching.
Go ahead complete this video and when you're ready join me in the next.
