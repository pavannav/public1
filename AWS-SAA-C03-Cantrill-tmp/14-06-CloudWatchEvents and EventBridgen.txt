Welcome back, and in this lesson I want to cover CloudWatch events.
We've covered CloudWatch earlier in the course, which focused on metrics and monitoring.
We've also covered CloudWatch logs, which focused on the ingestion and management of logging data.
CloudWatch events delivers a near real-time stream of system events,
and these events describe changes in AWS products and services.
So when an instance is terminated, started or stopped, these generate an event.
And when any AWS products and services which are supported by CloudWatch events perform actions,
they generate events that the product has visibility of.
Now, EventsBridge is the service which is replacing CloudWatch events.
It can perform all of the same bits of functionality that CloudWatch events can produce,
so it's got a superset of its functionality.
But in addition, EventsBridge can also handle events from third parties as well as custom applications.
They do both share the same basic underlying architecture,
but AWS are now starting to encourage a migration from CloudWatch events over to EventsBridge.
So we've got a lot of architecture to cover, so let's jump in and get started.
Now, both EventsBridge and CloudWatch events perform at a high level the same basic task.
They allow you to implement an architecture which can observe if X happens,
or if something happens at a certain time, so Y, then do Z.
X is a supported service which generates an event, so it's a producer of an event.
Y can be a certain time or time periods, and this is specified using the Unix cron format,
which is a flexible format letting you specify one or more times when something should occur,
and Z is a supported target service to deliver the event to.
EventsBridge is basically CloudWatch events version 2.
It uses the same underlying APIs, and it has the same basic architecture,
but AWS recommend that for any new deployments you should use EventsBridge
because it has a superset of the features offered by CloudWatch events.
Things created in one are visible in the other for now, but this could change in the future.
So as a general best practice, you should start using EventsBridge by default
for any of the functions that you can use CloudWatch events for.
Now both of these services actually operate using a default entity, which is known as an event bus,
and both of them actually have a default event bus for a single AWS account.
A bus in this context is a stream of events which occur from any supported service inside that AWS account.
Now in CloudWatch events there is only one event bus available, so it's implicit.
It's not really exposed to the UI, it just exists.
You interact with it, but because there's only one of them, it's not actually exposed as a visible thing.
You just look for events and then send these events to targets when you want something to occur.
So in CloudWatch events there is only one event bus and it's not exposed inside the UI.
In EventBridge you can create additional buses, either for your applications or third-party products and services,
and you can interact with these buses in the same way as the account default event bus.
Now with CloudWatch events and EventBridge you create rules, and these rules pattern-match events which occur on the buses,
and when they see an event which matches, they deliver that event to a target.
Alternatively, you also have schedule-based rules, which are essentially pattern-matching rules,
but which match a certain date and time, or ranges of dates and times.
So if you're familiar with the Unix cron system, this is similar.
For a schedule rule, you define a cron expression and the rule executes whenever this matches and delivers this to a particular target.
So the rule matches an event and it routes that event to one or more targets, which you define on that rule.
And an example of one target is to invoke a specific lambda function.
Now architecturally, at the heart of EventBridge is the default account event bus,
which is a stream of events which are generated by supported services within the AWS account.
Now EC2 is an example of a supported service, and let's say in this case we've got Bob changing the state of an EC2 instance,
and he's changing the state from stopped to running.
When the instance changes state, an event gets generated which runs through the event bus.
EventBridge, which sits over the top of any event buses that it has exposure to,
monitors all of the events which pass through this event bus.
Now within EventBridge, or CloudWatch Events, which I'm going to start calling just EventBridge from now on because it makes it easier,
but within EventBridge we have rules.
Now rules are created and these are linked to a specific event bus and the default is the account default event bus.
The two types of rules are pattern matching rules and these match particular patterns of the events themselves as they pass through the event bus.
We've also got scheduled rules which match particular cron formatted times or ranges of times.
And when this cron formatted expression matches a particular time, the rule is executed.
And in both of these cases, when a rule is executed, the rule delivers the particular event that it's matched through to one or more targets.
And of course, as I just mentioned, examples of these targets could be to invoke a lambda function.
Now events themselves are just JSON structures and the data in the event structure can be used by the targets.
So in the example of a state change of an EC2 instance, the lambda function will receive the event JSON data,
which includes which instance has changed state, what state it's changed into, as well as other things like the date and time when the change occurred.
So that's the theory of both CloudWatch Events and the EventBridge.
And both of these products are used as a central point for managing events generated inside an AWS account and controlling what to do with those events.
So at this point, that is everything that I wanted to cover.
Go ahead and complete this lesson and then when you're ready, I look forward to you joining me in the next.
