# 24.12 Step-12- [NEW] Deploy Stage- Create Deploy stage in pipeline

Instructor: Welcome back.In previous step, we have reviewedthe buildspec deploy.yml.file.Now, we are going to edit the CodePipeline to addthe deploy stage there.So, we'll go back to our CodePipeline here, right?And this is the pipeline we have created,which is eks-devops-pipeline-551.And here, we'll click on Edit,and we'll add the stage after build stage,we'll add that deploy stage, okay?And then stage name is Deploy, right?And then Add the stage.And in this deploy stage, we'll click on Add Action Groupand name of the action group, I can say DeployToEKSCluster.And Action provider, I will select AWS CodeBuild, right?And here, we'll click on Creating the project.So, which project we are creating?Means like, what we are trying to do,we are going to create a CodeBuild project now,so let me come back here and then maximize this,and the Project name, we need to provide it here.So earlier, we have said build, now we will saydeploy-eks-devops-551.And Project type is default project in Environment,all these things are going to be defaults.And this isthe service role, codebuild-deploy-eks-devops-551is the service role.This is very important role, where why,because for this service role only,we need to add the STS assume role,which we are going to create in next steps, okay?And now, in the buildspec,so we are going to say buildspec-deploy.yml.Okay, so buildspec-deploy.yml, and then rest all.We can leave it to defaultsand click on Continue to CodePipeline.And this should create abuildspec project for us,means like CodeBuild project for us.But as usual, this error comes.So that is fine, we can click on Cancel, Discard,and you should see the, this is the build project,and this is the deploy project, okay?deploy-eks-devops-551.Now, we will close this and come back hereand close this, right?And we'll not save anything, right?We'll go to the Pipeline again, right?And we'll try to Edit the Pipeline, right?And here, we'll try to add it again, and Stage name isDeploy, and Add the stage.And here in the Deploy stage add action group,and we'll say DeployToEKSCluster,right?Action group is AWS CodeBuild.And here in the AWS CodeBuild.So, we will selectthe artifacts as BuildArtifacts,which means whatever in the build phase we have,we got the BuildArtifacts,those we are going to use as input artifacts here.And the project name is deploy-eks-devops-551.And Build type is Single build,and there are no output artifacts or anything.All these things are going to be as is, and click on Done.And now, you can see DeployToEKSCluster,related action group is created.So, we can click on Save.This will save the Pipeline for us.And you can see, this is the Deploy phase addednow here, okay?Now, the next step is we need to go hereand then update CodePipeline Role CodeBuild Full Access.So that is one thing which we need to do.So, we'll go here and we'll go to the CodePipeline.And if we go to the Settings here,this is the CodePipeline role, very important.So, we are in the Pipeline section,and in the Pipeline section, we are in the Settings.And this is the service role here and for CodePipeline.So, I'll try to open that CodePipeline service role, right?And then, here we are going to add someadditional permissions for this role,which is nothing but AWSCodeBuildAdminAccess, okay?What happened?(cursor clicking)I'll say(keyboard keys clicking)CodeBuildAdmin Access.So, this is the one.AWSCodeBuildAdminAccess, and then click on Add Permissions.And you should see that AWSCodeBuildAdminAccess is addedfor CodePipeline service role.So, those two are the steps we have done just now.So, why we are adding it is, sometimes, this CodePipelinewill not be able to access the CodeBuild project,whatever we have created just now for Deploy.So for that purpose, we have added this, okay?But now, let's come back here,and in our next step, we'll focus oncreating the roles required for this implementation.I'll see you in the next lecture,until then, bye-bye, thank you.