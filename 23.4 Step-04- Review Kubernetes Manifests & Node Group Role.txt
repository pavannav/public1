# 23.4 Step-04- Review Kubernetes Manifests & Node Group Role

-: Welcome back.In step seven, we are going to use this ECR image,whatever we pushed here in our EKS deployments, right?So we are going to understand that deploymentand then service whatever we have createdas part of this section, okay.So we are going to have a deployment NodePort serviceand then ALB Ingress service.So all these three files we are going to reviewand also, we are going to review the worker node related,ECR access related policy.And once we review these things,we'll go ahead and then deploy the stuff.So let's go back and then review the K8 manifestcreated as part of this section, right.So, we'll go to our visual studio code.Let me close this temporary thing,whatever we have created,close the docker file.And close this and let me maximize.And if you go here, 02-kube-manifests, okay.In 10 ECR, elastic container registry and EKSyou can find 02-kube-manifests.So you'll have ECR NGINX deployment,ECR NGINX NodePort serviceand then ECR NGINX, ALB Ingress service.So let's start with ECR NGINX deployment, okay.So as usual, standard deployment,whatever we have created no change in it,how we have created deployments earlierit is the same thing.Only difference is, it will have theimage, whatever we have created that URL.So, I can remove this.And even one more time,I can add it, okay.So what you need to do is,you need to go to this templateand then update your image URL, here.Okay, so you need to update your image URL hereto make your things work with the imagewhatever you push it to the ECR, right.So this is my image URL, right?So image URL, so you can see in repositoriesinside this repository.So this is the image URL, which I am planning to use.I copied it and then I pasted it.Okay, so resources also have given, that's fine, okay.So now you are going to run two replicas of thatand this looks good, okay.So standard deployment definition.So that's the reason, one more time.I'm not going with the API version kind metadataall this stuff, okay.So, so far, we have done multiple timesabout the deployments.Same, we have created a NodePort serviceand only thing here isas we have created our image and then copiedthe index.html to the root context of html, right.Means like NGINX root context.So our run, healthcheck URL path/index.html.Earlier in our previous sections we have seen /app2 or /app1something like that, right.Here it is going to be index.html.Other than that, ports are going to be 80 and then 80,and they're standard NodePort service definition only.Okay, so we have done this from our fundamentalsto now multiple times.Okay, so that's good.And next is ALB Ingress,in previous all sections we have done the same thingALB Ingress.So, what we are going to do is like,so this is the one, right?So I'm also going to update the label herewith the same label, okay.So just to have common labels conventions.So ECR Ingress service we are going to create.And then, so in its annotationsso only the external DNS name you need to updateif you want to with a different DNS name, right?Why? Because this is my DNS,so ecrdemo.kubeoncloud.com,we are going to create.And in the service name for /star here,you need to update your kube-ecr NodePort servicerelated service name here, that's all.Okay, so this, you really don't need to changeif you use the same templates,but the changes here include only the image URL,you need to change, right?So that is one.And the second is NodePort service, nothing changes.And in ALB Ingress, you need to changeyour ecrdemo.kubeoncloud.com.So in these templates,what you want to change is only primarily two things.One is image URL and deploymentand ALB Ingress service related, host name,whatever you want to DNS register, that's all, okay.And that should be good.So this is about the manifest whatever we have createdand then we are going to deploy.So let me close these things,and we have discussed all the manifests.So the next thing is toreview theAccess policy.IAM access policy, okay.So we need to go to EC2 here, right.So I'll go to EC2,how to find our role for our worker node group, right?So we'll go to running instances, right.And we'll check select any one of the instanceand then which is related to our worker node group,you can cross verify that.So this is related to my EKS stuff only, okay.EKS demo one, NG private one, okay?And I'll go to description sectionand you can find the IAM role here, right.So I'll click on this role, right.And now if you see here,you should have something called Amazon EC2container registry read-only,and then Amazon EC2 container registry power user.Okay, so you'll have everything here, okay.Read-only, power user, okay?So I'll add this here in our documentation also.So these two policies should be associated.So these are already associated,how these are associated, also we can crosscheck here,right?So we can go here and then if we go to our EKS clusterusing eksctl,and then if you see create EKS cluster in the node groups,so you'll find something called, you have created a cluster.And then whenever we are creating the node group, right?So you are saying here full ECR access, okay.So you are associating a policy for our node group,whatever we are creating.Saying that full elastic container registry access.Due to that we have got these policies associatedfor our worker node groupswhich means whatever the parts we are going to deploy,whatever the Kubernetes workloadswe are going to deploy inside this node groupare going to get that ECR full access automatically.Okay, so that's about it.So let me go back,and go to our 10 ECR, Elastic Container Registry.And if you see here, we have discussed hereboth the things related toK8 manifests,and then EKS worker modes, right?So in our next lecture we are going to deploythe Kubernetes manifest and thenverify the stuff and thenaccess that URL and then do the clean-up, right?So I'll see you in the next lecture.Until then, bye-bye.Thank you.