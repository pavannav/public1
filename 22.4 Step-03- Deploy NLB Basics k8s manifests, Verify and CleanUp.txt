# 22.4 Step-03- Deploy NLB Basics k8s manifests, Verify and CleanUp

-: Welcome back.In this step we are going to deploy all the cube manifestsand then verify for our network load balancer.So let's go back to our terminal hereand we will enter the section 19 ELB network load balancers.And inside that we'll goinside 1901 LBC, NLB basics, right?And inside this, if you say LS, LRT and cube manifestyou'll find the zero one and then zero two related enginesapp three deployment and LBC and LB load balancer service.I'll say clearand I'll say cube CTL apply hyphen F cube manifest.So this should create the app three related deploymentand also a Kubernetes service of type load balancer.So let's wait for it to get created.So you can see app three engineers deployment is createdand basics LBC network LB is created.So now let's come back here and verify the ports at servicesand also verify the load balancer controller logs.So I'll say cube CTL get portsand this should provide usthe app three related engines deployment portwhich is running one by one already.And we will also see here cube CTL get SVC which is servicesin our Kubernetes clusterof default name space and you can find it here.Basics LBC network LB is createdof type load balancer and this is the cluster IP of itand it's external IP is nothingbut the DNS name of our network load balancer.And it created its port 80 for the externaland for the node port service it is using the 31751as the port.So now let's come back hereand verify the AWS load balancer controller port lock.So why do we need to do that?To see that this Kubernetes service related logswere presented there.So which very clearly says that this Kubernetes serviceis reconciled or associatedwith this respective load balancer controller.So you have user the external so thatthis respective to service whatever we have deployed, right?So this should be associated or reconciledwith this respective latest load balancer controllerso that we can go there and then verify the same things.So cube CTL hyphen cube system and get parts will providethe ports present from our cube system name space.And there you'll find AWS load balancer controller relatedports.Soil copy this one, right. Copy.And I'll say cube CTL hyphen Nfrom cube system name space logs hyphen Fand this respective load balancer controller related portand let's wait for the locks to displayand anywhere if you find right.So this name right?So this is the name we have which is:"basics LBC network LB".A little bit of that if you find also you can understandthat it is related to the same thing.See basics LB and you can also find a few thingsif you go up, you can find in detail here.See basics LBC network LB.So creating a listener of port 80,basics LBC network LB and created listener.And like this you can see all the thingswith the reference as basics LBC network LBwhatever you have defined as the name here.So which very clearly statesthat our load balancer,whatever you have deployed or our Kubernetes servicewhatever you have deployed to createa network load balancer now is reconciledwith AWS load balancer controller latest.So now let's go backto our AWS management console and go to EC2 here, right?And in EC2 go to load balancers, right?And in load balances you can see basics LBC network LBand this is the DNS name.So this DNS name whatever we are seeing, right?So some 129, some something, something right?EF4 is the end.So this should match our cube CTL.Get SVC here, the output from the get SVC.So let's here basics LBC networkLB 129 starting with and EF4 ending with.So here also you'll find the same thing, right?So this matches. So this is good.So now let's go to the listeners hereor additional things if you want to verifythis is a network load balancer you can see hereor you can even find here, type is network.And you can see here the scheme is internet facingwhatever we have providedand it pick the two availability zonesand there in two subnets US east one year and one Bit created this network load balancerand additional attributes we didn't provide.So all are in the disabled state.So now let's come back to listeners.And in listeners you can see the port 80 listener is createdand if you want you can click on this and then editand then see the things.So TCP protocol and port 80 and it is forwarding the thingsto the default target group it has createdand that target group it is forwarding the request to.So now we can go there and also verify the target groupfrom here or you can go to target groups hereand open the target group.So this port 31751 you can see right?So this one should match the 31751 here.So this is the node port right?So here inside this oneif you see the worker nodes should be registered here.So two instance IDs, so two private nodeswhatever it has created as part of EKS private node group.So you can also see from instances here.So if you open the instances, rightso you'll find those two instances zero DFand then 826 0DF and then58.26.826.So those instances were registered with node port 31751and it is waiting for the health check to pass.And health check whatever you have used isslash index dot html with HTTP protocol.So let's wait for it and once the health check is passedwhich is nothing but your nodes, you are ready to test it.The creation of your network load balancer usually takes3 to 5 minutes sometimes.So if you see here,even in the network load balanceralso it is in the provisioning state.So we should see this as active.So we can see here our load balancer has been changingthe state from provisioning to active.So let's go to target groups also.Open the target group, right?Let's come back here and refresh one more time,refresh and open it and let's wait for these thingsto complete.So you can see here when I refresh hereso these are healthy now.So the health check is passed and then we can access this.So let's go to load balancers and you can accessby copying the DNS name from hereor you can go here and then copy the DNS name from here.And this is simple engine app threeso that you can access your application directlyat the root context slash index dot html will be loadedand you should see "welcome to stack simplifyKubernetes fundamental demo application version V1".So this is successful.So now the next step here is to go aheadand then delete the things and then clean up.So we'll go hereand we'll say cube CTL, delete hyphen F,and then cube manifests.So this should delete our engines app related deploymentand also our basics LBC network LB relatedKubernetes load balancer service.So let's come back hereand ensure that our network load balancer is deleted.So this completes the network load balancerrelated basics demo.I'll see you in the next lecturewith another demo for network load balancer.Until then, bye bye. Thank you.