# 7.7 Step-07- Create Kubernetes Manifests for User Management Microservice Deployment

-: Welcome back.In this lecture, we are going to create the deploymentfor our user management microservice.And also we are going to createthe user management node port servicerelated Kubernetes manifest,and then also provide the environmental variables requiredfor this application to connectto the MySQL deployment,whatever we have created earlier, right?So let's go ahead and then do that now.So let's go to our GitHub repo,and we'll go to 0403 user management microservicewith MySQL DB.So we are going to create two YAML file manifests,so microservice deployment and then also node port service.So as part of that, we are supposed to providethe following environmental variablesto our respective container,which is nothing but a user management service container.So let's go ahead and then do that now.So now if you see here, 0403 user management microservice,and inside that kube manifest.So whatever I have created the five things,whatever as part of 0402 storage class,and then persistent volume claim config map,and then MySQL deployment.So all those five I have copied back here,whatever we have created in our previous lectures.Okay?So now we need to create zero six,and then zero seven, microservice deployment,and then microservice node port service.So if you see the best template related to our Kubernetes,which is a version kind metadata and then spec also,I'll put it here.So what we need to do, so now we are creatingthe user management microservice deployment.So the kind is going to be deployment.And for deployments, the API version is goingto be app slash V-1.And for metadata, we can say it is going to be name, right?So user mgmt microservice.And we can also give labels if you want to.And I'm going to queue the labelas app colon space user mgmt rest app,or even microservice, whatever you want to give.So now we are in the spec part,and under spec we'll have three core child elementsfor a deployment.So one is replicas, and second is selector,and third is going to be pod template.So now replicas, we can start with one replica,so that's not an issue.And selector means in deployment,we'll have something called match labels.Okay?So and whatever we are going to give here is appand then user mgmt rest app.As usual, whatever is present in match labels,pod template, labels, also we need to have the same value.Okay, so under template, means like this is nothing,but this is the pod template.And under pod template,we are going to have two core things, okay?So child elements, okay, metadata,and one more is going to be spec,which is nothing but pod specification.Okay?So, and under metadata, we are going to have labels only.Name, ideally we are in pod deployment,we really don't need to give pod a name here, okay?And the label, we are going to give the same thing,whatever is present here.Okay, so good.So still here, we are good.Under template, we have two child objects,metadata completed.Now we are writing the spec.So under spec, we'll have something called containers.And then if we have any volumes to be mounted to this part,then we can have volume.But currently we don't have anything.So we have only containers, right?So containers is a list.And then you can have one container under this,which is name, and then user mgmt rest app,and its image, right?Container image, you are going to provide, right?So we'll provide that shortly.And next is going to be container ports, right?So let's define the ports here.And I'll say container port, 8095 is my application portfor user management microservice.So it means like which is my container port,whatever I have defined in my application,whenever I built the container.It is 8095.So I'm providing it.So if you want to give the name of the port also,you can give it the tag name, if you want to.Okay, so I am leaving it.Okay, so all those are minor things.So I'm leaving it.So we have completed name, image, and then ports.So the next thing is going to be the ENV, right?So let's complete the environmental variables.So under environmental variables,we provided task key value base, right?So in the environmental variables are also list, okay?So we can have name and then value, like this, okay?So we are going to provide DB host name, DB port,DB name, DB user name, and then DB password.So five things, okay?So we need to have five things, like this, okay?So let me copy, paste, and 2, 3, 4, 5, okay?So now let's start with that DB underscore host name.Okay?My DB under score host name is going to be MySQL.Okay, so that is what is my thing,whatever we are defined here, right?So, and the next is DB underscore port, right?And the value of DB underscore portis going to be 3306.Put this in double quotes,and ensure that we have the DB name.So which is nothing but our application means,like user management applicationto which schema in our database, MySQL database,it is going to connect to.So we have created a schema named user mgmt schema,so we can use that.And the next is DB underscore user name, right?So we have going to use root user,and the root user password also with MySQLunderscore root underscore password,we have defined it as DB password one one.So let's define the variable DB password,and I'm going to provide it as,so let's also provide that DB password.So whatever we have givenin our MySQL deployment here,which is nothing but MySQL underscore rootunderscore password, the same thing,let's provide it here, right?So which is nothing but DB password one one, okay?Now let's also update the image name here.So let's go to our Docker Hub.And if you see in the repositories,you'll find somethingcalled kube user management microservice.Okay?So inside that, you'll have three tags.One is 1.0.0, 2.0.0, has two DB, and then 3.0.0, et cetera.So whatever you find, 1.0.0 is going to be there.User management microservice connecting to the MySQL DB.So you can take this tag completely.User kube, user stack, simplify kube,user management microservice column 1.0.0,which is nothing but this one.So usually I have also in the read me updatedthat this need is now following the environmental variablespassed to our respective container, right?So now let me copy this and come back, and then add it here.Okay, so now this complete server microservicedeployment creation will move onto our user management node port service,whatever we want to create.So let's start with the kind is service,and the API version is V-1.And the name of, means like the under metadatathat will have usually two child items,name and then labels, primarily.And in future, if you want to use name spaces,you will have the name space item,but we are not using anything like that for now.We are going to go to the default name space.So we'll leave it like this, okay?And user mgmt, hyphen, rest app, hyphen,service will be my service name.And under labels, I'm going to give it as user mgmt app,rest app, okay?So now the next thing is under spec.So we'll have three things usually under a service,which is under spec, child elements,primarily important ones.So selector and ports, okay?So type, selector, and ports.So as we are going to create a node port serviceto access this user management application via internet.So we are going to create it as node port,and next is selector.So selector is nothing but whatever is presentin the port template label,which is nothing but, so in the port, template, label,whatever is the label.So we need to provide the same thing here.So that what happens is whatever that trafficcomes to this service, it will be ableto send to that port based on this label,means like it can select that portbased on this label, whatever we provided.And we'll have three types of ports.So one is we have provided the portsand another one port will be our service port.Port is nothing but service port, and our container port.So we can give it as 8095, same thing.And we can even define our node port, whatever we want.So now again, we can say it as 31231.Okay?So this completes the creationof user management node port service also.So we have created deployment and then service.So in our next lecture, we are going to test these thingsand then understand how it is going to behave.So I'll see you in the next lecture.Until then, bye bye.Thank you.