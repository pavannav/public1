# 4.17 Step-14- Kubernetes Deployment - Rollback Application to Previous Version - Undo

-: Welcome back.In this lecture we are going to learnabout rolling back a deployment.So we are going to go into 0403,and we can do this in two ways.One is roll back to the exact previous version,whatever we have just now updated,or we can go to the specific version of the rollback.So we can do that in both ways.So in step one we are going to roll backto a previous version.And in step two we are going to do in a specific version.So let's start with understanding,means like let's get the rollout history first,and then after that we'll go aheadand then see what we are going to do.So first thing is Kube CTL rollout history,right, Kube CTL rollout history and deployment.And my first deployment.So we should have the three releases.One is the default version, whatever we have deployed,and then we have upgraded it using set image which is 2.0.0.And later using edit deployment, we went into 3.0.0.So if we want to see specific version,what changes happen, we can even see that.So let's go here and in rollout history providethe revision numbers.So even you can say like this, okay,hyphen, hyphen, revision is equal to one.So it'll provide in revision one what happened.So we need to observe the image tagor annotations present there.So in this respect to revision one directly,it is a first deployment.So we will have only image.And in this image you can see 1.0.0, in the same way,for revision two, it is going to be image targets 2.0.0,and the annotation if you see what is the change cost,in this annotation you can see Kubernetes.ivo,and then change course.And using Kube CTL set image you have changedyour tool 2.0.0.So like this you can see everything clearly.So now let's see revision three.So there also you'll see the annotation and the change cost.And using Kube CTL edit deployment,you have changed your image version from 2.0.0 to 3.0.0.So that's what is the verified changes in each version.Okay, so now roll back to previous version.So let's go ahead and then roll back.So to roll back, we just need to say Kube CTL rolloutundo the deployment, whatever we have done.So Kube CTL rollout, undo deployment,and my deployment name is my first deployment.We can even copy paste or we can even do this way.So let's execute one more time.Okay, so the changes got deployed.So now, which means like from V3 it should go to V2 version.And so let's see the rollout history one more time, right?So rollout history and remove that revision.So that will see all the history.So it we should have a rollout history for now, right?So why, because now we have changed itfrom three to four, okay?And the image version from three to two,which means here earlier you have the revision version two,you have undo means like you went to that version.So that's the reason.Now you got the four with 2.0.0.So now let's come back here.So if you roll back, it will go back to revision two,and its number increases to revision four.So our revision two number got revision four now, right?So now if you want you can crosscheck your deploymentsand then replicas it, everything we can check now.So Kube CTL get RS, right?And it should be using the deployment,whatever is used earlier for V2 version, okay?Replicas it and get ports.All should be deleted and then recreated now.So within last 76 seconds only.So all these got recreated, in the same way,if you want we can access the application,and then we should see V2 version have our applicationbecause that is what we have rolled back now.So let's go back here.And currently it is V3 and then we roll back itto older version, which is V2, and it should see V2.So that's the story here.So now in our next step, we need to move onwith the roll back to specific version.So let's do that now.So as usual, you can see your rollout history,and then we have seen just now that is nothing,but four is the current version, right?With the 2.0.0 as the image.So now I want to roll back to specific version.And my specific version is going to be version three,which is nothing, but where I have the 3.0.0application V3 version, I am having herein this revision three.So I'm going to say Kube CTL rollout,undo deployment, my first deployment,and then I'm going to give the revision number herewhich is nothing but two specific revision.And my revision number I'm saying is this one, three.So which has the image 3.0.0.So I'll save this, right?And once the changes are done, immediately,we are going to see it will roll back to that version.So I'm going to fast check the ports, okay?And then it is deleting and then recreating it.And we will go ahead and then getthe rollout history, right?So we should, three should go away,and then we should get the same thing as five,and we got it, right?So that's the thing.So now we can access the application,and we should have the V3 versionof the application because we roll backto that version, okay?You can see that.So that's about the 0403 roll back deployments.One last thing in this is like if you want torestart your applications in a rolling restart fashion,means like all the parts need to be restarted dueto some memory issues or some whatever you have.And if you want to restart your application,so you can do a Kube CTL rolling restart.And in your deployment name, right, deployment space,deployment name or deployment slash my first deployment.And it will do the restart.So once the restart is done, you can say Kube CTL get ports,and the restart should be happening now, see?So now if you see here, all restarted,eight seconds is the age you can see it, right?13 seconds.So just know all these things got recreated immediately.Okay?So that's about the roll back deployment.So in our next lecture we'll focuson pause and resume deployments.So I'll see you in the next lecture.Until then, bye bye.Thank you.