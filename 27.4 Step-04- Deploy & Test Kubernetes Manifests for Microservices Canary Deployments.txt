# 27.4 Step-04- Deploy & Test Kubernetes Manifests for Microservices Canary Deployments

-: Welcome back.In this step we are going to deploy the manifest.Okay, so let's go back to our terminal,and clear, and go to 14 microservices canary deployments.And I'll say kube CTL, apply hyphen F, kube manifest.So all of our applications should be deployed,and I'll pause the video until everything is created.So only one thing we'll check, and then pause the video.So V1 and then V2 related notification partsshould be created. Two parts are getting created.That's good.So until that, load balancer is provision.So I'll pause the video.Our load balancer is active now,so we can crosscheck our DNS.As usual, the drill continues.So I'll say, NS look up,and it has something called 8-99, and then 1-0-7.So NS look up, and I will say,what is the name we have given for this?It should be canary demo dot, kuber cloud, .com, right?So let's enter. So, DNS is good.So let's go and then test this URL.Okay, so copy, and then notification, x-ray.So we can give it in browser and then test it,or we can even test via postman.So for postman, need to add the environmentand all that stuff.So for now I'll make it bigger, and show you.So you can see one time app version V1 coming,and then one time V2 is coming. So let me refresh.Currently you are seeing V1,so let me keep refreshing it and we'll see what happens.Okay.See, now V2 came. So V2 and then V1 alternatively.We are getting means likehow the 50-50 traffic distribution.So we'll keep getting V1 now.So let's see till we get V2 one more time.See now we have got, v2.So now let's go back to our x-ray,and see what is happening there.Okay, so last five minutes,and then it is trying to compute the mapand we can see that whatever we have seen here,user management too, V1 notificationand then V2 notification, the same thing.We are seeing it here. So that's a good thing.So which means like whatever the canary deploymentwhatever we have performed,user management is services distributingthe traffic to V1 notification microservice.And also V2 notification microservice.So this completes the section of testing our deploymentand testing of notification microservice canary deployment.So we also need to understand what is happeningin the background, right?So as far as notification perspective,what is happening here is,in both the deployment files, okay?So we need to understand little bit about the meanslike we need to go back and then refresh our memoryabout the labels and selectors section. Okay?Which means like, from if you have a deploymentand then how the service,it means like deployment fronting service is going tosend the traffic to those respective parts, right?So this deployment has a label, named the selector labelis match labels app notification, rest step.So this deployment will find its spots usingthis match label, and then whatever has in the port templatein the same way whatever is there in the port template.The same will be also availablein our notification cluster IP service, right?So you can see the selector label insidethe notification, microservice, cluster IP service alsois notification, rest step.So, in V2 notification microservice, we have the same thing,app notification, rest step.And then in V1 also, we have the same thing.So which means, this respective cluster IP serviceis distributing the traffic to boththe notification services using that cluster IP servicewith this respective selector label.So that's what is happening in the background.So we can even have adding like track is equal to stable,or track is equal to canary,additional labels and then play lots of stuff,and then even complicate ourselves.But I try to make it very simple.And then trying to say that,this notification microservice related cluster IP serviceis having the selector app notification rest app,and same is available insidenotification microservice deployment V2,and also in the deployment V1.So that's the reason this cluster IP service is able todistribute the traffic to both thedeployment related ports.So that's what is happened in the background.So now coming back, so we are going to clean up the stuff.Okay, so we have completed the demo,and then we are going to do the clean up.So let me paste it, and then do the clean up.So this will delete whatever we have created.And in our next lecture we are going to understandabout downside of this defaultKubernetes canary deployment approach,and the best ways to,how we can perform additional cannery deploymentsin an effective manner.So I'll see you in the next lecture.Until then, bye bye. Thank you.