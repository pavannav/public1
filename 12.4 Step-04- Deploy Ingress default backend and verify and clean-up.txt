# 12.4 Step-04- Deploy Ingress default backend and verify and clean-up

-: Welcome back.In previous step, we have successfully createdthe ingress manifest with the default backend option.So now, we are going to go aheadand then, deploy that and then, test it.So, let's go back to our terminal here,and go to 08 new and 08 01 and not 01.So, we'll go to 08 02 and inside 08 02 LB ingress basics.So, we'll run the command KubeCTL,apply hyphen F and 01 kube manifests default backend.So, this should create the Nginx deployment for us,and also it should create the node port service,and also it should create the ingress service for us.So now, we can see all three things were created.Deployment, service, and then ingress.So, let's go ahead and then, verify that deploymentand ports first and then, we'll move on to the ingress.So, I'LL clear KubeCTL, get ingress, why I came to ingress.So, we'll first do the deployment, right?Verify that KubeCTL get deploy.So, all these things are created in the default namespace.That's the reason we really don't need to mentionhyphen N kube-system or hyphen N default namespace.So, both are same.So, you can say default and it should be the same thing.So, you can see app one Nginx deployment is ready.One by one is ready.So we'll say, get ports,and we should see that app one Nginx deploymentand that respect to pod guard created successfully,and then, it is running.So now, we'll also see KubeCTL get SVC and then, it willlist the app one Nginx node port service for us, right?You can see 80 column 32291 is done.Node port service. Node port half hour respect to service.So now, the next thing here is we need to sayKubeCTL get ingress.So, this should list the ingress service for us,whatever we have created, which is ingress Nginx app oneand this belongs to the class my AWS ingress class.And here, is the address, app one ingress.This is the name of my load balancer,whatever we have provided here, see?App one ingress hyphen some,some dynamic id.us east one.elb.amazonaws.com, right?So now, let's come back here to our load balances.So, in EC2, right?So, go to services and in EC2.So, let's go to load balances.And in load balances, so you should findthat app one ingress.The name of my load balancer is app one ingress.and it's DNS name is app one ingress hyphen,so and so, so and so.And its state is currently active and you can seein the description, lot of informationabout that load balancer.So, the listeners, it has created the HTTP 80 listenerby default, and also if you see inside it, right?So, it should have the default backend.So, this is the default backend requestsotherwise not routed.So, it is added as a default backendand it is going to some target group here.So, we'll go and then verify that target group now.So, let's come back here and go to target groups here,right? And in target groups, you'll find hereK8S default app one Nginx.So, this is something the older one.So, I'll just remove this.So, this is unassociated one, user management one, see?Non-associated, I'll just delete it.So, this is coming from previous demos, so I'll remove that.And now, if you see here K8S default app one Nginxis there and it's port 32291.This is the node port.So, let's come back here and verify the same thing, see?In KubeCTL get SVC, your app one Nginx node port is 32291.Same is also added here, which means your node port service,your node is registered here with that respect to port.So, and protocol is HTTP and target type is instance.So, if you remember we have discussedabout that traffic mode, right?Which is nothing but instance and then IP traffic modes.So here by default, right?So, by default, if you don't define any traffic mode.So, then the target type is going to be instance.And if you define it, you can define the target typeas instance or IP.So, let's go to annotations here and I'll say IPor I can search for target type.Yeah, you can see here.ELB ingress Kubernetes io target hyphen type instance or IP.And, if you see here, instance mode will route trafficto all EC2 instances within the clusteror node port open for your REST service, right?So, service must be of type node port,our load balancer to use the instance mode.And IP mode will route trafficdirectly to that respect to port IP.And another important thing to note here isso let's go to that target type,and then, come here and you see at the top, right?So, this is the default.So, what is the default for that is instance.So, which means by defaultwhether you define this target hyphen typeas instance or not, by default it will take the instance,and explicitly you need to define for IP,if you want to need IP, right?So, that's about the target type.So now, let's go inside that, right?And see? This is the target type instance and protocol,protocol version.All these things are good.And this is associated to the load balancer hyphen ingress,that is good.And total targets, two targets and healthy, right?So, you can see both, both instancesregistered successfully here.So, we have two nodesand then both nodes registered successfully here.If respect to of whether that pod is present in which node,it doesn't need that, right?Why? Because, your node port servicesspan across all the nodes.So, that means whether you have the port in which nodeis not a consideration here.So, if in your, in your private node group in Kubernetes,if you have 15 nodes, all 15 nodes will be added here.So, that's about the instance mode traffic,instance mode related thing.We can also see here the health status is healthy,and we can also go inside the monitoring,and go to health checks and review the settings.So, protocol you have provided HTTPand path you have provided as slash app one index.html,and traffic port you have provided,and all these things interval.If you remember, we have provided 15 seconds, see?15 seconds.So, all those things, whatever we have providedin the annotations for the health check settings.So, all these things are available here.So now, let's go back here and also,go back to our GitHub here, describe ingress controller.So, just review and understand more about it.So, let's copy here and go here.KubeCTL describe ingressand ingress name is ingress hyphen Nginx app one.And if you see here, right?In the ingress, name, namespace address,and in the default backend, you see?Default backend is the value, it is provided here,which means in host there is no paths,only the default backend related informationis provided here.So, just make a note of these things and then, go aheadand then review these things in the next demo.How it comes. Why?Because in the next demo, you'll use the rulesand there it'll say slash star, go to this.So, like that you're going to see.So currently, you have the default backend here,but in the next demo, we are going to see this differently.So for that purpose only, I'm showing the differenceswhich means whatever the rules you have definedin the ingress.So, those things using the KubeCTL describe ingress command.You can review them directly here, whether they weresuccessfully created in a right way or not.In the annotations also, you can see in detail,and also, you can see there are no error events here,successfully reconciled.So now, let's come backand we have also verified the target groupsand all those things.So now, let's go ahead and then access the things.So let's come back here, and say KubeCTL get ingressand you'll get the name.This is the address.This is the same as the DNS name of your load balancer.So, let's come back here and go to the load balancers.And in the description section,search for whatever you have copied here, both are same.So, you can give this and the root context pageis Nginx default one should be displayed.And our core page,which we need to test is app one slash index.html.And here, you'll see welcome to stack simplify related pageapplication name, app one, right?So, this completes the demonstrationof ingress using the default backend.So, if you want to review the logs of your respect to portor if you want to review the logsof your load balancer controller also,you can review all those things.So now, we'll go aheadand then, clean up whatever we have created.And if you want we can also review once theKubeCTL get ports hyphen N kube-system.And if by any chance,if your ingress is not working at that point of time,it is always good to go to thatrespect, respect to load balancer controller portsand also verify.So, I'll say cube system and logs hyphen F, mine is working,so we really don't need to go here,but I'm just trying to show you, right?And see, in both the portsif, if you are seeing any errors or anything, right?So here, there is nothing related to that.All are info only.Just for our additional things.So now, let me clear this and I'll say KubeCTL,delete hyphen F and 01,which is kube manifest default backend.So, that we are removing the deployment serviceand ingress service whatever we have created, right?So now, this should also delete the load balancer,whatever we have created here.So, let's come here and refresh, right?See? The load balancer, whatever app for ingresswe have created is gone now.So, let me close these things,and your deployment and service also cleaned up.So if I say KubeCTL, get all, get all fromdefault namespace, only the default Kubernetes service,and also the, whatever the ingress class we have created,those should be displayed, see?Service Kubernetes default cluster IP servicefor our Kubernetes is displayed here.So, nothing is present here.Or you can say get ports, or get SVC or get ingress.Everything is cleaned up, whatever we have created.So, in our next lecture, we are going to focuson demo two, where we are going to define the routing rules.So, I'll see you in the next lecture.Until then, bye bye.Thank you.