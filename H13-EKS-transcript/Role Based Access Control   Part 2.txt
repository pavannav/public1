ript


0:00
So uh welcome back guys. Let's continue. So multiple plans we have for today. So
0:07
directly jump to our main topic. Right. So what I'm going to do here by the
0:13
meantime also let me start our mini cube cluster. Right. So first thing guys um I
0:22
would like to quickly summarize mainly the command step by steps. Right. And if
0:29
you follow these command in the same sequence and in the same order uh you
0:35
will have your uh user creation completed and after user created then
0:42
we'll move to rulebased access control. Okay. So what is the plan for today? Let
0:50
create some kind of real scenario. So what are topic guys we have discussed till date in the kubernetes in the ls of
0:57
security when I say security is a big topic
1:03
uh I mean to say here the authentication part or the authorization part okay so
1:10
what I mean by this again very quickly revise because from last couple of days we are talking about this topic only
1:16
right so uh I'm going to um
1:22
create one room in the Kubernetes cluster. You guys know this room is
1:28
known as name space. Okay. Uh let's give uh this name space a
1:35
name called uh test. Okay. Or let's say testing team or
1:41
testing maybe. So let's say this name space we created for QA team or for testing team. Okay.
1:49
And what we want what we want we have a some user that we going to create let's
1:55
say the username that is a real human being from one of our department
2:02
uh maybe uh uh maybe let's say Eric
2:09
so we have one user that we'll create inside the Kubernetes so let's say this
2:14
is our Kubernetes cluster so we will create one user here. Now it is your
2:20
choice you want to create a user user
2:26
uh for uh password user base or keybase. So here we are going to create a user uh
2:34
with a certificate based user. So we'll create one certificate for this user and
2:39
uh we will create one uh private key for this user. So this certificate and this
2:46
private key okay is used by uh your user computer
2:52
for login and this login is called authentication partner. Okay. And one
2:58
thing is I told you in my last class we can create certificate for much more
3:03
purpose in the real computer world. But this certificate is working like uh
3:08
working like a uh certificate for the user.
3:14
Okay. So it is good practice or I can say it's compulsory practice also when you create a certificate and while
3:21
creating a certificate they ask you a name that is called common name.
3:27
CN. Okay. So, give your common name the name of your user.
3:32
Okay. So, technically I can you can think in this way. What certificate contain multiple things certificate
3:40
contain your public key, your name of the user, your company name and much more information certificate cover.
3:46
Okay. But in the simple term as complete summary
3:51
as complete summary you can think this first thing that we have in our user
3:57
computer or in the client side is like a username in the simplest form and this
4:02
private key is like a uh your password.
4:07
Okay. So after user created uh we will tell this user if you want to login in
4:13
the kubernetes you can login after kubernetes check your login password you've been authenticated
4:21
but after authenticated we are going to give a limited power okay and power would be something like
4:27
this we we might have multiple name space but you can only work in this name
4:33
space only in this room only. Okay. And second thing is in this room
4:39
also we are going to give a very limited power. Okay. And power will be something like
4:44
this. Inside this room you can do multiple things. Okay. That's called
4:49
resources or you can use multiple resources I can say. So you can use a resource called board. You can use a
4:55
resource called deployment. So multiple resources we have.
5:01
Okay. But on this resource what can you do or what can't you do that is called
5:06
verb or actions. Okay. So we'll define some verb for you.
5:14
Let's say in this resources you can only get
5:21
the details of the port or you can list what is going on. Okay. So these verb I
5:27
want uh you can perform. But for example, if you want to edit something, you can't do, you want to create
5:33
something, you can't do, you want to delete something, you can't do. So I'm giving you a limited power. So in the
5:40
simple term what I want Eric as a user after logging to the Kubernetes Eric can
5:46
only work in this room or name space and in this
5:52
name space okay Eric can only uh access port or the deployment Eric can't access
6:00
services Eric can't access uh maybe some other components also but again in the
6:05
port and the deployment what Eric Eric as a user can do they can only do these
6:12
things. They can only monitor what is going on. The port is
6:17
down or not. They can see the details the deployment is going on or they fail.
6:22
So only these information Eric can do. So you can think maybe in my company Eric we hire only for analytics purpose
6:30
and I want after Eric login Eric can't do much more than analytics.
6:36
Eric have no power to create new pool. Eric have no power to delete the port or
6:41
create some new deployment remove entire name spaces. Eric I don't want to give any power to the Eric. So I want
6:50
Eric uh have a limited access control and this access control we are
6:56
controlling with the help of role based. So what we will do we create a one role.
7:03
So this entire concept resources plus verb is known as role. So we create one
7:08
role. Role means Eric can do only get or list on the port. Eric can do get and
7:16
list on the deployment. This is called role. And you can give a role and name.
7:21
Uh let's say I'm going to give a role called my moon or monitor role hyphen
7:28
role. Just give some name. So just a name we'll give.
7:33
Okay. And what we do? So we we'll tell in the computer that we have one Eric
7:38
and whenever Eric login successful I want Eric will have one power or one
7:44
role or one position in my company. You can think in this way that is called my monitor role.
7:52
Okay. So this is the role you have. This is the user you have.
7:59
Okay. And giving some user a role that is called binding. role binding that we
8:05
have to do. Okay. Or in the simple term it is you can think uh if you talk about the
8:11
English language or any other language also. So normally in we write something
8:16
like this. For example uh Eric play or can play
8:23
football. Okay. So Eric is a subject.
8:30
What can Eric can do? is a action or the verb and on what object they can do is
8:38
the object and why I'm giving this statement because the same term we are going to use here in our case Eric is work as
8:46
subject so Eric here also known as subject
8:51
okay what can Eric can do it's a verb verb
8:56
means this role is like a verb in the inside the role we can define
9:03
these verbs where Eric can do get and list. Okay. And where they can do get
9:08
and list on the football in our case football is like a resources like a object. Object means like a resources.
9:14
Resources means poured at the deployment. So this resources is like a object that
9:20
you normally do in English grammar. This verb is like a play here that I
9:26
take the name here and Eric is like a subject. Okay. So, so whatever way guys you want
9:32
to understand, you can understand this concept. I already explained you
9:38
in my last class. But today the plan is what we are going to do. Okay, I'm going
9:45
to do three steps today. Okay, first I'm going to create a name
9:51
space. This the first step I would like to do. Okay. Then the main three step is I
9:58
would like to create a user that you guys know but I want to create quickly create it because last class we have
10:04
having some small error that I'll show you how to fix this again same some but one simple error nothing very technical
10:11
okay so these are one one main step we are going to do after we get the user we
10:17
also create some role okay after the role and we do the role
10:24
binding Okay. So that what
10:31
there's a plan for today. Okay. So without wasting time let's very quickly go after you know how to create your own
10:38
role because lot of role already available in the comp in the Kubernetes.
10:43
Using those role is not big deal. So if you want to use pre-created role you can use it. But today I'm going to show you
10:50
how we can create our own role. Okay. Okay. So this is that is the reason why I use a term called how and
10:58
how we can create our own custom role. Okay. And you guys know we're
11:05
going to create a user and on the in this role we are going to give this power to the user. Okay. The score role
11:11
binding that is the plan for today. Otherwise this uh diagram guys I already explained
11:18
you last class but I again explain you in a little bit different way maybe. Okay. So let's go quickly go to
11:25
Kubernetes cluster and do the further things. Okay. So right now uh because our plan is to
11:33
create the user first that command you guys know but I want to show you very quickly. So what I'm doing here I'm
11:38
using put here as a program to do the remote login
11:43
and uh the Kubernetes is running in this system. We know the IP address. Maybe
11:49
you can use this command also. It will tell you the IP address. Okay, so this is one Linux OS and any Linux OS
11:57
normally support remote login or SSH. So let me type this IP address.
12:05
So I'm doing remote login to the system. Okay, one minute. Let me increase the
12:12
phone size. Why am I doing this? so that I can very
12:18
quickly copy paste the command also for you and thing will go a little faster.
12:25
Okay. And guys in there we have a user called docker and password is called TC user. So technically this is the
12:34
mini cube computer right and let me log in with the root account
12:41
and I told you guys in my last class if you want to create a new user you'll go to folder called v lib mini cube
12:50
okay and in the search folder so we'll go here and I'm also copy
12:56
pasting the details okay and now here I'm going to create a
13:01
a user and for the user you have to first create a private key again this will be a quick revision of your command
13:08
I'm here okay so open SSL generate
13:15
RSA I'm going to put the password in this file eric key with size let's
13:21
lesser 1024 so that your private key created
13:26
okay then I'm going to create a uh certificate It's called CSR request
13:32
certificate as a new certificate. I'm going to use this particular private key
13:38
because private key is the one who generate your public key internally. Okay. And this certificate going to
13:43
store in the file called Eric CSR. You can give any name CSR file. I'm just giving. Okay.
13:51
And when you guys hit enter, they will ask your company details, country name. But the main thing is main thing is uh
13:59
is your common name. So I'll hit enter. I'll hit enter and they give the details
14:05
and they create it. But but if you have any command where when you hit and they
14:12
ask you the detail uh those command is called interactive command and if you
14:17
want to use any interactive command in your in your some automation script okay
14:23
like script or python or nible for example uh so thing won't work so so my
14:30
point is here mostly the command give you options rather than you hit enter if
14:35
you want to give your details is so you can give by some option here. For example, uh this certificate has we have
14:40
to give some like common name. So we can pass one option called subject.
14:46
Okay. And here when you hit enter whatever detail they ask you we can give a common name for example with CN
14:51
keyword. Okay. Let's say my common name name is again my username or let's say they ask for your company name. So they
14:59
they have the keyword O. Okay. So
15:04
I think this is related to your team. So let's say this is belong to technical team.
15:10
Okay. So guys I'm just giving a different way. If you do if you if you
15:15
don't want to use this that's okay. You just hit enter. They ask you all the detail. I show you my last classes.
15:20
Enter enter enter enter. Give a common name. Common name is important. That's the main thing I'm talking about.
15:26
So common name means this certificate belongs to a user and cubernetes know
15:33
you with your common name and common name is your Eric and Eric here work as a user. So either you can use this
15:40
option. So this option guys won't ask you you know in the last class class if you remember I uh I uh manual type
15:48
company name country name common name but here one click without the asking without the prompting
15:55
uh this command now become in in non-interactive command and any
16:00
non-inactive command is good to put in some script for the automation.
16:05
Okay. And now if you see guys this CSR certificate has been created.
16:10
Okay. Now this certificate guys we have to sign it. So I told you guys uh certificate we can only use after we
16:16
have a certificate signed. So and for signing you should have a CA
16:22
by in our case CA is available. So I can actually sign it. So I show you in my last class signing we have to use X509.
16:31
You can think X509 is a one kind of uh format or one kind of standard we use in
16:38
the world for the certificate data sign. Okay. And we're going to sign a request
16:44
certificate for CSR where this certificate is Eric CSR file that we
16:49
already created by this line. Okay. And this certificate we are going
16:55
to save in CRT file. That's your final uh file. And for signing we need uh CA
17:02
key. In our case CA key is available already with us because CA is already created. Okay. And plus you also need uh
17:10
what I say CA certificate and CAS also with us.
17:18
So when you hit this um your uh certificate created. Okay.
17:25
This was the error coming uh last time. uh nothing very special I told you in
17:31
the last class this error is not because of this command the way CA has been created so this CA is not created by us
17:38
somebody has created in this system so what happen guys whenever any CA sign
17:43
every sign certificate they give some number one number two number three it's called serial number so that serial
17:51
number comes normally automatically but this CA however they created they are not generating any serial number of the
17:58
certificate that is the reason why they fail. So guys you don't have to know about this how to get a CF in this topic
18:05
for Kubernetes but that was the only small challenge. So for this you want they will generate a serial number
18:12
automatically. So we can write this command create serial
18:18
that's all now thing work and sign is okay. So this certificate has been created
18:25
created and what the certificate contain username some serial number like 1 2 3 4
18:33
5 something like this right or your your public key of the user or some other details okay so
18:41
so technically guys this part has been done creating user has been done or if I
18:47
explain you this part has been done your cr has been created
18:52
key has been created and this we have created in the Kubernetes server and
18:58
this but this thing going to use by your user. So we have to transfer these things to the user. So you can use SCP
19:05
SAP uh to transfer these files. Okay. So but let me give the history to you so
19:12
you can use as is. So these are the commands you use that's all. So you want to create a user first this command
19:18
second this command third this command three command you have to use and your user has been created that's all
19:25
that's what I want to show you right even though let me do one more small thing very quickly so you don't have to
19:32
worry much I share this document to you
19:38
and this is not the specialized command for Kubernetes this command is for
19:43
almost everywhere where any tool or technology use this is the very commonly
19:48
used commands we use for certificate based user okay
19:55
so user created the next thing is
20:00
next thing is we'll create a role before we create the roo before we create a role okay let me first create a name
20:06
space so can we test something so how to create a name space you guys know I'll go to my client system this is system of
20:13
windows And if I run the command here because I already log in till date we are using multiple time. These are the
20:20
name space we have. Let me create a new name space. Create name space called
20:26
testing. Pretty simple. So one room one new room created or one new uh name
20:33
space has been created. Okay. So that's all that's also one
20:39
thing uh we have done here. Okay. So at least let's let's create one single
20:44
document for this. Okay.
20:49
Now uh one more thing to test this user is working fine or not. Uh uh I'll
20:54
transfer this user to my Windows. Okay. Um so you know how to transfer. Let me
21:00
use V SCP. You guys might have other method also to transfer.
21:14
So IP is 192 168 59.104 I believe
21:19
username is docker password is TC user login
21:26
update I login with a docker account docker is a user and user login always to the home
21:32
directory. Okay, for example, if I log to this account here in
21:41
party, let me exit. So when you log in, who am I? I am uh docker user and where
21:48
you landed to this. So because you you have done SAP, you
21:53
can only download the data from your directory from your home home directory. But certificate we created something else somewhere else. So again you have
22:00
to login with root account because root is a user who have power to go to this directory where lib mini cube
22:09
source and from here I'm copying all the data that we start to the home directive
22:15
docker okay I I copy all the data plus
22:22
this file normally other has no read power so we won't able to download so
22:27
I'm changing the power of other to read so that anybody want to use this private
22:35
key to download that I want to use to download Windows I can download
22:40
so nothing very simple Linux command for those who don't know I just quickly explain you what this is doing for you
22:47
now here if I refresh these file come up because I transfer already in this directory and let me transfer to my
22:53
windows and windows guys I'm transferring in this folder you guys know why I'm transferring this folder
22:59
Okay. Uh because uh in my windows we have mini cube and mini cube is putting everything over here. We can change also
23:06
but let me put everything in the same location. So transfer that's all. So
23:12
entire data come to windows. Okay. Now
23:18
if you want to login u you can login with this account. how I told you in my
23:23
last class but very quickly let me revise this command so we can focus more on main concept.
23:29
So u right now if you see cubectl command
23:37
cub command and if you see
23:42
config get context.
23:49
Okay. So multiple context we have. Okay. So what I'm going to do over here
23:56
I told you in the last let me very quickly write this. So cube ctl I want
24:02
to uh you know set a new
24:07
uh I can say users. So it's called credentials
24:13
new credentials. And let's say this is for user called Eric.
24:18
Okay. And we have the client key. Client key U that is Eric dot key. Okay.
24:29
And we have a client uh it's called certificate. I believe
24:34
this is called Eric dot CRT. Okay.
24:41
This is what guys we have set also in the uh blast class. Okay. Uh but only
24:47
thing is the this is not the path. So we have the path over here many cube
24:54
profile this path. So if they give me options to copy this path from here or
25:01
let me go to my command prompt
25:07
because you give the path here right where this key located. So the path is dot mini cube
25:16
inside the mini cube profile and mini cube. So this is the
25:22
path right obviously you have to tell in a system okay this file is located where
25:29
you have to give the path like this this file is located here and because this
25:35
path by we have some space come up and windows confused with this space like space so I just putting in double quotes
25:41
so there will be no confusion okay and one more path we have here from here till here let me
25:49
copy again and then paste and close.
25:56
So one user we have created not created I can say
26:02
I can say we set at client side
26:11
okay that where the certificate located okay that's all okay and guys cluster
26:17
information we already have only one thing I'm going to do I'm just creating a context so config
26:25
set on text and say I I would like to uh
26:33
use this user named Eric that I created here in my local system.
26:39
Okay. And this Eric is going to use a cluster that's called mini cube cluster. That information I already have but you
26:44
guys know how to set it. Okay. And this context let's say name called my
26:51
Eric context.
26:58
is just a name right. So this context set it means any anytime if any want to
27:05
login they got to use the cluster called mini cube and miniQA is is the one who running locally. So that's what we have
27:12
set. And finally for testing there's multiple context available.
27:20
Okay. So I'm going to set a new context as a default context. This going the command called use context. I told you
27:26
in my last class also use context and the context is called my
27:33
context. That's all. So this one time setup you have to do
27:40
for it means now onwards in my base windows system
27:45
windows system whenever I try to run any cube command as a client command they
27:50
will use this context because I set as default and this context means I'm going to use this user
27:56
this user means I'm going to use this uh certificate and this private key
28:02
and this will will use to login to this cluster this cluster we already said in our last classes even though it is I was
28:08
set by mini cube and this will connect to your main cluster that is running in
28:13
your virtual box. Okay. Now what you will see here? So
28:18
when you see this message it means everything is good. And what this message say you as a Eric
28:24
user and now again go back to the diagram. You as a Eric user
28:30
you're trying to access one of the name space and that is by default name space
28:36
called default. Like I told you in my last classes, default is a by default name space. And this message say you're
28:43
trying to use one of the name space called default but you have no power to go in this
28:49
room. You have no power. See here you're trying to do anything in the port. So
28:56
means you are to trying to do anything um in the port resources. And what
29:01
you're trying to do get means like a list. You want to list the port. But in this room you are forbidden. You
29:09
have no power. Even though I don't want to give this user to power in this room. Our plan is
29:15
to give this user give the power in the room called testing. Okay. That means you use option called
29:22
testing. So this is what the command I want to run here. So right now I'm logging with the ar user and I want
29:30
addict should have power to go inside this room. It's called name space and
29:35
inside this room they can do get on the port get means list on the port but if
29:42
you see here again they have not allowed so interesting thing is I have login
29:49
successfully with the Eric user there's no challenge okay but after login if ar
29:55
try to do something in this room okay it is not allowed
30:02
why because we haven't given Eric any role binding. Okay, that's what I would like to show
30:09
you here and that's what the plan for today's topic. So what I have done guys here I built a base context for you. I
30:18
built a base lab for you. So today's lab is you can think in this way this
30:24
problem we have to solve. I want this user that I log in
30:29
have a power and should have a power to go in this room
30:34
and do something on the port what get list.
30:40
Okay, only then but yeah if user want to create something for example they want to run a new port from some image you
30:46
know this is the one I show you in classes so they want to create a new port
30:53
sorry in this room okay so
30:59
say sorry so command is image
31:04
even though this also they don't have power so guys if you notice here very very clearly
31:11
command know what I'm I would like to do here. So this command say
31:17
you are a subject you want to do something on the object.
31:25
Okay. And what can you do? It's all decided by your action and the verb. Here the verb is create.
31:35
Object is your resource. It's called put. And who are you? You are user.
31:43
Okay. But this particular equation is not working
31:50
is forbidden. Why? Because you as a user,
31:57
you as a user has no policy defined. Okay? You are not being attached to that
32:05
particular role that has defined this policy. This called you're not binding to that role.
32:14
So in this case either that role already available we can bind that user
32:20
because user already created or maybe this may be a custom requirement. Okay. And technically this is a custom
32:26
requirement. What I want to do I want the user Eric.
32:32
Okay. Can do something on the board and what they can do only they can create or list or get
32:39
or maybe get only in the room or name space called testing. So this are some kind of custom
32:45
requirement. So here here we have to we would like to
32:51
create everything from the scratch by ourself. So that age region we have already planned. Uh what do we want to do here?
32:59
We want to create our own custom roles and they will bind to the user. Custom
33:04
role means this is what I want to do. Okay. P we can create we can list that
33:12
is called custom role I want to do here. So till here guys everything we have discussed in the last class I already
33:19
explained you. Okay. Now the plan is how we can create the role. Role is a
33:27
different thing and role binding is a different different thing. So in the company what manager can do
33:34
what power they have that is called role. So manager is a
33:40
role but who to whom we give this role. We give
33:46
this role measure to himl or Eric. Okay, giving this role to somebody is
33:52
called binding. So we are going to do both. We are going to create our own roles or we are going
33:59
to do binding this role to some user. Okay. So let me show you guys how we can
34:05
do. So for creating the role and role binding we can use a command or you can create a yl file. So let's go and create
34:11
the yiml file quickly. Okay. So again I'm going to the same folder where we are creating the yiml file. till date
34:19
folder name is container I'm going to create a new yml file
34:27
let's say my role do yml
34:33
okay and uh let's go and create the yl file but for the yl file you have to
34:39
collect the information right what information I would like to do here okay
34:44
uh so I would like to create a role this is my first requirement.
34:49
This is the one requirement we have.
34:55
Okay. And next thing uh in this role what I want to do so we have some
35:01
resources maybe resources maybe port
35:07
or maybe deployment. These resources we have and in this
35:12
resources what do you want to do? What action you want to perform or what you want to implement. So let's say I want
35:18
to do list list on it that's what the thing I want
35:23
or maybe you want to create create also you want to delete also okay let me go for small thing right so this rule have
35:30
only a power to do something code and deployment and what you can do only list that's what I want to do here okay so
35:40
how can how we can get that's all very simple so here kind is our role what is
35:45
kind you guys We discussed multiple time every kind we give some unique name is called metadata.
35:53
Okay. And in the metadata we give a role a name. So what we have planned
35:59
uh we have planned the role we give some name. It's called my
36:06
monitoring role. That was our plan would be. So my monitor
36:15
right underscore ro let me give directly hyphen role if there hyphen
36:21
okay this is what the uh what I say the name of the role would
36:29
be right and plus this role you want to apply to which name space so I want this
36:37
role to be applied to a name space called uh testing. You know this is the
36:43
room or name space uh we have created this is what we have defined here.
36:51
Okay. And next thing is in this role uh in this role what you have. So in this
36:58
role we have a resources or you might have multiple resources. This is the reason why we use s here. So one of the
37:05
resource we have is called port. Okay. or one of the resource we have a deployment
37:12
and because we have multiple name so we can put this thing in a list also this also one of the way
37:20
to use and port deployment is one kind of string here so we can put in the
37:25
double quotes but let's go for smaller plug again let's set the create the role only for port
37:32
or port or port whatever the keyword they have okay and here what verb I want to select
37:39
So I want to select a verb. Okay. Or we might have multiple verbs
37:44
like list delete. So the keyword is verbs. Let's let's go for one. Okay. This one. So this symbol guys is
37:51
like a list because we can add more also like delete and all the things. Okay.
37:57
But I'll again go for one simple list. So that's all guys. Your um uh rule has
38:04
been created. Okay. has been greater.
38:10
Now um let's go and run it. There might be some error might come up. Let me
38:15
check but let me go and run it first. So cubectl
38:21
create or apply this file maybe same thing I'm going to apply this file my
38:28
road they fail um uh they fail they accept this accept
38:38
key word the why they fail there might be some uh syntax error now what syntax
38:48
syntax error maybe something like this I give some error here or maybe some keyword might be wrong but we know the
38:55
concept right we don't have to memorize the syntax and we don't have to memorize the keyword we should know the syntax
39:00
that's the main thing okay or maybe I forgot to write some API in the top so
39:06
we don't have to memorize anything we know the concept so what we do we always follow one thing so we go and search in
39:12
Kubernetes okay rollbacks
39:17
And you will get some uh you know link of the cubernetes document. We'll go
39:22
there and we check what's syntax they follow.
39:28
Okay. So uh they might give the here one thing is uh these are the rules. I
39:35
forget to write this things. I don't have to memorize this thing. That's okay if I forget. Right? We have a document
39:40
for this. So we just forget one thing rules.
39:46
Okay. So let me now try to run this again. They might
39:52
fail. Doesn't matter. We'll again rectify the issue. Again they fail. Uh
39:58
because this message you guys know we have seen initial classes. Every von file you to start with API version. We
40:04
haven't write the API version here in the top. And what to write? They give the answer here. This is the API version
40:11
we have to write. Okay. So that was the only error one of
40:17
the error I can say. Okay, save.
40:23
Apply. Again, different kind of error come up. But this time the error is little bit different. They say there's a
40:31
forbidden. Why? Because guys, right now I'm logging with Eric user
40:38
and Eric has no power to create a new role. Even though Eric have no power to see the port also, right? So how Eric
40:44
can can create a new role? Okay. Okay. So if you want to create a role you have to login with the admin
40:51
user. Okay. How to login with admin user? You know because I has changed the context.
40:58
Okay. So this context we get for every user. So let me again re change the context.
41:04
Changing context means we can think in this way also. Changing the context means you are changing
41:10
username also. And here guys we have a contest called mini cube. You know I told you in my last class. So many user
41:16
has one context already created and when you switch your context so it
41:22
will automatically login behind the scene with your admin user of the Kubernetes in the local cluster.
41:28
Okay. And that user have a power to to uh create a new role. Technically you
41:35
think I just switch to new user. You can think in this way and I try to run this.
41:40
Um now this is a different error altogether.
41:46
There's a different error all together. Uh but but this error is gone.
41:52
So there's no for error. It means whatever user I log in with right now
41:58
that user has a power to create anything. Technically this is admin user. Okay. So whenever you want to do
42:06
anything admin level power like a root power you can login with this way in the
42:11
mini cube. Okay. But now this is a different error. Why? Why this error
42:17
come up? Because guys when you create a rule you have to give a API group. What API group? I haven't explain you yet.
42:25
Okay. But in document also they show you you to use some API group here. So what
42:30
API group in my upcoming class there's one topic called API. They explain what is API versions, API groups. So there
42:36
you guys come to know what is API. But right now I'm allowing all the APIs.
42:41
Okay. And what I mean by this, we have a discussion on this. We'll discuss there. But right now, I'm just writing over
42:47
here API group. That's all. So till the time
42:53
guys, you doesn't know anything about API group, you can write this line. But in the future class, I will talk about API group, API version. This statement
43:00
you will will see in the very detail. Okay. So that is only the error that API
43:06
group is required. So I think now is is good to go and when
43:13
we create this there's no error and new R custom rule has been created according
43:19
to our diagram this rule has been created.
43:26
Okay, you can think in the company you have created new profile in the company like say manager profile it's not there
43:32
in the company yet but now you have discovered and created a new profile in
43:38
the company you can think in this way here it is called role this role has been created
43:44
okay yeah want to confirm also you can use cubectl get role
43:51
okay and there's a lot of roles we have or get
43:57
Uh what I say cluster role you know what is command
44:04
uh cluster role or what cluster roles
44:10
or binding what
44:18
yeah this one so so these are rules we have
44:23
so if you see here I've done a top somewhere you'll find one of the role it
44:28
will become somewhere but you can find here this role will come up but yeah this role has been created that's what I'm talking about okay so this role has
44:37
been created where the file is
44:43
format so this role has been created
44:49
okay now after role created so this job is done
44:54
Where's my diagram? This role has been created. How to get this rule?
45:01
This is the entire code. Copy paste.
45:06
Okay. And for this before this just don't forget to switch yourself to the
45:12
admin account.
45:19
Okay. Run this and your role has been created with this name. Now next point is we we already have the user
45:27
Eric. Okay. Main thing guys here this name will be anything. This file name will be
45:34
anything. The most important thing is your common name. Your system recognize you with a certificate common name. So
45:41
this name work as your username. Otherwise this file name will be anything. This context name will be
45:47
anything. It's just for the reference but the main username is this name. Okay. But here we already get a username
45:55
called Eric. We have get the role. This is called my moning role. Okay. Now this
46:03
time is how to bind this user to the role. So it is something like this that
46:09
I'll explain to you. So we have Eric in the company. How give
46:14
Eric a manager role this role binding. Okay. Okay. So for this what to do? We
46:20
have to again write a code. So I'm going to create one more new file. Let's say
46:26
my role binding
46:32
dot yl.
46:39
Okay. So guys uh what to do because we know the logics. So obviously if you
46:45
want to bind the uh you know role you have to give a username in our case it's
46:51
called Eric you have to give a role name which role you want to bind. So you want to bind a role that is called my
47:00
monitoring role that's so has an as role you can think in this.
47:07
So there's two things we have to give here and what it will
47:12
perform what it will do for you they will do ro
47:18
binding that's all. So let me write quick write the code. So this my kind is role
47:24
binding where R is capital B is capital otherwise just go inside the document.
47:30
Every role binding we have to give a name this called metadata. Okay, this is a common syntax every time we use. So
47:39
let's say my role binding would be um my user role. This is a name you can give
47:46
anything but obviously give a better name that makes sense in the future because hundreds of name you can create.
47:52
Okay, maybe give the name called Eric user
47:57
uh monitoring monitoring
48:04
binding. So just something some kind of this name you can give. Okay.
48:09
So this what we have done and now uh user would be guys the way I explain you
48:15
is English grammar. So user is like a subject. So here sub keyword is also subject actually. So a subject is is a
48:24
user. Okay. So subject is a user. So user also is one kind of kind here because there's
48:30
other way also we can give the power. Okay. What we might see in the future classes. But here we are giving this
48:37
power to a user. We can give the power to group also. We can give the power to
48:42
some internal account also for service account. So other kinds also we might see in the future. But here we are
48:48
giving this power to a user and name of the user is Eric.
48:56
Okay. So we're giving this power to user. EDIC is not a group here. Eric is
49:02
not the some kind of service account. What a service account we'll see in the future. Okay. But here who is Eric? Eric
49:09
is just a user who can log into system and do something. Okay. And what role we are giving here?
49:15
So guys this role is called as role reference keyword. Okay. So what role we are giving or
49:21
which role we are going to assign. So because we are going to assign this to a role that's called client which kind
49:28
role kind. Okay. And the name of the role is
49:34
this one. This is what we have created. So guys this is what guys your
49:40
your final road binding look like. Or maybe you can go to uh you don't have to
49:46
memorize again this keyword. Okay, just go to document. You should know the logics and go to document and this is
49:52
the role binding. So this is the name of the role binding. You can go give a name
49:57
space also which name is you want to use. So let me give a name space.
50:04
So I want to use this in a name space called testing mean our room name.
50:10
Okay. subject in the kind user name of the user
50:15
role reference which role or role name that's what we have given
50:21
okay so that that's what the role binding has been has been done okay and
50:28
quickly run it so this role binding run means role run means you are giving now power
50:35
to the user Eric now after I run this file my Eric user have a power.
50:43
Okay. What power individual will have this power and what is this power mon
50:49
power is what is Eric can list the port in this name space
50:57
that's what we have given. Okay. Now when I run this then the error
51:04
again API version error and we can see the document we can give this API version over here.
51:16
API one
51:23
again there's one more error come up API group also what API group we'll see in upcoming classes but right now they also
51:30
give in the document you have to give API version group here also and here also so I'm giving the API group.
51:41
So typically whenever you use the kind you'll give API group or API version you can think in this way but what is this
51:47
API group version we'll see okay so this line is not important
51:53
understand this concept I explain you that the main topic for today that is important
52:00
okay so uh now when I run this there's no
52:06
error come up now technically my role binding has been created
52:11
So what does role binding say? This role binding say so this role binding is
52:17
talking about it's talking about that in this name
52:23
space even though if you run this command cubectl get role they say
52:29
there's no role I'm checking in the default name space but I set the role in a name space called testing
52:36
okay let me use the role binding keyword here
52:42
so in the testing name space we have one role binding created with this name can
52:47
see this name. Okay, this is the one role binding we
52:53
have created in this name space. And what this role binding says,
52:59
let me describe this describe this role binding. They say
53:07
when any user login that time they will work in this cluster
53:12
as a role called this one. So this one has been created a role
53:18
called this one. What role say? Let me show this command
53:24
to you format.
53:31
Okay. So what this rule say? So you can run the roles command.
53:39
This role created inside your name space. Why? Because when we create a role we define this role should part of
53:44
inside this name space. So they get inside your name space. The rule say
53:51
this rule say means this rule say that anybody who have this rule they can
53:59
do something on the food what only list that's all.
54:05
So finally if you try to conclude Eric have a power to do code list that's all
54:13
in this name space which name space testing name space.
54:20
So guys that what the role based access control we have given to the array.
54:28
how we can check uh very simple the way we have seen multiple time okay so what I'm going to
54:36
do here uh I will again login because right now I can do anything get port get
54:45
name space I login with the admin account okay
54:51
so let me again uh what I say switch the
54:56
context Next. How? Where's my file?
55:04
Let me use the context to Eric, it means I'm logging to Eric
55:11
account. Okay. Now, if I try to do name space, I
55:17
can't do. If I try to do get ports, I can't do
55:23
right. I'm doing the default name space which means whatever guys we have done
55:28
till date working but if I do get put inside the name code testing now it is
55:35
working fine okay why because we have given arku
55:41
power that in this space you can get the port that's called list
55:48
you can list the port okay but yeah here if this user is trying to create the
55:54
port create port create port as you know the command is run
56:02
my code from the image called as httpd is fail because this power we haven't
56:09
given okay or we try to get deployment
56:16
we this power we haven't given so guys whatever power uh we have given
56:22
to this user is working uh very powerfully but you want to give some other power
56:28
now this code we can change and uh update okay so we can say I want this
56:34
user power to deployment also that's all I want this user have power of create
56:41
also that's all it means this user
56:49
can create the port or deploy the port do but it can't delete Okay, they can deploy
56:58
uh deployment create and list but they can't delete or they can't edit also.
57:03
Okay, so this is what we have given. So we change the role. Okay or you can
57:09
create new role and attach this user to a new role. Okay, so let me reapply this
57:14
file. So cubectl apply
57:19
all my role. U obviously guys u if you
57:25
want to change any role I have no power to change in the role you first log to
57:31
uh admin account in my case is mini cube
57:37
they have a power to change any role any power. So it's been changed and uh if I
57:45
check cubectl get or maybe I can say describe
57:52
describe rule in the name space called
57:58
testing so it will come right to confirm this let me again log to the uh Eric
58:06
account let me switch last time Eric is trying
58:11
to get deployments. Okay. So that command got fail
58:20
where this is but this time again this time fail
58:26
because I used deploy but keyword is deployment
58:32
right so this one one mistake I did but that's nice to know this one and this is
58:38
a different keyword. So this is one mistake I did but let me
58:43
check other things deployment. Okay. And uh we can change also or
58:50
there's one guys for a groups also. I think groups we apply everything. One
58:55
minute guys. One minute. Let me check the groups. Which group? I think this group also have issue. What about this issue? We
59:01
we'll talk about yeah one of the issue maybe deployment. But yeah, if you try to last time this this failed but this
59:09
working fine. So port last time I it failed guys but this time uh is is working fine. So we
59:19
can see our port is running. Sorry get port is running. So we can get the
59:27
port. We can create the port. Then if you remember one command called watch.
59:33
Watch is not working. Okay. So you know guys if you see the
59:38
board live working or not the watch. So watch is also one of the verb.
59:43
So create is a verb. Get the verb. Delete the for example if you try to you yourself create the port. But if you try
59:50
to delete the port is the port is called my you have no power. So you can create
59:57
the port but you can't delete the port. You can't wash the port. So create,
1:00:04
delete, get, watch, edit all are different verbs. So if you if you see
1:00:12
very quickly inside Kubernetes
1:00:19
verb list or just a verb. So these are
1:00:24
different verbs we have. Okay. So what it
1:00:34
verbs we have. So what power you want to give to the users
1:00:42
okay on respective resources uh you can decide what powers you would
1:00:49
like to give okay so somewhere you'll find the complete
1:00:55
list of the these are the one of the list I
1:01:01
can say okay that they support. So this is one uh very quick example of
1:01:10
um uh what I say the how to create the role custom roles
1:01:18
how to guys can you hold for a second please? So uh this is a quick example um
1:01:23
but as you know more about Kubernetes multiple resource you guys come to know
1:01:29
in the future like stateful set or deployment or or maybe demon set or
1:01:35
maybe jobs. So as and when new resource come up depend upon on this resource
1:01:41
what can you do or what can't you do it's all depend upon the API okay so API
1:01:48
group or API is a concept they will tell you in this particular resource
1:01:55
what API they support okay and whatever API they support you can control for
1:02:01
example delete is one of the API so port this API
1:02:07
It means this verb we can implement on the port. Port support get API. So we
1:02:13
can do get on the port. Okay. What I mean by this those who doesn't doesn't know API they might not able to
1:02:19
understand. So we have one dedicated class on API API versions and other things also. After having that class uh
1:02:26
you have more detailed understanding of this concept and then you can create
1:02:32
more powerful you know uh this kind of code a lot of
1:02:39
custom codes you can create but yeah as a role perspective or as a role binding
1:02:45
perspective that was the topic we have some more topic something related to this like a service account and
1:02:52
something like this. So in the next topic they will guys become more comfortable again in this particular area. But that's all uh for today. This
1:03:00
is the step-by-step document I created. Okay, I'll share this doc to you. Practices create your own custom
1:03:06
environment and secure your environment accordingly. But this is how we work guys. We never give the entire cluster
1:03:13
access to anyone. We create a name space and inside the
1:03:18
name space we limit the user what they can do. Okay. Or we can limit we might
1:03:24
have multiple different team and every team we limited uh with the respective
1:03:30
scope or the power. Okay. So that's all guys the topic would be next class we go
1:03:35
more deep in this respective topic by understanding service account or API
1:03:44
groups and other other things also Right.

