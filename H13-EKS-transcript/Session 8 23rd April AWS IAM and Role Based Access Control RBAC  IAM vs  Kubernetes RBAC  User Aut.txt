ript


11:42
Hey guys, uh very good morning and uh let's continue with the next part. Guys,
11:48
today's class is very very uh interesting and very important also in the world of EKS because
11:56
uh we are going to integrate EKS with IM.
12:01
So what I mean by this uh let me explain to you right. So let me very quickly
12:08
create the diagram right. So we are going to integrate
12:14
our EKS cluster I can say Kubernetes cluster that is running on the top of EKS
12:20
and we are going to integrate with the uh with the um IM services right so what
12:31
is the use case why we want and what we want right so you guys know we have a cubernetes cluster
12:39
one thing I want to tell you again. Okay, we are not into the Kubernetes training anything and everything you if
12:46
you want to know about Kubernetes. Okay, we have a dedicated Kubernetes training like CKA, CK, right? Where you learn
12:54
about the Kubernetes thing. Okay, this training is about EKS means if you
13:01
have a cubernetes cluster or I can say if you want a cubernetes cluster to be deployed with the uh managed services
13:11
or I can say the the serverless services right then AWS provide a service called
13:19
EKS. So with this service
13:24
with this service um right we can able to manage kubernetes or I can say AWS will manage
13:31
the cubernetes for us that you know okay so when I when I talk about EKS training
13:38
it means right what all facility AWS is a cloud provides to us in the
13:45
terms of management of the cubernetes okay for example
13:51
uh in the Kubernetes we need load balancer you know that's service
13:58
as give a ELB load balancer for us in Kubernetes we need storage
14:05
okay so they give a EFS or EBS services
14:10
given by AWS right so intention is how we can integrate load balancer
14:18
okay in the Kubernetes is or how we can integrate the AWS storage to services
14:23
with the Kubernetes. Okay. So that Kubernetes is same but you
14:29
have normal vanilla Kubernetes right but the main thing is uh how you can utilize
14:37
the entire resources or other services given by AWS.
14:42
Okay. Something like this we are going to see today. Okay. What we are going to
14:47
do do today is we want to implement
14:53
authentication part or we want to implement Arabic part where AWS has a
14:59
very fantastic services called IM with IM we can able to leverage this part.
15:06
So what I mean by this that's what we will I have explained guys step by step uh today.
15:12
Okay. So before I go ahead and start this topic, let me give a very quick
15:17
name for this topic is we are going to integrate AWS AM
15:25
uh services to EKS for what for authentication purpose and
15:33
for ARB purpose. And I will explain you guys this concept of authentic in detail in a minute. But this is what the main
15:40
plan for today's class. Okay. But before I go ahead. Okay. Let
15:48
me do one thing. I don't have a cluster uh running over here. Okay. I would like
15:54
to launch a cluster one more time. Okay. And I would like to go to again the step step by step and why there's a reason
16:01
for this. Right. So we have a EKS cluster. So EK services
16:13
EK services and I would like to launch a cluster.
16:19
Okay. But not from the graphical from the command line and for the command line I need access key secret key. So
16:26
what do we do? We'll go to IM service. Okay. In the IM service we will create a
16:33
user and through this user we can get the access key right
16:40
sorry so again I'm going to create a user here okay and uh let me create a user uh with
16:48
the name called uh viml that's all nothing okay so this user I'm going to
16:54
create okay second thing is this user I'm going to give some power understand one thing
17:02
guys this user what I'm going to create is AM user
17:08
it means we have a AWS cloud is independent product or independent
17:17
uh platform okay platform
17:22
in this platform we have multiple services for example EC2 for example EKS test.
17:31
Okay. So what you want? You want to create a user. In my case, I'm going to
17:37
create a user called Vimmel. Okay. From this user,
17:43
okay, what you want? This user can able to access EC2, can able to access EKS.
17:49
What power you want to give to this? Okay, let me give a different name even
17:55
uh I'm going to give Vimmel AWS.
18:02
Okay. So this user what power you want to give. Okay. And guys there's no
18:09
you know word here like kubernetes right. It is only for the AWS services.
18:15
So that's we say this im user created inside the IM service of AWS.
18:25
Okay. So let me attach some power. So I want when this user login
18:34
this user will have a EC2 power. Okay. So I will attach the EC2 power
18:39
here. So those who know about AWS this is very basic thing nothing very tedious
18:45
or I want to give this user a powerful EKS services.
18:51
Okay. So if you have any thing EKS. Okay. So this is EKS power going to come
18:56
up. Okay. But guys again in the EKS.
19:01
Okay, if you see here there's lots of different permissions, power of policies
19:07
here. What power do you want to give? Okay, do you want to give this user a
19:13
worker node power? Okay, means this user can able to do
19:18
something on the worker node or do you want to give some power for service policy? Do something on the service
19:24
policy. For example, if I click here, okay, service policy means uh that from
19:32
this user after we create a EKS uh
19:37
cluster. Okay. Or maybe we have EKS cluster already created.
19:42
Okay. And this cluster give you Kubernetes
19:48
and Kubernetes you need services. And you guys know in the if you use EKS
19:54
services mostly we use ELB as a load balancer from AWS.
19:59
Okay. So if you want any setting for the ELB or for the services same thing here.
20:06
Okay. Do you want this user can do for you? Okay. So they can say they can create a
20:12
network they can create some subnet VPC and many more thing uh they will do for
20:17
you. Okay. then route DNS or maybe so it is more about the uh service related
20:26
policies or service related power so what I'm talking guys over here even
20:31
though let me tell you one more small thing if you know a little bit about
20:36
um IM service in AWS you can also create your custom policies
20:42
okay when I click on the create policy option okay what we can do Here we can also
20:50
create our custom policies and guys you know where I'm going in a minute you come to know where I'm going just give
20:55
me one minute okay because my moto is to tell you how we can integrate IM to EKS
21:04
or Kubernetes okay so before this I want to show you some very basic thing here okay then I'll relate in a minute so some point
21:11
here is I am going to create one user in my case it is AM user name vimmel
21:19
AWS. Okay. And this user I'm going to create
21:24
a give a power or permission on some service. Let me choose one service here.
21:31
Let's service name is called EKS. This service name.
21:37
Okay. So, Viml user is going to have some power in EKS.
21:45
Okay. what power do you want to do in the EKS? So if you click on the expand all
21:52
these are the available powers from the AWS stand point of view.
21:58
Okay, means after we will log in, we will list add-ons,
22:05
we will list how many clusters we have, you know, ekctl get cluster command
22:13
or this user can uh can delete some add-ons, can delete the cluster, can
22:20
delete the node group, can create a new cluster, okay? or maybe create a new add-ons or
22:27
create a new node group. Okay. So my point here is what I'm trying to tell you finally.
22:34
Okay. What I'm trying to tell you is AWS prospective.
22:41
If you create a user called IM user
22:46
in this case this is the name for example women AWS. Okay. This user you
22:52
can give some power or permissions
22:57
okay permissions on some AWS services or AWS resources resources
23:06
and what permissions power you can do so they can access some control that's called arbback rolebased access control
23:14
so I am give you a way to set up the role access control but this roll back
23:20
access control or role based access control would be only to the AWS
23:26
services or AWS service management
23:32
maybe uh women a user can launch EC2 instance can launch EKS cluster install
23:39
add-ons delete node group whatever the AWS perspective
23:46
okay in EKS that user can manage my point here is okay what I'm trying to
23:52
tell you okay if you just think about I am
23:58
okay they can give you role based access control
24:04
but they're limited maybe the better word limited to the AWS services only
24:14
okay using the ambback you can't go inside the Kubernetes
24:22
and you can't control any access on the Kubernetes resources
24:28
whatever seen outside the Kubernetes what seen outside of Kubernetes you can
24:34
create a cluster okay delete the cluster those things you
24:39
can manage from AWS okay IM policies or role basis control
24:47
okay but if your requirement ment is after your Kubernetes launch.
24:54
You guys know a little about Kubernetes. In the Kubernetes we have ports, we have services, we have deployment, we
25:02
have we have uh replica set many more thing.
25:08
Okay, these are known as Kubernetes resources. This is visible only inside
25:14
the Kubernetes. Okay. And what you want? You want to
25:21
create a user? You want to create a user and I want to
25:28
give this user a certain power. This user won't able to create the deployment but
25:36
can able to see the deployment. Go view power. This user can able to delete the port or
25:45
won't able to create the port. this power or this user
25:51
bless me say service want ablebody to expose the services
25:58
okay so what I want in in the kubernetes we have a huge resources running lots of
26:03
apps running by different teams right not obviously single user going to manage this right there's lot of
26:09
hundreds of user would be there but I want to give every user a dedicated power dedicated role
26:16
And according to the rule okay they can do certain activities
26:22
okay till date okay the way we work on the cub is we work on a user that is
26:28
more like a admin user or the cluster admin user means okay cluster admin user
26:34
means is a power means this user the way we did uh till date this user
26:43
okay can able to delete the deployment and expose services do something on board replica side and whatever the
26:49
possible thing available they can do anything and everything okay but there's not the better way always to give
26:55
everyone a root power or cluster admin power or admin power
27:01
so what we are going to do here today okay we are going to create a multiple user user one user two user three user
27:08
four every user we are going to give a dedicated power limited power whatever
27:13
we want them to Okay, normally this topic we learn in
27:19
the Kubernetes training this arc topic and again I'm not going to discuss this topic in again very much in detail nor
27:27
in advance. Okay, my intention is not again to teach you about the ARB topic
27:33
for Kubernetes. Okay, my intention is
27:39
okay. how you connect the Kubernetes
27:44
ARB to the IMRP there's two different things right what I mean by this I will
27:50
again explain you as a quick brief then we'll move to the next part okay
27:57
but what is rollback access control those who buy no idea that's simple thing we have lots of user
28:05
we have a lot of user and uh uh uh you want to give particular
28:12
user let's say username is Jack. So Jack after log to the Kubernetes
28:18
not AWS I'm only talking about the Kubernetes the Kubernetes will be there in Azure cloud AWS cloud your own
28:25
personal Kubernetes does not matter after user log to the Kubernetes
28:30
okay what resources they can access at what level they can access this called access control come the topic called
28:37
arpec okay the point here is there's two things there two arbback here one is
28:44
kubernetes RBback one is AWS Arpback. Let me differentiate
28:50
very quickly. Okay, then we move to the next part. Okay, so point is only challenge here is
28:59
not isn't a challenge a good thing actually. But the point is we have a kubernetes cluster
29:05
running on the top of AWS managed by EKS service of the AWS and
29:12
they launch Kubernetes. This is the current scenario we have.
29:18
Okay. Second point here is AWS also have their own personal
29:26
arbback from the IM service.
29:31
Cubernetes also have their own personal arbback that is the cubernet internal let me use the word native cubernet
29:38
native facility okay both has their own IM
29:45
okay differences in would be okay would be if you just talk about IM service or
29:52
AWS arbback arbec is just a concept okay arbc
30:00
Okay. So if you talk about this uh particular uh thing with the AWS IMR we
30:07
can only control
30:12
control or limit the access okay to particular AWS services. It is
30:20
only for AWS services. Okay. Example can be S3. Example can be
30:28
EC2. Example can be EKS also.
30:33
Okay. So EKS doesn't means Kubernetes inside. EKS means outside the cubernetes means means about the node group. How
30:42
much instance type you give about the about the SSS login about the um you
30:49
know the the cluster creed.
30:55
Okay. So with IM of AWS you can only control these AWS
31:04
service facility and per service there feature facility or per service the
31:09
respective API whatever you say. Okay, for example, EC2 v API called delete
31:16
instance, reboot instance, stop instance. These are different APIs or different different feature. Those we
31:23
can control from IM. But the thing we can't control from IM,
31:30
we can't control from IM in the terms of access control also known as rolebased
31:36
access control. Almost same thing here. we can't do is we can't go inside
31:43
Kubernetes after Kubernetes launch we can't go inside
31:49
okay and we can't say that we have a AWS user
31:55
known as for example Vimma AWS user okay this user is KM
32:04
okay IM and uh but this user inside the cubernetes is okay will limit it also
32:13
some access control that this user won't able to delete deployment won't do
32:18
something on services okay this is this is what we can't do
32:24
right now but we how we do that's what the plan for today h
32:30
okay till date if you know kubernetes it has been governed by kubernetes only so what
32:37
normally we do in the cubernetes kubernetes also has their own users inside the cube we can create the users
32:44
let's say I'm going to create a user called viml cubernetes user
32:50
okay this user we can create in the cubernetes also give a way to create the
32:55
user set the password after this user belongs to kubernetes
33:02
okay or the part of kubernetes because created inside the kubernetes this user we can say that this user we going to
33:08
give A rbeck but now this arbback is with respect to cubance only means this
33:13
user can do something on service this user can do something on the port this
33:19
user can't delete the deployment okay so the cubernet perspective they
33:26
have their own personal arbback through which we can manage the kubernetes resource resource track and give some
33:32
power to kubernetes user so what I'm trying to tell you guys here is there are two different thing Here
33:38
Kubernetes also have their own users and their own way of managing rolebased
33:45
access control. AWS is independent platform. They have their own way of
33:50
getting user in IM and own way to managing their ARB service security for
33:56
their services. Those are two independent platform. The interesting thing is now we already
34:04
integrated this two platform. Okay. How? By launching Kubernetes
34:12
on the top of AWS with this part.
34:17
Now what I want in this case because now Kubernetes has
34:22
been now working on the top of AWS. I don't need two different solution for managing my user management and arbback
34:30
management. Okay, it is I don't want this right that
34:36
for for for launching the uh EKS
34:42
we create different user okay
34:49
and for managing the security inside the cubernetes we create different user in the Kubernetes
34:56
I don't want two different user management Right. So what I mean by user
35:01
management? Let me very quickly give this term to you. I think you might know but let me tell very quickly. Okay. If
35:07
you have any platform guys, maybe GitHub, maybe AWS, maybe Kubernetes.
35:13
Okay. To to work on this platform, we are the user or the client.
35:20
Okay. We need two things. One, we need the user and we need the
35:26
password. Okay. So whenever you hit to this platform this say I'm secure. I won't
35:33
allow you as anonymous. I don't know who are you. So if you a real user of mine
35:39
just show me your name. Okay this let's say this guy say my usernamel
35:45
but say I how I know you are the real women or not. Right? So show me your password. So if you give your password
35:51
let's say red hat for example make his password. So you give your username you give your
35:57
password. I'll check in my portal right then you will be authenticated
36:03
after authenticate you can welcome to come in my portal and do whatever power you have
36:10
okay so AWS is here is checking your username and confirm username right or
36:16
not that you are the owner of the username or not by password it's called identity they're checking your identity
36:24
and the way they checking is is called user management right so they are managing the user in certain way.
36:30
Maybe they have local databases or they have a active directories or LD whatever the setup they have that's a different
36:36
point but they are checking your login and password mean checking identity if
36:42
you log and password right you're authenticated and after authenticate only you can able to go inside
36:50
that is called user management okay but after you go inside AWS it does not
36:56
means you can do anything and everything right okay inside AWS There will be 200 plus services.
37:03
Okay. Do you allow does women is allowed to access EC2? Does women allow to
37:10
access EKS? Does allow to access S3? Okay. Is managed by a concept called ARB
37:20
which resources depend on the role you can access.
37:28
Okay. So this two ter terminology guys here is
37:33
if you want to go anywhere this two term now now onward I'm going to use if you want to
37:40
access any platform first you have to authenticate yourself
37:48
okay typical way to auate is username and password
37:54
or maybe you can use access key and secret key. Oh, we talk on certificate
38:00
many more way but there are two typical way to authenticate after authenticate what can you do or
38:08
what can't you do okay which service you can access at
38:13
what level you can access is called access control okay now onward guys I'm going to use
38:18
the word called Arabic okay you can also use a what permission you have what power you have what policy
38:25
you have what privileges you have what authority you have authorization right multiple word you can say here but I'm
38:31
going to use word art so there are two things
38:37
that we have to concentrate today okay first authentication
38:43
second arp back both we require you login successfully but if you don't have
38:48
power there's no meaning to login after login you have to give some power but
38:54
you have the power but you can't login there's no again meaning to give the
38:59
Power right so there's two things okay the point
39:04
here is okay if you talk about these two terms now onward okay against come back
39:10
the same point AWS has the service called AM this service is the one who is
39:17
managing the authentication part and the Arabic part
39:22
for the AWS services both are managed by
39:29
similarly if you talk about Kubernetes or vanilla Kubernetes or whatever the
39:34
Kubernet you launch even though you launch a cubet with on the EKS also any kind of Kubernetes
39:41
okay they also have a capability to manage their own personal authentication
39:47
and managing their own personal resourcebased access control
39:53
okay it means we can go inside Kubernetes and create a user for example in the
40:00
cubernetes their own personal database they have or other way also they have okay so cubain is capable enough to
40:07
manage authentication part and after authentication they can manage the user the user have power to do something on
40:13
deployment arbback so both platform is sufficient capable enough to manage their
40:19
authentication and the arbit part okay but I don't want this
40:26
H I don't want this. Okay. Why? Because
40:31
in our case, we have launched the Kubernetes on the top of AWS.
40:40
Okay. And AWS itself have IM power.
40:46
Okay. You can think in this way. The good use case would be the good use case would be okay. your
40:54
company using AWS from last couple of years and you already have multiple user
41:02
identity created 1 2 3 4 5 6 multiple uh identity already been created in your
41:07
company okay one of the example let's say Jack he's already there women is already
41:14
there okay and these user has been assigned to particular team and the members are
41:19
working great now you decided to launch Kubernetes on
41:25
the top of AWS with the help of EKS with the help of EKS cubain launch
41:31
a cub itself a platform to access the cubernetes again we have
41:37
to do the authentication part now there are two approach for the
41:42
authentication right one approach is we can create a user inside the cubernetes
41:52
inside cub Benet is okay which user let's say in a company you
41:59
have 500 users okay in everyone you want to give the
42:05
access to Kubernetes so you have to create all 500 users here
42:12
okay or user here in the cubernetes with the same name or with different password same password maybe and give this
42:20
name for examp your username is Jack and password let's say is 1 2 3.
42:25
Okay. Now challenge here is challenge here is now Jack as one of the
42:31
team member of your company has to manage two login and password.
42:36
One login and password they manage for AWS and one login and password they have to
42:41
manage for Kubernetes. Interesting thing is both are running in the same cloud but they have to man two
42:47
different set of login and password. may password same or different or maybe this is also password you want to give the
42:52
same password but if the password change here let's say it had I change the password change here but it does not
42:58
change here because is managed by cubernet is managed by AWS okay then if you want to give the same
43:04
password both the guys then we have to change both the locations if someone remove or someone left your company as
43:11
we left the company right we might remove the account from here
43:16
but we might forget to remove the account here. So even though women left the company they can able access the
43:22
cubernetes. So my point here is in the simple term okay this is just about the
43:27
cubernetes there can be many more platform like this. So I don't want to
43:33
manage platform wise username and password or platform wise authentication
43:40
also sorry because everybody is running AWS
43:47
cloud only so why not AWS manage their authentication partner on the behalf of
43:53
Kubernetes so what I want to do here okay I'll tell my Kubernetes I know you
44:01
are the one who are managing your authentication. By default, you're using your local database
44:07
to create this username password. Now, what I want you authentication from the local
44:14
database sorry
44:20
don't u you know check the authentication in your cubernetes platform. Whoever client
44:28
come directly to you with cube command okay uh local databases instead what you
44:35
do you authentication part okay you check via IM
44:43
via this service okay it means if anybody come to you
44:50
access your resource service with cube command they are the client who come to cube cube command okay client the user
44:58
come to you and whenever they want to do authentication okay don't maintain your
45:03
local database otherwise there's a multiple duplicate copy and very harder in terms of management if you're thousands thousand of users
45:10
okay so anybody come to you the initial authentication
45:16
you pass to AWS service that's called AM
45:23
okay and in the AM they have they have the user password they will check if
45:28
there password is right will come to you and say is right then you can ask your user to authenticate it so my point guys
45:36
here is I want to maintain a single copy of authentication or single copy of user
45:41
management not per platform here we launch kubernetes maybe in the future we
45:47
launch open safe maybe in the future we launch some other tools or platform the AWS I don't want every platform or the
45:53
all the platform or the applications is used by your team right I don't want
45:59
everyone for every platform wise they will manage
46:07
I'm sorry they will manage their um their uh different different login and
46:13
password okay it is something like this if you know the term called know the
46:18
concept called uh single sign on concept something like single sign on
46:25
Okay, after they sign on AWS with this user with IM user,
46:31
okay, they can able to access cubernetes platform also.
46:37
They can able to access Salesforce also. They can able to access uh you know,
46:44
open sift also or many other platform whatever you deploy on the top of AWS. Okay, but this is not identity
46:51
federation. So those who know the identity federation identiferation it is not the identity federation neither o
46:58
concept no neither oidc concept these are different concept all together these are look like same but there are
47:04
different use case they solve here what I'm talking about is like a single sign
47:09
on uh concept right let me brief you one more time only guys right now I'm
47:15
talking about authentication part I'm not talking about the arbback part okay so this part because there are two
47:21
process we have Have anybody come? First they have to authenticate.
47:28
Sorry. Then we check the power.
47:33
Okay. So right now I'm only talking about the authentication part. Okay. Let me again very quickly brief. Now as a
47:39
process will be something like this. Okay. Something like this. If any user
47:47
is a cubin user going to use cube schedule command. This command only
47:52
understand Kubernetes. This command never understand your Azure cloud or AWS cloud or mini cube.
48:02
This command will go to cubernetes cluster.
48:09
Okay. And this command will say hey I have a username and password giving to you that is your
48:17
responsibility to check my identity. and then do the authentication part.
48:25
Okay. But now onward we'll say no Kubernetes you don't maintain your local
48:31
database for authentication. Right now anyone come to you internally you don't
48:37
have to ask this guy but internally okay you have to send this thing to AWS
48:44
cloud to the AM services. So pass this request let's say
48:51
they coming with a user called vimmel with password let's say 1 2 3 so this
48:57
information you have to pass to IM that somebody know with password 1 2 3 want
49:03
to login okay IM is the one who check your
49:08
authentication part how we will create the user here so now
49:15
onward you don't have to create user in the cubernetes It is we will create the user only in the IM service.
49:24
Okay. So we create the user here. Okay. But but that user will able to
49:33
access Kubernetes. So guys very interesting guys. It means if 10,000 you
49:38
already create an AWS account. Okay. Any user whatever the power you can give further can able to log into Kubernetes
49:45
cluster. You don't have to create multiple again and again. Right? Means if you change the password here the
49:51
password of IM user change for AWS also and same password can be able to access Kubernetes also. So one user one
49:58
password can access multiple multiple uh
50:04
platform. Okay. So IM user service will check the authentication. If they are
50:10
right they will send the signal okay successful and as soon as the cubernetes get the successful message for the
50:17
authentication right from the IM say now you are authenticated
50:23
okay cubernetes is only taking the login and password
50:29
okay but the authentication part is been done by I am behind the scene
50:35
okay behind the scene or other perspective would be you can think in this Okay,
50:43
you can think in this way. Okay, it means if any of my uh of my team,
50:51
okay, who already log in let's say to Jack account,
50:58
okay, to the IM because they're working on the AWS cloud. So in a car we have a
51:05
jack user already exist and this user want to use some as
51:10
service like S3 EBS or something like this they already log in okay because
51:16
Jack already log in okay or already sign in
51:22
same Jack user want to use Kubernetes okay they don't have to again sign in
51:31
okay same authentication or same session I can say
51:38
sorry same session can be used to to access
51:46
the cuber cluster or some system can be used automatically to authenticate the cubaris cluster this also one of the way
51:52
you think of okay it means it means if you log into a
51:58
system to the jack user in as cloud you don't need to login to the
52:03
kubernetes again that this is called single sign on facility
52:11
that's okay almost this is what we are going to do today okay so whatever way
52:17
you want to understand same thing no difference right so either you understand this flow
52:23
this flow this is how they're going
52:28
okay it's one of the flow maybe this is the first time you log But it's still we go to IM or second
52:37
flow would be something like this that you already log to AWS and
52:46
and you don't need to login again to Kubernetes uh to access Kubernetes resources. Okay. So whatever flow you
52:54
you have or senior you have both the case they work almost the same almost
52:59
the same maybe internally the the call API will be different that you don't
53:04
have to worry about auto they will done but uh the the whatever the scenario would be the the integration part the
53:12
way the work will be same okay
53:19
so what I'm going to do guys can get a hold for a second
54:08
Okay. So I think you got got the high idea and guys this two I am only talking
54:15
about the authentication part but how to manage the role that's what
54:20
we'll discuss the next go. Okay. So to to do this setup what I'm
54:25
doing right now. Okay. Right now what I'm going to do I'm going to launch a pure EKS cluster
54:33
the way we launched till date. Okay. But my approach would be
54:39
I am going to okay and I'm going to create one user
54:45
called viml AWS user here. I give this user power to
54:52
access all the services of AWS.
54:58
Okay. And then from this user I'm going to
55:03
uh deploy Kubernetes with the help of VK service. That is what we have seen till date. No difference. This exactly we
55:09
have done till date. Okay. Why I'm doing this again one more time? There's some reason after the code
55:15
K deploy I will tell you what is the reason. Right? So what I'm going to do here
55:20
this is a pure pure um what I say a AWS IM services this a
55:28
user we have and guys this the demo that I'm going to show you today is very very
55:33
useful in the real world we mostly always we need this EKS is huge demand in the
55:40
market so whichever company you guys working on you will work this is the one
55:48
use case you have to do initially otherwise thing won't work in the next scope
55:54
so this is a very realistic example very advanced topic also but I'm trying to
56:00
make this topic very very simple as much I can okay so but the consideration
56:06
would be you have some basic idea of IM initially you should have basic idea of cubernetes IM or rollbacks initially
56:14
that what I'm considering link here if you think you are new in cubernetes
56:20
roll back concept so I asked my team they will give you some extra one or two extra video of mine classes of
56:25
cubernetes then I explain the cubernetes based IM and the role concept
56:37
okay or if you guys are new in AWS IM I ask my team to give you my IM classes to
56:43
you so this is only the two prerequisites it. Okay. Otherwise, I
56:48
will uh show you the entire integration part. Okay. So, I'm going to create a
56:54
user that's called vimmel AWS user. And this user guys, I'm going to give
57:00
some power. Right now, I'm going to give a all power. Okay, it's not good
57:06
practice, but let me give because we are not purely in the AWS related thing. I'm going to give all power to this user.
57:14
Okay. And that's all. And the user created. Okay. And in this user, what
57:20
I'm going to do, I'm going to give some
57:26
uh a API key to create. So I'm going to create a API because I want to access this user from
57:33
the command line. Okay. And next. And create. this is
57:39
created because my intention is to go to my command line.
57:46
Okay. And use the AWS configure command.
57:52
Okay. So guys, if you want to access AWS from the command line, okay, you can use
57:57
this command. But for this, you have to first time login to your command line. Okay. And here
58:05
you have to give your access key.
58:11
Okay. And your secret key. Okay. So for a minute I just stop sharing my screen. I don't want to share
58:17
my secret key over here. I just paste over here my secret key. That's all. One
58:23
minute. So this a ps thing. Nothing very new. So
58:30
I just give it my uh secret key here. I'm working I want to work in Mumbai region and that's all I log in here. So
58:39
now I've logged to my AWS from a command line and I told you guys my initial
58:45
class of EKS. Okay, you have to first login then only EKS command work because
58:52
this command also check the login and password from this command.
58:57
Okay. Now from EKS perspective how many cluster I have at this point in time no cluster that's what you can see from EKS
59:04
also in Mumbai I have no cluster so right now my initial plan is my initial
59:10
plan here is my initial plan is uh I want uh to set
59:18
up the cluster that you know how to set up okay so what I'm going to do I'm
59:23
going to use ekl or maybe can use some kind of uh file that you know in my last class we
59:30
discussed about the file. So I have this file already with me okay so in this file we have written how what kind of
59:36
cluster we need. So I'm going to create a cluster okay
59:43
with my cluster name let's say is uh vimmel personal cluster
59:49
I'm going to create an ep this file we have discussed my last class in very detail very advanced files
59:55
we also discussed this is a command this is a file for eksl tool we're going to
1:00:01
create a cluster in Mumbai with this name and to node go we are going to create node one node two with first node
1:00:08
we have two uh node with SS allowed second also we have
1:00:17
two so total four worker node we are going to create nothing special very small file it is okay and we'll use
1:00:25
ekctl command okay ect command let me check the
1:00:32
version which version I have here okay I think this is the latest version
1:00:38
So we going to use eksctl command to create the cluster
1:00:45
and the cluster difference will take from this file. That's all.
1:00:50
So cluster start guys creating okay but this cluster
1:00:56
we creating a cluster okay by
1:01:02
accessing the service. So to access the service we need some
1:01:08
user of AWS. In this case we are using this user.
1:01:17
Okay. This user have a power to access this service
1:01:24
and in the service this user have power to create a cluster. That's what is happen. But it is outside the cubernetes
1:01:30
world. Okay. This user have no idea what is
1:01:35
happening inside the cubernetes. They have no idea what is port, why deployment, what is service, what is
1:01:41
replica set and all the things of cubernetes. Only this user know how to use this
1:01:47
service EKS and and uh create the cluster, delete the cluster, all the
1:01:52
things they can do. Okay, that's what I'm trying to tell you from this this part also here. Okay. So
1:02:00
this user can only able to access these concepts or these
1:02:08
uh access or these uh kind of uh features.
1:02:13
Okay. Because this is related to EKS or these related to AWS they can uh
1:02:18
describe the cluster they can uh delete the cluster or add read the node group
1:02:24
add the node group. All the things they can do. Right now in my case I have given all the power. So this user in EK
1:02:31
service can do anything in the EKS only in EKS that's all okay but not
1:02:38
inside the AWS. So ignore inside the Kubernetes okay how to do that's what we discuss in
1:02:44
a minute. Okay I think this part is nothing tedious. This is what we have done till date.
1:02:50
Okay. Now by the meantime my cluster is going to set up. What I'm
1:02:57
going to do I'm going to explain for the concept right. So my first guys plan is
1:03:04
we have to set up the authentication part. How single sign on?
1:03:13
Okay. How to do? We'll see by the after the cluster has been launched. Okay. So
1:03:19
what you will see after the cluster has been launched. Now in this cluster till date guys we have login from only from
1:03:26
one user. Okay. But now onward what you will see
1:03:32
what you will see in your cubernetes cluster.
1:03:38
Okay. We will create multiple user for example women user Jack user Harry user.
1:03:47
Okay. All those user will able to login inside the Kubernetes
1:03:54
to access Kubernetes resource type like deployment for example.
1:04:01
Okay. But interesting thing is I am not going to create this user
1:04:07
inside the cubernetes that in the local database that's not we are going to do
1:04:13
all this user will be create in AM
1:04:18
of AWS that's what I cons I explained to you in
1:04:24
the simple term to conclude the authentication part of these user and user management part
1:04:30
is done by IM. So this part is done by IM. How to set up this? That's what
1:04:36
we'll I'll tell you in a minute. Okay. But the next part is
1:04:42
after user login. Okay. Let me take the example of Harry.
1:04:50
After user login, Harry login
1:04:55
to Kubernetes. Okay. either they login directly or they
1:05:02
log in via IM does not matter but in this case we are going to set up via IM
1:05:07
that's what the right uh way to set up this environment is okay why I want one
1:05:14
centralized user management tool to manage all the user identity across all the platform running on the top of AWS
1:05:22
maybe as own or maybe Kubernetes or the other platform also okay so Harry will log in once
1:05:29
maybe here in IM but can access this single sign on.
1:05:35
So technically authentication is managed by M. That's what I told you.
1:05:40
But after authentication part okay after authentication part right
1:05:46
uh in the Kubernetes there's lots of resource type okay again let me write like code like
1:05:54
deployment okay like like uh services
1:06:00
and you also know guys one thing in the cubernet is all those resource type is managed per name space
1:06:09
we might have hundreds from name spaces. Name space like a projects. Okay. So we have one application come
1:06:15
from a team. Okay. Let's say this is a web team. They create their own name space. Let's say
1:06:22
name is maybe team one or team A or something like this. And they managing their own port
1:06:28
deployment services. Okay. We have one more team. They will
1:06:34
create their different name space different project name. Same thing. lesser name maybe maybe database and
1:06:42
name space they have their own ports their own deployment own services
1:06:51
okay so what I want what I want okay Harry after log to
1:06:59
kubernetes authentication part is done who is managing okay today I'm going to
1:07:05
show you this managed by IM okay But after the authenticated
1:07:11
okay what power you want to give to the Harry what role you want to give the Harry
1:07:18
according to the rule what access control they have this arpe
1:07:23
okay do you want to give a Harry power to this name space or this name space or
1:07:29
both or maybe let's say you want to give a Harry a power to team a name space
1:07:40
inside this name what power you want to give. So let's say I want to give a Harry
1:07:47
a power or permissions called that there's a name space equals
1:07:54
to project let's say equal to app known as team A or web whatever name you have.
1:08:01
Okay, in this name space you are having the power only for view that is equals
1:08:08
to read only means you can only you can only run the command cube get command
1:08:13
you can see the whole port deployment but if you try to create and delete you can't
1:08:19
do you want to give this power or do you want to give power to edit
1:08:24
power is like RW power means you can create the port, you can
1:08:32
delete the port, you can u view the port.
1:08:38
Okay? Or you want to give some specialized custom power
1:08:46
means you can only view the port.
1:08:51
Okay? Or maybe delete the code.
1:08:57
Or or for deployment you can only view. You can't delete the deployment.
1:09:05
Service you can view but you can't expose the service.
1:09:13
This is a custom power. These power guys are actually known as
1:09:18
roles actually. So we want to give a view role, addit role, custom role. What
1:09:26
role you want to give to this user?
1:09:31
Okay. Okay. Based on the role, Harry can access that particular resource. If you
1:09:39
give a Harry view role
1:09:46
then Harry can only access the resources for read only that's all
1:09:53
okay this is how it this this is guys it's called rolebased access control again guys I'm not purely in the topic
1:09:59
of Arabic right those who don't know about this concept Arabic of cub it is I'll share my video where I explain very
1:10:06
step by step very basic level this concept and plus how to set up authentication and ARB inside the
1:10:12
cubernetes also you can learn there but I'm just giving a very quick basic summary here as overview so you can
1:10:18
connect the dot what we are going to discuss today okay this idea and guys here there's one
1:10:25
more term I want to give here this concept view delete put are not verb
1:10:30
or the actions right so here Harry will have a delete hour on
1:10:37
the board or date a verb on the board view verb on the deployment. This is how
1:10:43
we sit and all this group together we give a name like custom role for example are known as role this some vocabulary
1:10:50
we have here. Now point here is this is I given a very basic overview
1:10:56
where we are going to manage these settings. Typically these settings are known as a
1:11:03
rule or the policies where going we are going to apply these policies.
1:11:09
What policy where we can write? What we can write that we have these
1:11:15
different different roles. What roles? View role. I have edit role. I have
1:11:23
custom role. We can give some name where we create this role
1:11:30
in the Kubernetes or IM. This first question right after created.
1:11:37
Okay. where we create a users like we have a Harry user, we have a Jack user.
1:11:45
So where we going to create the users? Obviously if you have no user how can you connect this user to this role
1:11:53
and after you have a role and the user what we are going to do you're going to apply a role to particular user
1:12:00
okay for example I have a Harry user Harry user
1:12:10
okay and I want to give a Harry view rule
1:12:15
this rule name and this is the username. Okay, you tell Harry will have this
1:12:22
power. Okay, or maybe Tom we have one more user have a edit power.
1:12:31
Okay, this concept guys is known as role binding. So where we do this role binding means to map this power this use
1:12:39
this power. Okay, then only they will have power. Right? For example, this
1:12:44
third thing, right? This the the process will be something like this. We have to create a roles some role precreated some
1:12:51
role we have to create maybe we have to uh create a users we have to then after
1:12:58
create both the things then we do find a role binding okay point is where we create a role
1:13:05
where we get a user and where we create a role binding where means there's two platform now right AWS platform or the
1:13:13
IM uh sorry or the Kubernetes platform Okay, where we get what? So till now
1:13:20
what we understood right now onward user creation when I say user means user
1:13:27
management login and password everything we are going to do in AM service
1:13:32
AM in AWS world okay in AWS
1:13:39
that's what I explained till now so we will create all the user
1:13:44
in IM okay which all the Harry and all the things what I'm talking
1:13:50
Okay. But if you talk about role,
1:13:56
okay, role we can't create in IM
1:14:03
because IM has no idea what is running going inside the Kubernetes. IM does not
1:14:10
know what is port, what is services or what deployment. I am does not know what
1:14:16
are verb view verb delete verb I have no idea
1:14:21
that's easily guys what eas I show you this screen right if you search while
1:14:27
creating the im role or the policies okay of EKS
1:14:34
okay and try to see about the actions that you got to verb does they understand delete p verb
1:14:43
view service verb exposed service verb no
1:14:48
there's no keyword available for this because that is these keywords are internally of the cubernetes is not from
1:14:55
the AWS site whatever AWS can do as known as API
1:15:02
you can implement the security there or set up something over there
1:15:08
but what is running inside the platform maybe does not matter platform it depend on the top of AWS by yourself or by
1:15:13
services does not matter. AWS have no idea they even though they does not understand what is port also see
1:15:21
implement security is next is next level right okay so that is a reason guys role
1:15:27
we have to manage inside cubernetes only because they specialized in it they know
1:15:33
everything about it right okay and there's one more reason because in the future we might have many more
1:15:39
resource type available in the cubernet site so if you guys know about kubernetes cur CRS
1:15:46
okay lots of CDs new resource type is been created in the community called
1:15:51
extended resource types we can't have upgrade everything every time in the AWS
1:15:56
world right the point is creating the rule
1:16:02
is managed inside the cubernet only the way we have done till date so if you
1:16:08
have idea of cubernetes the way you create a role exactly same way you're going to create the role here there's No
1:16:14
difference going to come up. Okay. Plus the role binding also we will
1:16:19
do in the cubernetes only because cubernetes only the one who know the role.
1:16:26
Okay. So we have to do the role binding inside the cubernetes. So third steps also done inside the cubernetes.
1:16:34
So I'm the cub I will decide okay in which resource what role which user has.
1:16:44
which user has. Okay. So role winding also guys to be
1:16:49
done inside cubernetes al only because IM know the
1:16:56
IM user know about the username but they does not about know about the community resource sorry the cubernetes rules how
1:17:03
they bind how they apply okay so this also done inside the
1:17:09
cubernetes only challenge is in the third step is
1:17:14
okay for the cubernetes stand point of view cubernetes know the what is role is
1:17:21
what a view role is custom role is admin role is cluster admin role is cub know
1:17:27
this because this is what we creating in the cubes here
1:17:32
okay the challenge is okay cub does not know about the user right because this
1:17:38
is running outside the cuber is cub does not know who is Harry
1:17:44
who is Tom they have no idea Yeah. Okay. There's no idea. Yeah. While
1:17:50
logging to the user, if somebody try to login the way I explained to you
1:17:56
okay when somebody try to log in the way I explained to in the diagram they will go via
1:18:03
this one right. So I don't know where the diagram is. So this is what I explained to you. So if somebody log
1:18:09
into Gary people will go inside the AWS IM and login right. But but my point is
1:18:18
okay cube business have no idea how many user we have on IM Jack user whimmer
1:18:24
user Tom user because they are not creating inside the cubin local databases
1:18:32
they're not there here okay so point is if cubin does not know
1:18:37
about the user how they do the role binding okay is the role binding
1:18:45
this partic
1:18:56
role. Now give this role power this called Arabic. Now here role based
1:19:02
access control okay to your tom.
1:19:07
Okay, it's got ro binding but cub say I don't know who is Tom is I
1:19:13
don't know where the Harry is. I don't have my local database is there somewhere I don't know. So for these guys we have to do
1:19:19
something in the cuberics and the something is known as
1:19:26
known as user mapping. What I mean by this initially in the
1:19:33
Kubernetes okay what we do we'll tell the
1:19:40
Kubernetes that you don't have the user Jack but it is available inside the IM
1:19:47
take the Jack user from the IM whenever you want to do something for
1:19:52
the Jack it is not a not available in your local database but it is there in the AM name
1:20:01
go and fetch the information from there. If you want to do something on the let's
1:20:06
say Tom user you want to login or you want to set some rback it's
1:20:12
called role binding here okay it's not there but you want to know any information about the tom you go and
1:20:18
fetch the IM IM have the user called Tom go and fet the information from there
1:20:26
okay this is a one time setup you have to do where in the cubernetes and because the we launch EKS so we can
1:20:33
do this setup very very easily. Okay. And this is called mapping. User
1:20:38
mapping. Why mapping? Because this J belongs to Kubernetes.
1:20:45
This J belong to IM. But we map this.
1:20:50
Map means we create only at one place other place can able to use it. Okay. So this the one one time mapping
1:20:56
we have to do. My point guys here is this is lots of discussion I've done here but everything
1:21:05
is already available right for example creating the user
1:21:10
in IM you guys know creating the role you know or role
1:21:16
binding you know if you know the key it is otherwise we'll provide the videos to you for extra learning as a bonus class
1:21:25
everything is exactly same okay what you do in normal environment
1:21:32
no difference only difference is
1:21:37
okay now we won't create a user in cubernetes we create in IM that you know
1:21:44
how to create there's only difference okay there's you know big difference is
1:21:51
that is extra thing is going to come in this class is mapping part
1:21:56
Q field jet belong to Kubernetes but it is not there
1:22:02
okay it is mapped to the to the IM
1:22:09
there's a big difference uh you will see okay and how we going to do the map
1:22:16
that's what we I going to show you in a minute so I'm just waiting this cluster to be up and it's been launched okay
1:22:25
very quickly check ekctl. So it's launched very exactly on time
1:22:30
because I now need need this. So this is my cluster is running. Uh cluster is
1:22:36
running. So we can able to run the guys. This demo is very important very
1:22:42
advanced also. You won't get the stepby-step uh you know process anywhere
1:22:49
in the market. Right? what the demo I'm going to show you with lots of
1:22:55
intent explanation what I explained to you also right so just just try to
1:23:00
understand this because without this setup I don't think so you can able to
1:23:06
implement EKS in the real world because in EKS we want this always I don't want to create the user in EKS so in the in
1:23:13
in the Kubernetes I want to integrate from IM that's what we always want right
1:23:18
okay so we have this uh cluster ready and because test ready.
1:23:24
So while launching this cluster that I told you guys in my last class also
1:23:29
while launching this cluster automatically
1:23:35
okay automatically some information of the user
1:23:40
that is create inside the Kubernetes is update my config file.
1:23:48
Okay, again I'm repeating guys while launching this cluster
1:23:54
this cluster. Okay, inside this cluster one user
1:24:02
automatically created. Okay, there's a cubernetes user
1:24:10
and there is more like a cluster admin that have all the cluster power.
1:24:15
Okay. So one user created in internally in this cluster and they automatically
1:24:20
downloaded in my local computer my windows
1:24:26
in this file. That easy reason we can able to run the
1:24:31
cubectl command. We can see the nodes we can launch the port. We can do deployment everything we can do here.
1:24:38
For example, we have four node worker node running right and if anyone able to run the commands
1:24:45
like node command it means they have a all the power because this command able to see how many worker node you have you
1:24:51
need clustered admin power it means whichever user created inside the
1:24:56
kubernetes automatically you don't have to worry about it inside the kubernetes.
1:25:04
Okay. U is automatically
1:25:10
copy in this file. And you guys know what is the beautiful thing about this file is this file is for the client
1:25:16
config file cube command file. Whenever the cube command there's a
1:25:22
client side command for not for AWS. It command current for command for cube cluster only. It running it can be
1:25:28
running anywhere. But this command will always go to this file.
1:25:34
go to this file and u check where the cluster is running what is the username
1:25:41
password I should use okay so what I'm going to do right now
1:25:46
just to very quickly open this file okay this file is located in this folder
1:25:54
in a location called cube
1:25:59
and this is the file name I'm talking about so this is sensitive file. Okay, anyone
1:26:05
who have this file, they can access your cubernetes cluster where this file contain contain your
1:26:12
IP address of the cubernetes master. Let's go API server plus the username and the password
1:26:18
and who get this file in my case this file automatically created by EKSL command.
1:26:24
Okay. But why they in this file in package guys? This file is very big
1:26:30
because I have launched many of lot of cluster of cube varies. All information going to come up here. But the main line
1:26:35
that you have to understood at this point in time is this line. Okay. Let me show you in a minute.
1:26:46
So it
1:26:53
yeah this line. So this keyword called current context.
1:27:01
Okay guys this is the client configuration file not for AWS not for
1:27:07
EKS it is for Kubernetes only.
1:27:12
Okay. And this file is been read by cubectl command.
1:27:21
Okay. When you run any commands, every time you run ql command, they read
1:27:28
this file. In this file, what they read? They read this keyword current context.
1:27:35
From this keyword, they read two things. Where your cluster located? There's a
1:27:41
cluster information. And in this cluster what is your
1:27:46
username you have to use.
1:27:52
Okay. So it means this command behind the
1:27:57
scene connect to this cluster.
1:28:02
Okay. And this username
1:28:07
and if you want to see more detail. So detail about this guy you can find here. This go context here same names here
1:28:14
this exact same name here they tell you where your cluster
1:28:20
located and what is username you have and for the username we have a different
1:28:26
section al together let me first go to cluster right this is just a name of the cluster but if you know about this name
1:28:33
right personal cluster you can see in the top you will see lots of cluster information
1:28:42
lots of cluster information. You might not see lot of thing in your case because I have launched multiple so lot
1:28:48
of name is here but what you will see here the cluster information
1:28:56
and one of the cluster that I have here is this one and here they tell me where is my API
1:29:02
server is my master server is this what the cluster information is they are
1:29:08
talking about this this cluster this cluster If you notice guys here
1:29:15
this matching is some 2 C 43 7783 here exactly this right this cluster is a
1:29:23
keyword that tell you where your cluster located okay and plus some certific also for use
1:29:30
of this again not important right now so this file your local file
1:29:38
okay know where your cluster is
1:29:43
again this is a basic concept of Kubernetes. I don't want to go be more basic and deep but I'm just try to tell
1:29:48
you cube command is fetching the information every time from this file
1:29:54
from this file they come to know where cluster located plus same file they tell
1:29:59
you if you connect to this cluster sorry connect to this cluster which
1:30:06
username password you will use. So here they tell you now this is important part here they tell you all
1:30:13
right while using this cluster okay
1:30:18
this cluster you have to use this username
1:30:24
and guys this is just a name the detail about this username you can find here so if you see here name of AWS but if you
1:30:31
detail about this name you can find here so if you just go down a little bit you will find the detail about this name.
1:30:39
Okay. What this name is all about?
1:30:44
You will find this name somewhere here. Okay. Yeah, it is here. This name.
1:30:54
And what this name is talking about? This name is talking about Okay.
1:31:01
that this name right is
1:31:09
the detail of this name is not available in my in in my local computer at this point in time.
1:31:15
Whenever cube studio command run they have to
1:31:21
login right to cubernetes and for login I need
1:31:26
login and password and this login and password they dynamically generate by
1:31:32
running AWS command with this argument.
1:31:38
What I mean by this let me show you. Okay. So let me write this entire
1:31:44
argument copy. Okay. And this command. So what we're talking about whenever you run EK
1:31:51
command cube command you have to log to Kubernetes. Okay. But for login
1:31:59
you need login and password. Interesting thing is in your computer
1:32:04
you don't have any login and password at installed. Every time they generate
1:32:11
okay by running this command AWS command this is what written here they run this command with a service called EKS and
1:32:19
they will ask I want login a password technical login password here is called token
1:32:24
for this cluster
1:32:30
okay and in this region this is the one command error
1:32:38
if I run this command manually here. So what I'm talking about whenever
1:32:45
an anytime cubernet command get port get deployment every time they call this
1:32:52
file this file run this command and this command
1:32:59
generate this token. Okay.
1:33:04
And guys here this is token right? Okay this token is you can think is like
1:33:11
a password. This password is passed to
1:33:19
okay from cube command to cubernetes
1:33:26
okay so let me this diagram very quickly I'm trying to tell you the by default
1:33:32
setup right what they given to you don't have to set up this I'm trying to go more deep into this what setup they have
1:33:39
done for you okay let me explain very quickly it's very interesting concept
1:33:45
Whenever you guys run cube command is a pure cubernetes client command. This
1:33:50
command always read config file. This known as cube config file located
1:33:55
locally in your local computer. Okay. This file will tell you where what
1:34:03
is username and password. Sometime we type the usern password directly here.
1:34:10
There's a way we can directly here in this case they also type
1:34:16
what they done they say I am not I don't have a user password here but but
1:34:22
whenever you run this command I will run some command which command of
1:34:28
AWS they go to AWS
1:34:34
and contact to intellectually IM service
1:34:40
is not written here. Okay. Where the name come of token, token actually always exist from viable
1:34:47
IM. We contact IM. Okay. And IM give me a token.
1:34:54
Token you can think is like a kind of password those who don't know this token. I give this token to this
1:35:01
command. This command technically finally
1:35:08
this command get the token that look like this bigger one there's some limited time period
1:35:16
they're allowed something like this okay but this is like a password okay after they get the token
1:35:24
then cubectl command internally contact to your
1:35:29
cubernetes and say I have this token based on this token authentic get to me.
1:35:41
Okay. And cubectl cubernetes will check this token.
1:35:46
Okay. And confirm with IM that hey you are the one who provided this token.
1:35:51
If yes then I will allow this user to access me. And that's what they
1:35:57
happening here. You can see here you're able to access the drill of the nose.
1:36:02
You can able to deploy also everything everything you can do it.
1:36:09
Okay. And because IM is the one
1:36:14
who give this token and because IM belongs to AWS
1:36:21
and this Q is also launched with the help of EKS again belong to AWS. So they have internal integration right. EKS
1:36:28
know how to contact to IM. They have some role attached. case I im they will go and fetch the
1:36:35
information over here. But the beautiful thing here if you notice here is okay it means when I run
1:36:43
this command every time
1:36:49
they run this command and you guys know if you want to run any
1:36:55
of the AWS command okay you should have access secret key
1:37:05
okay and because I have the AWS access key secret key
1:37:12
here that is the reason I can able to run this command either manually
1:37:19
or either by ek or by by capture command it means
1:37:26
it means if you don't have access secret locally available
1:37:33
you won't able to run this command because this because you have access to security available that is you can this
1:37:41
command and this command is actually give the token to the to the cube
1:37:46
it means okay if I again run this config and change this pass secret key it's
1:37:53
wrong secret key it's not right now I don't able to run any of the config example S3 bucket right I won't
1:37:59
able to run this neither I will able to run this command also because the password is
1:38:06
Even though they are able to run guys because because they have some local store for some time
1:38:12
the expired time right after the expire time I won't able to run my point here is what I'm trying to tell you is
1:38:19
is if you log to AWS
1:38:26
with the wrong key you won't able to get the token and because you won't able to
1:38:31
get the token so none of the cubernetes command you able to run
1:38:38
see fail right you're not lo okay it means what is happening what I'm
1:38:45
trying to explain you finally it means you if you want to log to kubernetes
1:38:53
okay the authentication of the kubernetes is not happening with the
1:38:58
kubernetes right it is happening with the AWS we log into AWS.
1:39:08
Okay. Okay. We have to sign into AWS. After I
1:39:13
sign AWS then cubes will run again like a single sign on. Why single sign on? I
1:39:20
log in once AWS. I can run all the thing or services. Same time I can run the cubernetes also.
1:39:26
So I login once to AWS but able to access AWS also other platform maybe what is running on the top of AWS plus
1:39:32
the Kubernetes cluster also. That's what I'm talking about. My point is it is by default setup. You don't
1:39:37
need to do anything for this. That's what I'm also trying to tell you here is okay. So don't think that you are
1:39:45
logging to Kubernetes directly, right? Or you authenticate cub directly, right? Authentication is done this way. The way
1:39:52
I explained to you they will go via AWS only even though
1:39:58
you're doing everything in AWS. Sorry in the cubernetes but authentication every time authent
1:40:05
means it means you don't have to do
1:40:11
any integration of EKS with IM it is already set up okay but if you want to do some
1:40:20
customization then you have to do something what to do where to do that's what I'm going to tell you okay but
1:40:26
where this integration is is is happened right where this integration is Right. So let me before this let me
1:40:31
preset my key again. Right. So let me do one thing. We got to remove my key. Let me
1:40:39
create the key again for my AWS user.
1:40:44
Okay. Because I won't able to get my uh my
1:40:51
secret key again because I removed. So let me
1:40:58
delete my older IM account key.
1:41:04
Okay, let me create a access key again. I want to login from a command line.
1:41:11
Okay, let me again login. Now see here I want
1:41:16
to log to Kubernetes is not working. Now either you can log into cq directly
1:41:24
if you have cub have local login and password but I don't have and I also don't want also
1:41:30
for this in your current workspace workbench working area you have to log
1:41:37
to to AWS
1:41:44
okay with with the access key. Let me stop sharing my screen again.
1:41:53
Okay. One minute.
1:42:00
Okay. Again Mumbai you log into AWS but without login
1:42:06
Kubernetes you can work on Kubernetes C. Why this kind of single sign on facility
1:42:13
see working right? Fantastic. How is working the way I explained to you already right this command behind
1:42:20
the scene use this local config file this file always
1:42:27
run this command this command look like this automatically run they get the
1:42:32
token for this user that is already login in AWS
1:42:38
okay they get the token and the token pass who pass this command pass to
1:42:43
Kubernetes cubain field will server will cluster will verify from the IM that hey
1:42:48
you are the one who passed give this token if yes I already indicated with you H so I believe on you
1:42:57
and I will give my user access like single sign on okay the point is where
1:43:05
we have this integration right so this integration guys is
1:43:11
there inside the Kubernetes okay So this integration
1:43:17
so let's say this is kubernetes kubernetes integrated with IM
1:43:23
only guys for authentication part A ric we'll discuss this integration is there
1:43:28
with IM okay where inside the cube why because
1:43:37
if user will come to only right with cube shell command cube shell command so cube details would
1:43:46
come to Kubernetes. So cub should know from where to check the authentication
1:43:51
part. So cubernetes is the one who indicated or connected with the IM where
1:43:56
you can find this. So in the cubernetes if you run this command called get name space there are a lot of name space in
1:44:02
the cubernetes there's one name is called cube system name space
1:44:09
okay this is a name space where lot of cub internal things available
1:44:16
okay in this name space okay in this name space if you see a
1:44:22
config map in this name space admin name is config
1:44:28
map. This is short form of config map. You can see there's one config map
1:44:34
created with the name as o. And if you notice guys, if you remember
1:44:41
actually remember this name space we already been I think some class right.
1:44:47
Okay. In the normal cubernetes whenever kubernetes you never find this config
1:44:52
map. But if you launch a kubernetes with the EKS,
1:44:59
EKS will create this config map in cure kubernetes in this name space
1:45:08
and what is written in this name space. So in this config map so if you want to see in detail
1:45:14
about AWS O okay if you try to describe this name
1:45:20
space sorry this config map. Okay. What you will find?
1:45:26
Okay. You'll find Okay, this is the pile
1:45:32
where we maintaining that how my Kubernetes is going to contact to my IM
1:45:41
and which I am they have to contact because I there many more users right which I am user they are going to
1:45:48
contact or connect for the authentication part.
1:45:53
Okay, written here. And if you notice here in this file,
1:46:00
okay, what it is written here? If anyone try to
1:46:06
login, okay, to Kubernetes
1:46:13
for authenticity purpose, Kubernetes will go to AWS authentication called IM.
1:46:18
Where they go? They will go to to
1:46:25
uh let me give you a proper name here.
1:46:30
They will go to this IM rule.
1:46:37
This IM role. Okay, there's no username but they have given the IM role. What is rule? You
1:46:45
guys know but let me show you very quickly. If you go to IM in IM we have
1:46:51
rule. Okay. And if search for this particular rule.
1:46:57
Okay. This particular rule. Sorry.
1:47:07
Copy. Paste. Let me copy paste till here. Till last.
1:47:18
Copy for
1:47:24
I think this one. What a name they mentioned
1:47:35
the same right here. Yeah, here it is. This time
1:47:42
okay. So what this rule says this rule says that they have this
1:47:48
power. If you guys remember this is what we have I shown you I think some of the class of my right. Okay, my point is
1:47:56
this is the file where we are maintaining if anything Kubernetes want
1:48:02
to do with the help of OBC on the top of EK service
1:48:07
who give the power I am give the power but I am how I am give the power with
1:48:13
the help of a role which role they have to contact which
1:48:19
role has been attached to EKS this is the role attached right this is the role
1:48:24
test. Okay. But this is not right now the important part. I think some of the
1:48:30
class I think EBS class this is what I show to you. Our point here is okay the
1:48:36
thing that I was talking about guys you know what I was talking about I was
1:48:42
talking about this this mapping part
1:48:48
where the diagram the mapping this part right this mapping
1:48:54
part okay that user is going to get an IM
1:49:03
Okay, but we map with Kubernetes. This is also we have to do in this file.
1:49:10
Okay, and if you notice here there's no mapping user available is empty.
1:49:18
You have to map here. Okay, role is different thing. Ro means
1:49:25
because this cluster is launched by EKS.
1:49:30
Now Kubernetes will access with resource AWS. they can access VPC, they can access EBS. This is what the role
1:49:37
decide. Okay. But if you want to integrate
1:49:45
Kubernet for user authentication part, that is what we have to do here.
1:49:52
Okay, that what we have to do here. Okay, so let me directly do the demo guys then you understand more clearly
1:49:59
what I'm talking about. Okay. So the point is I am going to do
1:50:07
the uh the uh mapping part.
1:50:13
Okay. So how to do the mapping part? Let me show you. So in the simple term lot
1:50:18
of things I explained to you but the demo is very very simple.
1:50:24
Right? If you understand this part completely or even though if you don't know part understand right does not matter. You can do it very very easily.
1:50:33
Okay, what you have to do now if you want to log to the Jack user
1:50:41
in the Kubernetes okay you don't have to create Jack user
1:50:46
in the Kubernetes if you know how to create user in the cubain locally you don't have to create you have to create
1:50:52
the Jack user in the AM how the way you do always so I'll go to
1:50:58
my AM go to users and go and create the user. Let's say
1:51:05
user is Jack. Okay. Click next.
1:51:11
Okay. And I'm going to attach a policy.
1:51:18
Uh let's say me at nothing right now. No
1:51:25
policy user. That's all.
1:51:31
Jack has been created. Okay.
1:51:36
And I'm only going to give a Jack um key so I can login.
1:51:43
Okay. Security credentials. I'm going to give a Jack a key.
1:51:48
Command line. Okay. Uh key. Anything else? No, I
1:51:56
believe. Next. Next. created and let me maintain
1:52:01
here in the different file. So the jack is being created in the IM just like a normal IM user. I haven't given any
1:52:08
power to Jack. I don't need to give the power why. I'll tell you again the access key and the
1:52:14
secret key for the Jack. Okay. Jack is IM user with no
1:52:24
power. Okay. I am whatever power you give you give a power for AWS services. I'm not
1:52:32
interested to give power to AWS services. My intention is to create a jack for the cubernetes.
1:52:38
Okay. So this is what the jack details going to come up. So technically in AM
1:52:47
Jack user created that's what we create here because all the authentication will done from the jack from the IM and how
1:52:54
we do authentication here with the keys which keys access secret key that's what we have created here
1:53:01
okay now only thing is uh is we have to do is I am know the user created
1:53:10
okay But it is not known by
1:53:16
okay it is not known by uh kubernetes there they have one more
1:53:22
user available called check okay so how we do this part right and I
1:53:29
told you guys this term is called mapping okay what you tell the is you also have
1:53:35
one j user maybe is not locally available but is inside the
1:53:41
IM If anyone any of your client want to log into Jack with cubec command
1:53:50
okay you don't have I know but you should pretend that you have in will
1:53:57
check from IM and do the further part that the way I explained to you this how
1:54:02
uh we have to do and for this what we have to do we have to do the user mapping
1:54:09
okay where we do the user mapping that I explained uh to you already.
1:54:14
Okay, we will do the mapping in this file in this config map.
1:54:23
Okay, and how uh we can see the detail in the AWS document.
1:54:32
Okay. So again for AWS, EKS, AWS
1:54:38
O right config map something like this right.
1:54:44
So here you find some document where you can see uh the details how it look like.
1:54:54
Okay. So in the config map available o
1:54:59
maybe there's a full config format you can find here or they might give you some examples also this is we don't need
1:55:06
right now config map there's a description of config I already show you
1:55:13
right the role I'm not interested right now I'm interested in the user mapping
1:55:18
okay if they have the example okay so role binding I'm not interested
1:55:24
right Now I'm interested on
1:55:32
mapping part. Okay. If the example
1:55:42
yeah this is what I'm looking for. Okay. I'm looking for. So in this file
1:55:49
we have to update this line. Which file? This file.
1:55:54
And you guys know if you want to update anything in the cubernetes you have to use edit
1:56:00
command. Okay, not in the map role but in ter of
1:56:08
the map users and what I want to map.
1:56:14
So let me copy from here till here. Copy
1:56:20
and
1:56:25
paste. Okay. And now what you have to do?
1:56:32
Okay. What you have to do? Okay. You have to tell
1:56:37
that we have one user. I'm going to write here. We have one user.
1:56:43
Okay guys. Now there's two things here. This is username and user ARN. This
1:56:49
username is with respect to Kubernetes. Okay. In the Kubernetes what username
1:56:55
you want to pretend here this not part of Kubernetes but for the user of the Kubernetes they feel it is user.
1:57:01
Let's say in my case Jack
1:57:07
now perspective now one more user created called Jack. But there really exists here. No. where they exist in the
1:57:13
IM where in the IM over here.
1:57:19
So here they exist with the name called Jack and if you guys know in AWS every
1:57:26
AWS entity resource has some unique name is called ARN. This is the ARN of Jack.
1:57:33
Okay, this is what we have to write here. So this is the ARN of the Jack.
1:57:40
Jack is a user belong to this part account. this part of account okay
1:57:47
account and this IM user that's all guys
1:57:52
okay okay this is how we can uh map this you know I was talking about mapping
1:57:58
right this how we map okay and uh I don't need anything about
1:58:05
groups okay so let me remove this part groups
1:58:11
what group we might discuss I'm only interested on
1:58:17
user that's all guys it means if you're 10
1:58:22
user then then this 10 entries you have to map that's all finally user then the jack uh AWS
1:58:30
password is maintained there but anybody who log into kubernetes
1:58:37
with jack account they will take f the information for me and do all the activities
1:58:42
okay This how uh uh this is how it work. So let me create two more three more
1:58:49
users right. So we can do multiple demos. So in IM I'm going to create uh one more
1:58:55
user. Let me get two user one one J we already created. Let Tom user. So this I'm going
1:59:03
to create an IM. Okay. I'm not to any of the policies. My
1:59:09
interest is not to connect this user with AWS thing. This user created called
1:59:17
Tom and I need access secret key. Why? I'll tell you in a minute.
1:59:24
Okay. So I'm attaching the access key secret key to this user called Tom.
1:59:32
this access key of the
1:59:39
tom and uh the secret key for the tom is this one. So this two user we created in
1:59:46
the IM know but cub does not know. So I'm going to do one more a rn or mapping access
1:59:54
mapping user. Okay, this is a YL file properly indent
2:00:01
and uh the Tom has this R A R N that is actually Tom
2:00:08
this IM user and this is the Kubernet user you can give other name my also here this is also okay anybody lo my
2:00:14
atomic Kubernetes they map to this user that's also be done but mostly we all do give a same name that's all
2:00:21
okay so this mapping part one time setup we have to do in
2:00:28
Uber it is only in this config map. This is what they in integrated to the AWS and we
2:00:35
save this file and close. This mapping has been done. Let me very
2:00:42
quickly check and confirm with the describe command. Okay. Now we have two mapping command.
2:00:48
This is what the details. I don't need this one even though we can remove also but what the meaning of this line will tell you. I'm interested in these two
2:00:55
lines. Okay. Now point is this is the mapping we have
2:01:02
done. It means it means anyone who log to
2:01:10
Kubernetes with Jack account they will fet the information from here.
2:01:16
Okay. Information from here. Okay. Point is how they login.
2:01:22
So Cubernetes have their own login command. you know cubernetes login command cube
2:01:28
login some command but we don't need to do go for this right I show you already
2:01:33
because we have by default single sign on setup it means
2:01:39
in your local computer if you log into jag with AWS if you log into AWS
2:01:45
automatically log into kubernetes okay this what I I explained to you
2:01:51
already it means It means right now guys we are working
2:01:58
on cubernetes thinking thing work fine no challenge we will login some of the internet user
2:02:03
okay everything work fine but my point here is okay if I log to in the current
2:02:11
computer or your local workspace to the jack
2:02:19
okay copy
2:02:24
Paste. Copy. Paste. Guys, this is what we're doing.
2:02:30
We're logging to Jack with AWS.
2:02:36
And I told you guys, if you log into AWS, automatically
2:02:42
you log to Kubernetes. Why? Because whenever you run any
2:02:49
cubernetes command, cubernetes behind the scene,
2:02:55
okay, run the token what I given to you.
2:03:00
Okay, internally they run this token and this token guys will fetch the token
2:03:08
of this user. This user Jack
2:03:14
here they get the token for Jack. It's not visible here but they get the token for check or they get the token of the
2:03:20
currently login user in this case check okay it means if you log to Kubernetes
2:03:28
sorry AWS you can able to get the token okay and you're able to get the token
2:03:34
then if you try to run the cubic command it will work
2:03:40
okay guys see here it is working there some error come up there's nice error
2:03:45
come But it's working. Even though see the post also it's working. You're
2:03:51
getting error. That's nice. Why the error come up? But something's happening right.
2:03:56
But this line says this line says you successfully log into
2:04:01
the jud. Okay. Why this error come up? We'll
2:04:07
discuss in a minute. Understand one thing guys. This line says you are able to log to the Jack
2:04:14
user. Not to Tom, not to other admin users. This line is says it like a successful
2:04:21
but now why the line means this line says we try to log to the jack user and we
2:04:27
successfully login but from the jack user you want to see the node information port information
2:04:33
because you don't have arbback setup yet for the jack there's a reason they're failing
2:04:41
authent
2:04:47
okay is done. So point is what we have done nothing guys lot of discussion is
2:04:52
going on right but the point is this is the only thing we have done right what we have done everything is otherwise pre
2:04:59
setup only thing I did is this part I'm sorry so even though this command I
2:05:06
can run because I log out from main user okay but only thing I update in this file or update in this file what file I
2:05:12
show to you okay now why this error is why this
2:05:18
error is coming. Okay. To uh to solve this error, what we
2:05:24
have to do. Okay. Let me very quickly tell you what and where we reach.
2:05:31
Okay. So now we have a Jack user, Tom user and one more user I have by
2:05:38
chance is is
2:05:46
a user for example. Okay. Or let me create a different user altogether. I'm going to create a
2:05:52
different user altogether. Okay. I'm giving a name admin user. Or
2:05:58
let's say cube admin user. Okay. I'm just creating new user here. This user
2:06:03
I'm going to give some extra power also. But I want this user
2:06:09
will have AWS power also.
2:06:14
Okay. Which power? Let me go for admin power. Let me give a power user power.
2:06:20
This is a power user power I'm giving to this user. Okay.
2:06:26
Click. So this user have some extra power. And
2:06:33
if you want to use this user, you can create a access key secret key the way
2:06:39
you do. Okay. So this is one more user I created
2:06:47
here cube admin user. This is access secret key or this is access key or this is
2:06:53
secret key for this user. Okay. So what this user have they have
2:07:00
some extra power from AWS also what power they have with this user we can uh
2:07:07
we can do something um AWS service related thingers also right
2:07:14
a minute I want to do one more small thing before I go ahead let me log into this user
2:07:22
okay in AWS with this access key
2:07:29
and the secret key. And you guys know as soon as you
2:07:36
access to a user with some access key secret key
2:07:43
and if this user have a power in regular services especially the EK service because this user I given a power to
2:07:50
power user that has all the service power with EKS power also that user also
2:07:55
work as a as a cubernetes admin user.
2:08:01
Now you can see everything is working fine. is is still not
2:08:08
get uh I don't know I've been logged out
2:08:14
myself format not actually initially I created this
2:08:20
one right so I update this guy format
2:08:25
initially I created the user value let me give the power to this user guys
2:08:33
okay let me login to this user. Let me give access key secret to this guy.
2:08:39
1 minute because initially I created this user.
2:08:45
Okay. 1 minute. So whatever user you use initially for
2:08:52
uh for creating the EKS cluster that would become your admin user of the Kubernetes right. So let me give this
2:09:00
user sorry get the access of this user
2:09:06
because I I think I logged out from my cubernetes I can't do much there. So I'm just trying to log in again to my admin
2:09:11
user of cubernetes the same user that I
2:09:17
used for initial setup right
2:09:22
now it will work yeah so like I'm come back to this point what I'm talking
2:09:27
about right so my point here is okay we have lots of user
2:09:34
okay let's talk about do user that is user created am
2:09:39
Okay. Now way the setup we is doing my Kubernetes know what Jack user is. My
2:09:47
cubernetes know what prom user is. They mapped
2:09:52
already with this user. How we have mapped this? I show you already in the
2:09:59
config map. This how they mapped. Forgot this lines. This is what they mapped.
2:10:07
Okay. It means in your local workstation if you log to Jack
2:10:15
directly to the IM diag.
2:10:21
Okay. How we login with as config command internally
2:10:27
once login you'll be able to log into cubis also means you will achieve single sign
2:10:33
that's what I showed you already very quickly I want to show you one more time
2:10:38
okay one more time if you log to AWS
2:10:44
with the jack this is the access key of the jack
2:10:50
and uh secret key of the jack. You log into AWS.
2:10:57
Okay, you will automatically log to
2:11:03
the Kubernetes and how I I know I log into Kubernetes because this is what they say that you
2:11:09
log to check. Okay, so technically these lines somehow
2:11:15
will help me to tell that you're login successful done. But error we are getting right here. Why? Because right
2:11:21
now what we have done the authentication part by this mapping.
2:11:28
Okay. Second what we have to do uh roll back part. Right. I logging to user
2:11:34
called Jack but Jack don't have power on the ports.
2:11:39
Okay. Why they don't have power? Because this power we does not give yet. This what the error is. Jack you are login. I
2:11:45
know we have seen you because you authenticated decision. I know you but you're forbidden even the author login
2:11:52
you're forbidden right you can't do anything in the port
2:11:58
you can't do anything in the deployment why because you user has not been given
2:12:06
any role binding we have the rules or maybe you can
2:12:12
create create custom rules but there's no role binding for
2:12:19
Okay, there's no role bending for you. And now this part guys is purely cube bend thing. This role, this concept is
2:12:26
not at all related to EBS or IM integration and all the thing, right? I
2:12:31
told you already role we have to create inside the Kubernetes.
2:12:36
The way I explained to you is a pure Kubernetes concept. Yeah, role we have to create inside the
2:12:43
Kubernetes. Lot of role is pre-created. some role you can create by yourself. There's custom rules.
2:12:50
Okay. And uh this part we have done in the AWS
2:12:57
with IM and role binding is again the part of cubernetes only the way you do the uh role binding. So it's a pure
2:13:04
again the the cubernetes thing but before the role binding you have to do the mapping part that part done.
2:13:11
Okay. So there's a two-part purely on the uh side of
2:13:18
cubernetes. But let me show you this demo very very quickly. You can find lot of example in the market also for
2:13:25
creating the role and uh creating the role binding. I have one quickly created code with me. I'll share with you but
2:13:31
it's a purely cubernetes thing. So I have
2:13:38
uh this file road map and we have one file here.
2:13:47
I'll share this file to you. In this file we are going to create a role with
2:13:53
this name technique. Here we are going to create a custom role. Okay. So let me
2:13:59
give a name of role is called my custom
2:14:05
uh role. Okay, let's say one
2:14:10
in this role what we are doing. Okay, we are giving creating a rule for
2:14:16
allowing all the resources of Kubernetes maybe ports, maybe
2:14:24
deployment. Okay, only for get and list.
2:14:31
Okay, only for get and list. Not to create, not to delete.
2:14:37
Okay. So this custom role is for only for read only kind of thing.
2:14:43
Okay. This is what we are. So these are rules. All the resources of Kubernetes we can
2:14:49
get. Okay. All the Kubernetes extension we also get
2:14:56
okay this is what the role is. So those who know cub is very commonly used file we create to create custom role. This is
2:15:03
what I'm talking about. creating the role.
2:15:10
Okay. Plus the same file we are doing is a role. We are getting a role. Same file we are creating a role binding.
2:15:20
Okay. Where we're binding to the user and what username you want to bind that
2:15:25
we already created IM right let's say a Harry user. Okay. So I'm just giving a username
2:15:30
Harry.
2:15:36
Okay. So we have a user kind user called Harry.
2:15:43
Okay. And this user we are going to bind to a role. Which role? This role. In my
2:15:51
case I created the role with the name called my custom role RO1. So even let me give the name vimmel.
2:15:59
Viml custom ro1 myl for example.
2:16:05
Okay, copy and
2:16:11
this again the pure kubernetes thing right this is what exactly I explained to you
2:16:18
okay where we get this user in IM where we get this role in Kubernetes
2:16:25
where we binding again the cubernetes this user is going to bind this role see here this is what I explained to you
2:16:34
okay this is pure be very interesting. Okay, so that's all right. And let me
2:16:40
use the word maybe my cluster
2:16:46
role binding for Jack.
2:16:57
Just a name. Let me save this and you run this file.
2:17:02
Okay, right now if you not guys uh if I try to do anything from the Jack I won't
2:17:09
able to do because Jack have no power to give the Jack a power. We have to run
2:17:14
this file and this file can run only by admin user of the Kubernetes. So let me again log to the admin user of the
2:17:19
Kubernetes. You can't have to login directly. AWS login will give you login access. So
2:17:25
again I'm logging to the uh come on I always
2:17:32
let me I think we already have so login
2:17:38
with admin admin is the one who are the one by default who through which we
2:17:44
created the EKS cluster. So this admin user have all the power
2:17:49
and this user have power to run this file. How to run this file is a pure cubernetes file. I'll run this
2:17:56
f file what the name would be. That's all. Now this part is done right. So role has
2:18:05
been created and role binding has been created.
2:18:10
Okay. According to this role binding if you run the command called cuber ctl get
2:18:17
ro b b b b b b b b b b b b b b b b b b b bing ro b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b b bing where the great
2:18:22
or cluster binding whatever the line would be.
2:18:28
So
2:18:35
okay there lot of cluster role binding we have something pre-created in the cuberase but one you will find the way
2:18:41
we created here my role what's what are the name I given
2:18:46
this one right so this role binding we have and uh if
2:18:54
you just try to see the detail how this role binding look like
2:19:00
that we created. Let me describe this inside this binding what you will see.
2:19:07
Okay, this is what exactly this is what role binding is right.
2:19:13
This what you say we have one user called Harry.
2:19:19
Okay. And we have given this hole.
2:19:25
But interesting thing is Harry is not available in the Kubernetes.
2:19:30
But still they know Harry. Why? Because we have done this mapping.
2:19:36
I am you know this mapping we have done.
2:19:42
This mapping from here they know who who is Jack user.
2:19:48
Okay. Yes. So it mean any jack user login they give you Jack user
2:19:54
they give you Jack user Jack user no sorry Jack
2:20:02
uh I don't know why I use Harry here why I use Harry I have Harry user no uh let me update this line I mistically given
2:20:11
Harry uh right so one minute let me update
2:20:16
this file which file this file that username I have is not
2:20:24
Harry Jack. Okay.
2:20:30
Even the Harry also work in the future in user come up automatically they bind.
2:20:35
So let me create for Jack.
2:20:41
Okay. add uh cubectl
2:20:48
apply EKS print.
2:20:54
Okay, the updated we apply means anything want to change you want to change. Now if you see here we have a
2:21:02
jack user we give this power and jack user we know Jack user exist.
2:21:09
How from here we know check user exist from the IM okay and again the power
2:21:16
that I given is this one all the resource of Kubernetes they only
2:21:22
give get they can't create it means now if I log into Jack user
2:21:31
okay because we are single sign on setup as soon as you log into Jack user
2:21:39
you authenticated to Kubernetes also that part done automatically and here
2:21:44
the help of mapping come in play okay but after you log in now if you run
2:21:50
the human command guys if you remember last time I facing the error that hey I
2:21:55
know your J authenticated but if forbidden you can't do port get
2:22:01
or list but now if you see guys here it's working right fantastic
2:22:07
I can get the code I can get the services I don't have right now but there's no service I have
2:22:15
okay why is it working because we have given the jack a role this role binding
2:22:22
that you can do view but from here if you try to create any
2:22:27
deployment for example let me create a deployment with the resume ID from the
2:22:33
image called http it will fail here.
2:22:40
Jack, I know you're Jack user, but forbidden you can't create
2:22:45
because I given the role binding that is only list and view and watch
2:22:52
like a read only. But let's say I want to give some user power to this one. So let's say I have
2:22:58
one more user with me. The Tom the user get Tom. Right here I'm going to create
2:23:05
one more role is just a role name my
2:23:10
role for let's say Tom RW role I want to give
2:23:16
where I want to give all the resources especially node and code
2:23:23
okay a getter but deployment I want to give create role
2:23:29
so anyone who have this role in the deployment they can create but in the port they can only list
2:23:38
that's what I want to give and this role I want to give let's say do a role
2:23:43
binding my role binding for Tom for example and
2:23:52
here I'm binding for the user called Tom that's all which this role which role
2:24:00
this role
2:24:05
Guys again just I'm trying to quickly explain this concept but it is pure cubernetes concept if you go go for CK
2:24:12
class admin class of cubernetes you can learn this concept for very basic lot of advanced thing also we
2:24:17
discussed there okay so now after Tom login
2:24:24
they have this power this called tom ro binding uh crow binding we have done
2:24:29
okay but in Interesting thing is we don't have a Tom user right but we have Tom user in my in my IM right
2:24:39
so if you go to uh
2:24:45
again I am I am we have a Tom user
2:24:52
Tom user is there okay to run this file uh again for run
2:24:58
this file I have to again log to my admin user or the cluster admin user and my cluster admin user is the one who
2:25:03
through which we log in. So I have the access key for the
2:25:10
cluster admin user.
2:25:15
Okay, by this user we can run this file. This is one time setup mostly
2:25:25
this file. Now according this file we have one more cluster role binding going
2:25:32
to come up. Okay cluster role binding going to come
2:25:38
up and that give you a power to the Tom user. So one more cluster role binding come up
2:25:46
this one according this role if Tom user login they have some power they can do
2:25:51
something on deployment they can create the deployment how I see. So let me login Tom right from same laptop I will
2:25:59
login Tom and for login Tom I have a Tom IM user because authentication part is done by IM
2:26:07
role binding is done by Kubernetes why IM does not know Kubernetes internal
2:26:13
resources okay now I log to Tom if I run the ports
2:26:22
command I can the port because Tom has a read power on the port. Dom has a read
2:26:27
power on the deployment. Okay. And Dom also have a create power
2:26:32
on the deployment. Last time guys, deployment of field from the Jack
2:26:38
because Jo does have a role for creating the deployment. But from the tom, if you try to try to create a deployment, see
2:26:44
it work fantastic, right? Deployment work perfectly. Deployment created and
2:26:49
obviously deployment will create a port also being created.
2:26:55
Okay. So I think now this practical makes sense, right? You can now connect the dots what I explained to you. Okay.
2:27:01
I took long time to explain every part but this is very important point to understand especially to understand right what you can do in Kubernetes.
2:27:08
What can you can do in AWS world right? So what we have done we have
2:27:13
successfully okay very quickly if I try to revise in
2:27:18
a one minute then we'll conclude the class. So what we have done we have
2:27:25
launched a kubernetes with the help of EKS.
2:27:32
Okay. So whenever run the EKS from whichever user you use the EKS that become a Kubernetes cluster admin user
2:27:39
by default. Those who know Kubernetes you know in Kubernetes we have a cube admin user
2:27:45
that is like a cube admin user that have all the power in Kubernetes.
2:27:51
Okay. So in my case I launch a Kubernetes EKS with this
2:27:58
user. So this user is my AWS user but also work as a Kubernetes pure complete
2:28:05
cluster admin user. Okay this is one thing. Now after this
2:28:12
what we have done we have created multiple user in AMIK 2. One is Tom, one is Jack.
2:28:22
But my cubernet does not know where who is these two users. So for the cubernetes perspective,
2:28:29
Kubernetes perspective, we have mapped this user. So the cub know where the user is.
2:28:37
And how we do the map with o a AWS o config map file.
2:28:44
We map this
2:28:52
map this I can login because I log into other user but you know we map this
2:28:58
okay so this part the mapping part is done okay now it means in the future if any
2:29:06
user let's say Jack login Jack can log into Kubernetes without
2:29:12
password because we already lo to AWS As you log into AWS,
2:29:19
how there config command and check can also log into Kubernetes without password. This question doesn't sign on.
2:29:26
How? Because internally cubernetes is been kind to AWS. IM they will check the tokens from here.
2:29:34
Okay. They check the token from here. So those guys this concept is by chance if you know AWS little bit detail in there
2:29:41
concept called STS. This is what the STS they use behind the scene.
2:29:46
Okay. STS. ST means a token service.
2:29:51
Okay. If you already have a token,
2:29:56
okay, because you log into object to AWS mean you have a token. If you have a
2:30:01
token, this token you can pass to Kubernetes and access the Kubernetes services
2:30:07
without login there, without give the access secret key.
2:30:13
And this behind the scene confirms the confirm IM and accordingly give the authentication part.
2:30:19
Okay. So there's one service as again part of security service as but you can check from here in AWS we have STS
2:30:27
command actually and we can see the get caller
2:30:32
identity.
2:30:38
Okay. It will tell you that we have right now logged into Tom
2:30:43
in this account. Okay.
2:30:49
And this account can create token that's called also
2:30:55
known as STS token service token and send to other services. For example,
2:31:00
in this case Kubernetes if cubernetes say I know this user how
2:31:06
because in cubernetes we can map it. So they know about J according they came before the process
2:31:13
but because I log into Tom right now here Tom can generate token
2:31:19
that's what the service is talking about AWS this token given to Kubernetes cub will
2:31:24
confirm from IM internally somehow okay
2:31:29
and if say no I I check jock Jack you are authenticated plus I know you also
2:31:36
because we have user map in my config Yeah,
2:31:41
I know you. So I can do further thing on you. What I can do? I can do role binding
2:31:47
because you log in and according to my role binding we have given some power to you. What power do we given to you? You can only watch the port you can only
2:31:53
watch the deployment. So now further concept will be purely what you do in the cuber. It is no difference. We can
2:31:59
create a roles custom roles previously created role and do role binding to that
2:32:04
user. Okay. This is the entire detail
2:32:11
uh what do you say the uh setup here even though those you guys if you uh
2:32:17
work on uh AWS there's a ones specialized training in AWS called
2:32:24
security there's also these kind of practicals we see there in the specialized training okay by the way we
2:32:30
also going to launch one more specialized training in AWS there's very much demand the market we normally do in
2:32:38
the corporate world but this first time we open for the public world. So anyone who are interested in AWS big data
2:32:44
training or AWS data analysis training
2:32:49
okay this come into the specialized training in AWS
2:32:54
okay this means we have associate then we have professional and the last level is called specialized
2:33:00
okay there's some limited advanced training coming as specialized and there's two is very in demand called
2:33:06
data analytics training sometime previously they known as big data training Uh so we are launching soon I think this
2:33:13
week only we're going to launch if you want to interested you can join this but this cover almost all the data analytics
2:33:21
tool and big data tool very rich set of tool guys they're going to cover in this
2:33:28
training if I just very quickly give a idea okay very quickly so guys see EMR
2:33:37
clausers Athena glue leg formation, Kinesis in detail, live streaming,
2:33:42
Apache, Kafka, uh, Red Safe stuff functions, right? So, Dynamob, Indra,
2:33:48
Neptune and lots of advanced tools with lots of practicals integrations,
2:33:54
they are going to do this training, right? So those who are interested to join this
2:34:00
training uh because we do this batches in corporate world first time we
2:34:05
launching this thing to public market and mostly uh we launched the training
2:34:12
once these kind of advanced training in a year two or three years. So if you are interested to uh learn live with me you
2:34:19
guys can join update about the program fee and all the things we will soon update you in respective groups okay
2:34:25
about this tool. So by the way this is what we have done uh
2:34:32
uh we have done uh about this setup right so I believe you love this tool this this integration
2:34:39
I can say uh lots of discussion would be there to give you the context but uh the
2:34:45
demo part is very straightforward two part we have done one is mapping
2:34:50
part okay that's all in the cubernetes EKS
2:34:56
right other is whatever role binding you to give that will be your choice that from the Q&A skills you can apply learn
2:35:04
and apply here that's all guys from my side I share this file to you if you
2:35:09
want otherwise this kind of file you can find a lot in the internet okay so that is all about guys this
2:35:17
topic of how EKS can be integrated with IM step by step I explain the entire setup and the demo also that's all from
2:35:25
my side some more thing to be yet to be discussed in EKS next week we'll complete I think we'll conclude this
2:35:30
training also in next week the weekend uh that's all from my side any query if
2:35:35
you have you guys can ask
2:35:41
uh I know as not everything is in big data training also we have but some
2:35:46
topic is common but not everything right like kinesis is not there dynam is not there okay so big data training what we
2:35:55
have we launched We also have guys big data training con only big data training. uh then we focus on Hadoop or
2:36:02
Spark like a vanilla right uh tools
2:36:07
here they are AWS related tools like AMR but there's a lot of topic is not there
2:36:12
in the big data training right for example Kinesis that is part of P in AWS Denom is part of only from AWS right
2:36:20
that we're going to cover in AWS specialized training okay
2:36:29
uh I want to know how to manage LDAP using arbback that is my is this topic
2:36:35
come into the uh AWS advanced specialized security training
2:36:41
is not part of this EKS training. So if you want to integrate with LDAP or
2:36:46
active directory or OIDC with AWS all right you can do do so
2:36:53
identif solution for example assemble solution for example all right we can do so uh
2:37:01
but those thing come in the AWS security training okay we covered uh there in
2:37:08
some part advanced part some part is there but uh but this is is a pure topic
2:37:14
of security. Okay. In advanced time there's some discussion over there we will discuss
2:37:19
but uh but there's lots of things to be implement in YDC or uh LD or AD
2:37:27
integration right does not come in the advanced training also advanced training is more about uh planning architecting
2:37:35
optimize the resources right advanced training is not only for security perspective this tool come in the
2:37:41
security part if you compare that both the content of advanc AWS and the
2:37:46
security telling you you come to know the difference right
2:37:56
multiple client can log into as access key it's like config comma right or even though if you guys know in in the as
2:38:03
config comma we can get profiles right we can create the profiles okay we can
2:38:08
switch the profile you lo different user that's all so login to hundreds of user give per multi profile in as config we
2:38:15
can create a profiles Switch the profile you log into different user. After login different user you log into different cubend user.
2:38:21
So this it is something like this. Okay.
2:38:26
Anything else guys to be discussed here?
2:38:34
Okay that's all. So see you guys. Uh I think some questions we have.
2:38:47
So uh let's see mayor I I don't think so we
2:38:54
need to do any integration with RDS it's pretty straightforward thing ingress controller we'll discuss mayor in my
2:38:59
next class okay RDS is database service so you just you need to map your ports
2:39:07
or application right ask the application this is the connection URL that's all so nothing much to be done in the RDS with
2:39:14
EKS. Okay. And uh that's all uh actually in
2:39:23
HCD database we are maintaining the state information of uh cluster.
2:39:30
Okay. So only state information means the state of the node state of the port
2:39:37
current state the field the down these information or those information we
2:39:42
store in that CD database right not the RB arubernetes
2:39:50
master node maybe in maybe in file format on some format right but not store in HCD database
2:39:59
Okay.
2:40:07
So, uh uh when it uh secret and HCD is a pure part of Kubernetes, right, train really there's no good meaning to
2:40:14
discuss here in EKS because the the how secret work HCD work is exactly how it
2:40:21
work in Kubernetes. Okay, maybe some quick information you want I'll give to you. uh but as a as a
2:40:29
ease thread point of view there's no integration as such with AWS right okay
2:40:35
so if you want to know about secret you can uh watch my e cubernetes training
2:40:42
there we are discussed a lot about it okay but nothing much about the integration with the way I show you in
2:40:48
EBS or ELB or in the IM class there's no integration like this right
2:40:56
so I think That makes sense. Or if you want to know know more you you you can ask my team they will give a secret
2:41:02
class of my or at city class of my uh cub where it is
2:41:10
don't worry Jan whatever topic has been left we'll cover right I don't worry whatever we given in your agenda everything will be covered right so
2:41:18
maybe more than this we will cover always in all my training right so don't worry whichever topic is left according to agenda we have given to you we will
2:41:24
cover even the more than this we'll cover don't worry If you need to extend the class, we'll
2:41:29
definitely extend. Wonderful sessions today. I got many
2:41:35
concept clear today. Thank you Rome very much. So uh that's all guys uh for today's see
2:41:44
you in the next class. Uh next class again we'll pick from one some interesting topic and cover there.
2:41:50
Right. Bye. Take care. See you. Bye. Take care. Good day.

