# 26.2 Step-02- Introduction to Kubernetes DaemonSets

-: Welcome back.So let's see what are DaemonSets in Kubernetes?So a DaemonSet ensures that all of some nodes running a copyof the DaemonSet port in our EKS cluster.So as new nodes means likeas new worker nodes are added to the cluster,DaemonSet pods are added to them.So which means pod, which is configured as DaemonSet,those pods will be added per nodewith default configuration.And as we remove our nodes,means like in the auto scaling mode,when we put our cluster autoscaler enabled for our cluster,so we keep adding nodes automatically,and then we keep removing nodes automaticallybased on the workload we are getting, right?So whenever a new node is added,it is going to add a pod,which is configured as DaemonSet,is going to be added on that node.And also when the new node is removed,it is going to remove it.At the same time, deleting a DaemonSetwill clean up all the pods createdon all the nodes, which is configured as DaemonSet.So here the pod in the sense, a DaemonSet pod,so which is nothing but X-Ray can be setas it means like X-Ray related agent,whatever we are going to install on EKS,we can call it as a DaemonSet pod, right?So that respective pod will get addedwhen new nodes are added, new worker nodes,and then it will be removedwhen new worker nodes are removed like that.And then when DaemonSet is deleted,all those extra pods will get deleted.So some typical uses of a DaemonSetare running a logs collection daemon on every node,example fluidity.Okay?So we are going to do this in our monitoringand then logging sections in the later part of the course.In the same way, running a node monitoring daemonon every node.So something like CloudWatch agent for container insights,which we are going to doas part of our later parts of our section,but that is one of the examples.And running an application trace collection daemonon every node, which is nothing but AWS X-Ray.And then that we are going to do it nowas part of this section, right?So in a simple case, one DaemonSetcovering all nodes would be user for each type of daemon,and most of the time we are goingto use a simple case everywhere.Okay?So but there will be some complex caseswhere like multiple DaemonSetsfor a single type of daemon, but with different flagsor different memory, and then CPUfor different hardware types also we can use,but 99% of the cases we are going to usemeans like most of the time we use simple case,one DaemonSet covering all nodes would be userfor each type of that respective daemon.In simple terms, it is like if you create a DaemonSeton every worker node,we are going to create that pod accordingly.So that's about the DaemonSets on a very high level, right?So now let's see what we are going to dofrom X-Ray perspective in a Kubernetes cluster.So you can consider Kubernetes cluster is a EKS cluster,and then you have two worker nodes,worker node one and then worker node two.So you create a DaemonnSet.What it does is that respective DaemonSetis going to create a pod in each worker node,which is nothing but in our case,it is going to be X-Ray pod.And then, so when applications want to send the tracesto this X-Ray pod, right?So we need to expose that X-Ray DaemonSetwith any of the service to load balance that request.That's all, okay?So it is going to be X-ray cluster IP service.Okay?So which means applications now will deployour UMS deployment application or anything, right?So any application, okay,so let's consider you you have done the deploymentof that application, so it created a replica setand then created equivalent ports.Right?So now this you have exposed it with the load balancerto the external network.Now let's see the flow.What happens to the X-Ray to the external AWS X-Ray service?So as users, I triedto access my user management microservice application,and inside this UMS pod, in each UMS pod,we have configured the X-Ray SDK related configuration,which means these applications are enabledwith X-Ray related SDK features.So which means whatever the traffic comingto these applications, trace it and then send itto the X-Ray port.Those related application related developmentwe have done in our user management microservice.Okay?So now the request comes to this UMS pod,and then if it is a create user, it'll create the user,and then update it in our respectto whatever the database, whatever is configured.I didn't depict that database herebecause our core focus should be hereon our X-Ray related stuff.Okay?So now what happens?So now whatever it has done,whatever the application-related job it has done,it will try to update the same thingto the X-Ray pod, which means it is going to tracethat information and then send it.So that request might come to any of the X-ray pods,and then these X-Ray pods will have the informationabout that respect to accounts,means like that respect to AWS accounts X-Ray service.And then it is going to send that information to X-Ray.Now, so this X-Ray pod, so the UMS pod in worker node twocan also send that traffic to worker node one X-Ray pod.So why?Because it is a standard X-Ray clusterIP service load balancer, okay?So it can send to any of the pods.So this is not the generic thing like UMS podsin worker node one will sendto only X-Ray pod in worker node one,or UMS pod in worker node two will sendto only worker node two.It can send to any of the X-Ray pods,and then they will send it to the X-Ray traces.And then, as we've seen how X-Ray works,it is going to collect all the resultsand then create a trace for it,and also create the service map for it automatically.But one important thing here is you needto work on your development efforts herefrom your application perspectivewith AWS X-Ray SDK in your application.Moving on, so microservices distributed tracingwith AWS X-Ray from a network design perspective,how it is going to look like.So in our next lecture, we are going to look intofrom network design perspective,how it is going to look like,and also other X-Ray service map and then traces,how it is going to look like also.We'll see on a high leveland then move on with the hands-on activities.So I'll see you in the next lecture.Until then, bye bye.Thank you.