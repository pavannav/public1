# 5.8 Step-09- Backend Application - Create Deployment and ClusterIP Service

-: Welcome back.In this lecture, we are going to work on services with YAML.So if you remember,when we have done with imperative commands,which is with Cube CTL,we have created a backend deployment, front end deployment,and backend cluster IP serviceand then front end node port service,everything using Cube CTL.So now, equivalent YAML files we are going to defineand then do the same thing.So this is what we have implemented usingimperative commands, and now using declaratively,we are going to write the YAML manifest for that,means like kubernetes manifest and then test it.So we are going to create a backend deploymentand then backend cluster IP service.And then we are also going to create manifestfor front end deploymentand then front end note port service.And then all in all,we'll go ahead and then deploy and then test it.So let's go aheadand then start with the writing our backend template.Okay, deployment template.So as usual, again, we have five,means like 0-0 base definition and backend deployment,backend cluster IP service, front end deployment,front end node port service.So all are empty, we are going to write it now.So let's go ahead and then take our base definition,which is API version, kind, metadata, and then spec.So for deployment of our kubernetes object is deploymentand its version is going to be Apps V1.And in metadata, we are going to say nameand then labels, two things, right?So my deployment name,I'm going to say it as backend rest app, okay.And labels, I'm going to say appand also I'm going to say tier.Tier, I'm going to say backend, right?And app, I can say backend rest app.And now in the deployment, specification.So we have something called replicasand we we'll have a selectorand we'll have template.Three things primarily, right?So replicas, I'll say two or three replicas,whatever we want.And in selector we'll have something called match labels.And whatever we define in our labels of our respectiveport template, the same thing we need to provide here.So I'll say it has backend rest app, and now,in the port template, right?So what are important things here?So we will have something called metadataand port specification.Okay, two things which are on a high level, right?So now in metadata, I'll have as usual, labels.And in labels, I'll define backend rest app.And if you want, we can even define the tier, right?So that's all.And now this is my container specification, right?So I'll say containersand I'll have the name of the container,which is backend rest app.And I'll have the image, right?So image, I can get it from my Docker Hub.So let's go to Docker Hub.And if you see here,there should be something with Hello World, right?So this is the one.So let me copy 'till hereand then 1.0.0.And this is a springboard rest application.So it is going to have something called 8080 port.Good.So now, if you see,we have completed that deployment specification,we have quickly returned it in hardly less than two minutes,and everywhere, if you see, right?API, version, kind, and metadata common stuff here.And in the specification replica,selectors and then templates.And the core thing which we need to verify isthe selector match labels app is equal to backend rest appshould match with my pod template related labelbackend rest app.And which matches, we are good.So now let's go ahead and then have the node port servicefor backend, cluster IP service for backend, sorry.So we are going to create a backend cluster IP service.So let's take thisand then our base definition copy here and paste it.And the kind that we are going to create is service,and its version is always going to be V1 currently.And the metadata, we are going to have name and then labels.Two things here, okay?So let's go ahead and then define them.So name is going to be My Backend Service.So now this is very, very important, okay?Why? Because if we remember in our 0-5 services section alsowe have discussed about it, okay?So backend service name should be My Backend Serviceso that front end EngineX proxycan proxy to this respective backend service accordingly.The container we have built for our front end servicemeans like front end EngineX proxy with thisMy Backend Service in the proxy name.So EngineX pass needs this name.Okay, so good.So now the labels.As usual, the labels are going to be app:BackendRestApp.And tier, I'm going to say backend, okay?So these labels, whatever we provide in servicesideally are not leveraged anywhereother than for labeling and then filtering.But as a standard, if you provide,that is very good option for now, okay?In our current case, to follow the standard,we are adding it, okay?So now, for a service,there are three things which are important, right?So type, selector, and one more, which is nothing but ports.Okay?So now type.So for type, cluster IP is a default service, okay?So we really don't need to mention type here, okay?If you don't even mention also, it is going to directlycreate that cluster IP service.For node port or load balancer or external name,we specifically need to mention the type.So we are not mentioning it.So now selector.Selector is nothing but a service selector.Means like this service to which port it need tosend that traffic.So it is based on the port respective label.So in the backend deployment,you have the pod related label hereand it has the label backend rest app.So for that, it is going to send,so I'm going to say app is called to backend rest app.So the next thing is ports.So let's define the name of the port is HTTP, right?And we can define list of ports here, which means this isHTTP ports and then you can define HTTPS portsand then some port as 8443 and then target container portas 8443, et cetera, et cetera, et cetera.You can define here, okay?So, but for us, we really don't have any HTTPS here,only we have HTTP port, which is 8080 and which is nothingbut the cluster IP service port, okay?So let's define that cluster IP service port, okay?And next is target port.So which is going to be another 8080,which is nothing but my container port, okay?So now we really don't have anything,this is the cluster IP service.You really don't have anythingor we don't need to define anythinglike node port here, okay?So let me remove.And I really don't have any other portsso this is not required, okay?So ports is nothing but a list.Usually it is a list.So list of ports you can define.So that's about it, okay?So now we have defined the backend cluster IP port.So this completes the creation of backend deploymentand backend cluster IP serviceso let's go to that respective folder here.So I'll go to 10 services with YAMLand I'll go to cube manifestand then we'll go ahead and then create apply-Fand I'll create 02 backend service.And one more time,I'll also give -F and then 02 or 03, right?03.No, no, no.Where is that?And 01 backend deployment.So we are creating the backend deploymentand backend plus IP service.01 and then 02.So let's see if we have typed anything wrongin our manifestand then if we want to correct anything, okay?So once it creates, we'll know.Okay, both got created but we didn't see any issuesso we'll see Cube CTL get deployed, right?And it is taking a little bit of timefor my cluster to respond.So my backend rest app is up and running.So I'll also say Cube CTL get portsand my backend rest app is running.If we want to check the logs, Cube CTL logs -Fand one of the logs we can crosscheck here.So let me paste it.Okay, so started my Hello World applicationwithout any issues.So we have tested our deployment.We'll also test the service,means like test in a sense, verify our service.So my backend service, the cluster IP servicegot created with 8080 port, okay?So this complete the creation of backend stuff.In our next lecture, we'll focus on creating the front endand then testing end to end.So I'll see you in the next lecture.Until then, bye bye.Thank you.