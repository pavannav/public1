# 8.2 Step-02- Kubernetes Secrets

-: Welcome back, so let's go ahead and then implementthe Kubernetes Secretsfor our application and the database, okay?So Kubernetes Secrets let us storeand manage sensitive information such as passwordsor auth tokens or SSH keys in a Base64 encoded format.So storing confidential informationin a Secret is a safer and more flexible way,instead of putting them directlylike DB password one one or whateverin the application manifest,deployment manifests oreven the database related deployment manifests, okay?So what we are going to do is we are going tocreate a secret for our MySQL DB password, okay?So if you have Base64 installed on your Mac machineor on your Linux machine,so my DB password is DB password one one, okay?So you can directly run this here, okay?And then get the secret and then updatein your respective Secrets file.So like this our, you can go to this URLbase64encode.org and then provideyour DB password one one herein the encode to Base64 formatand then click on encode and then you'll get the value.So both are going to be same anyway,but based on your if you're using Windowsand then you don't have Base64 installedon your Windows machine,so you can use base64encode.org also.So now we'll go aheadand then create the Kubernetes Secrets manifest, okay?So if you go to this one, right?So our Visual Studio code editor,so in zero five Kubernetes important conceptsyou can see zero five zero one Kubernetes secrets.So there in our previous lecture whatever we have createdwhich is nothing but in zero four zero three, right?So all those manifests we have brought herewhich is nothing but all these seven manifests,whatever we have created we have brought here.And then we are going to live edit themby creating the Kubernetes Secrets file first, okay?So as usual,so I have put the Kubernetes standard template herewhich is nothing but apiVersion, kind, metadata,and then spec.So the kind is going to be secretand the apiVersion is from core it is V1.And now the metadata,the name of the Secret here, right?So in metadata usually we'll have nameand then labels, right?So we'll give name that's will be sufficient for us.So I'm going to say,MySQL DB password will be the name of my secret, okay?And instead of spec usuallythis will have something called data, okay?So like how the config map we create with data, right?It is the same thing.In addition to that there will be one more top level objectcalled type and type,we need to provide Opaquebecause our sees a unstructured contentwhich means like key value pairs.So we'll show what is that key value pair, no?So Opaque means, Kubernetes point of view,the contents of the secret are goingto be unstructured, okay?So let's see what does that mean, okay?So you can give, so under data,so you can give the key value pairs whatever you want.So I'm providing one key value pair hereand we can get whatever we have generated here, okay?So this is the password, right?I'm saying DB password and whatever we have generatedfor DB password one one,The Base64 format I have pasted here.So if you have something,even if you want to encode DB username,you can provideor if you want to DB host if you want to putso you can even put DB host.So like this how many features,how many you want to put that manyyou can put in key value pairs.So that's the unstructured way of putting it.So that's the reason we have providedthe type Opaque, okay?.So now I have provided DB password with DB password one onewhich is in Base64 format.So now we have completedthe Kubernetes secrets file creation here, okay?So now let's go aheadand then update our MySQL deployment.In our MySQL deployment,if you see here in the environmentsyou have name is MySQL root passwordand the value is DB password one one.So instead of value directly taking it hereyou can do one thing for this, okay?So let's remove this and say that value from, okay?So we are getting the value from secrets, okay?And from where you are getting,it is getting from the secret key reference, okay?So secret key ref is that tag here, okay?So, and you need to provide your two objects here, okay?So two attributes, okay?So name and the key, right?So from which secret it is going to bring the value.So from mysql-db-password the name of your secret.So whatever you have provided here the name of the secret.So this becomes the name and this becomes the key.So from which key it need to fetch is DB password keyit need to fetch.So let's go to MySQL deployment and paste it here.That's all, okay?So value from, secret key reference,and name is mysql-db-password,and the key is DB password.So now the MySQL root password will beDB password one one in this manner.So the same way we can implement the same for ouruser management microservice deployment, okay?For this DB password, okay?So as usual, one more time.So we'll say value from, right?And I will say secret under that the child objectis secret key reference, okay?And we'll have two child objects here.Name and then key under secret key reference.And the name is going to be mysql-db-password.And the key is going to be db-password, okay?So now we have updated wherever we have the passwordin our application,we have updated with the secret whateverwe have created, okay?So now we can go ahead and then implement,means like we can run the stuff, okay?So which is nothing but we can runthe Kubernetes manifest here means like applyor create the manifest and then see what happens.So create all the objects and then, test it.So let's go here, and if you see there are nothing runningin my application cluster now,so what I'm going to say is,so I am in the zero five zero one kubernetes Secrets folder.So I'll say ls and then you'll find only the kube manifests.And if I go there inside thatyou can find zero eight secrets.So I'll come back out of kube manifest,I'll say clear and I'll say kubectl apply -fand kube manifests.So now I should have everything get createdwhich is nothing but my secrets and then everythingwill get created, okay?So now everything got created.So now let's see what happens, okay?So kubectl get pods, okay?And this container is getting created and thisas usual the user management containeralready started and running,which might fail and then restartbecause MySQL is not ready.So this issue still exists and in our next sectionwhich is initialization containers,we are going to fix it, okay?So see one time restart happened that's fine, Okay?so now everything is up and running.So mostly,so kubectl logs,and then if the DB password is wrong,then obviously this will not come upin running state, right?We'll have issue.So we'll see that user management cameup successfully or not, okay?So it's coming up,let's wait for it to initialize and then see, okay?so if it initializes properlyand says that started user management service, okay?See started user management.So my DB password, whatever I encryptedand then whatever how we have implemented using secretseverything is working fine.Using this thing we can ensure that it is,we can ensure that it has worked, okay?So now Control + c,and then if you want we can go to our browser and thenas usual call it,the ClusterIP is going to be same and then health is same,so it is going to work.Or if you want to go to Postmanand then List all users and then seeit's going to be nothing, okay?So why, because we have recreated the stuff,everything right now.Entire thing we have deleted and then recreatedwhich means like entire,all the storage classes and then PVCeverything we have deleted from previous section and creatednothing you can see here, okay?So health status, you can see it's 200.In the same way if you want to create the user one more timeyou can create the userand go to list users and then you got the user.That's all, okay?so this completes the Secret section.So what we need to do is as we have completed thiswe'll go ahead and then delete all this stuff,whatever we have created.In our next section,again we are going to create it and then seethat how our initialization container swallowed our issue.So let me remove everything.So we have deleted everything.So I'll see you in the next lecture.Until then, bye bye.Thank you.