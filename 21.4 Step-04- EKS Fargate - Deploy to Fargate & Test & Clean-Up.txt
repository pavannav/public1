# 21.4 Step-04- EKS Fargate - Deploy to Fargate & Test & Clean-Up

Instructor: Welcome back.In this lecture, we are going to deploy our manifestand then test, verify whether they are scheduled on Fargate,and we are also going to test it using the URL.So let's go back to our command lineand then go to 09 and 0901 section, alright.(keyboard keys clicking)And we have the Kube manifests here, okay.So I am going to say Kube CTL apply -Fand then Kube manifest.Alright, and all the manifest presentin that should be created.So we have the FP dev created,app for Nginx deployment got created,NodePort and then ingress got created.So right, so first we'll verify our git namespaces,which is NS, and our FP dev namespace got created.So we are also going to verify, git ports, right?And then -N, which is nothingbut in FP Dell namespace and -O wide.So that it'll also provide the node information.So it is trying to get the two parts related to itand the nominated node stillwe didn't get the name of the node, but that's fine.It'll take a while to get the name.So it's currently in the pending status.So once the node is readythen it'll go ahead and then schedule immediately, right?So we can go back hereand then get nodes -O wide.So let's see how many nodes are there in our cluster now?So earlier you have seen only two nodeswhich are starting with IP, right?With internal, this one, these two nodes, okay?110, 1114 and then 85.8.So they start with IP-.But Fargate nodes start with Fargate -IP.So we have that two replicascreated as part of this deployment,which means we said that two replicas,so two Fargate nodes got created.So let me clear this,and I'm going to verify the ports one more time.QCTL git ports -N FP Dell -O wide, right?So these are scheduled inside this and then running, right?So I'm going to say QCTL get ingressfrom namespace FP Dell, right?So it got created means like if this name,this address field is having the value,which means it got created,means it's like there is no issues related to it.So let's go back to work.AWS management console, and go to EC2 service, right?And let's go to load balances, right?And in load balances.So we have that application type load balance that isgetting created and if you go to listeners in 40 80,we can see that the redirecting will be there,which standard which we have seen earlier also.HTTP to HTTPS, and in port 443for slash star you should have a slash star.Why? Because in ingress we have defined slash star only.Right? So why? Because this is app on only one app.Right? So I said slash star here.So it is going to one target group.So I can directly click here to go to the target groupor I can go back and go to target groups hereand then I can open that target group here.So before opening ityou can see target type is not instance here it is IPbecause we have user that target type as IP.Which means it is directly going to that port IP.So I'll open thisand this is the HTTP related health check pathand this is the target and they are healthyfrom the both nodes.You can see 158 and then 107, right?So I'll say QCTL git ports -N FP Dell, right?-: O wide right?So you can see that our port IPand our node IP in the Fargate is going to be same.You can see 107 and then 158 related IPs.You can see here them.Okay? So that's about creating it.So now if our, let's verify also that route 53 stuff, right?So FP Dell got successfully registered or not,code on cloud.com.So let me close this, go to hosted zonesand you can go to code on cloud and if you see itwe have the FPdell.Kubecouponcloud.com got created.Okay? So I'll also do, and let's look up toverify FPDell.Kubeoncloud.com, right?So it's working.So let's go back and then access the URLand then test it, right?So I'll go to browser and I'll say thisand it's working as expected, right?So everything is working.So now let's go ahead and then delete our Fargate cluster.So I am not doing anything related to applicationis running here and then I wentand then deleted the Fargate cluster.So let's see what happens.So first list the Fargate cluster, right?And then get the name and then delete it.So already we know that our Fargate profile name is FP demo.I can directly say EKS delete Fargate profilefrom cluster EKS demo oneand the Fargate profile name is FP demo.And then also provide wait statement.Okay, so wait statement will allow us our commandline to wait here until the deletion is completed.So it is nothing but FP demowe can see the name here, right?So and inside that the selector namespaceis going to be FP dev.So I'm saying EKS CTL delete Fargate profile.Cluster EKS demo one and the nameof the Fargate profile is FP demo.And then wait, right?So it'll take two to three minutes to delete ituntil then I'm going to pause the video.So it took close to four minutesto delete the Fargate profile.So let's verify minutes like earlierour app Nginx related deployment portsare present on Fargate nodes, right?So now QCTL git ports -N FP Dell,which is nothing but in namespace FP Delland then -O wide, right?So let's see what happened to them, right?So now if you see those are still presentand then scheduled on your regular worker nodeswhich is nothing but your easy to private node groups.So they got scheduled on our, if you go back hereso it got scheduled on these things, right?So it got scheduled to this private subnet.So when you deleted this Fargate profile automaticallythose got scheduled here.So that's about it.So which means like it didn'tdelete the application or anything,only the Fargate profile got deletedand the application came backto our original EC2 worker nodes.So now if you want we can even access the applicationand then it should be running no issues.I'm saying enter one more time, no issues.So I'll take it and then put it on filenew private window and then access one more time, right?Just for safe site.So everything is working fine.So this completes this respective section, which is basics.And in addition to that,if you want the additional informationthere is a references section here.Okay? So EKS CTL .IVO usage Fargate support.So here also you'll have good information to follow.In addition to that you'll also have Amazon documentationand for ALB ingress controller relatedannotations related to target type, right?So you can find here, okayso this is, from last third one here.Okay? So you can even have itwith instance our IP and instance is the defaultand you can have them on ingress or service.So let's go ahead and then clean up the stuffwhatever we have created so far, right?So Kube CTL delete -F kube manifest.Okay, so I can copy thisand let's go here in 0901 Fargate profile basicdelete whatever we have createdso that all the ingress manifest, load balancerseverything will go awayand then it'll not cost us any money for us.