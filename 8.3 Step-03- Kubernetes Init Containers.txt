# 8.3 Step-03- Kubernetes Init Containers

-: Welcome back.In this lecture we are going to understandabout Kubernetes init containersand then implement them.So let's get into 0 5 0 2 init containers, right?So before going and then implementing them,let's understand what are theseinit containers on a very high level.Okay.So init containers usually runbefore the app containers, inside the pod.So init containers can contain utilitiesor setup scripts not present in the core app image,and then they can run before the app container runs.So we can have and then run multiple init containersbefore the app container starts.Okay.So init containers are exactly like regular containers,except init containers always run to the completion.In addition to that,each init container must complete successfullybefore the next one starts.So if you have multiple init containersone after the other,each need to execute the task assigned to that container,and then complete it,and the next one starts and then complete it.Finally, all the init containers have succeeded,then only the app container will start.So if a pod's init container fails,Kubernetes repeatedly restarts the poduntil the init container succeeds.However, if the pod has a restart policy of never,Kubernetes does not restart the pod.So you can even consider this as oneof the example of your multi-container pods.Okay, so earlier we have seenin our initial Kubernetes fundamentals,we discussed about runningonly one container per Kubernetes podbut if you want to run multi-container podsso these are some of the examples,like init containers, or N Y proxy, are few of the things.Okay?So, now let's go aheadand then implement the init containers.So, let's see what is this actually.Okay, so under the pod template spec,so which is nothing but empty init containers,will be one of the equivalent level two containers,whatever we see in our pods.So let's go hereand go to user management microservices deployment.So you see here, containers, right?In the same level you can have the init containers.Okay.So init containers.So that's the thing I'm discussing here, okay?And so you can have the name of your init container,and we are using a simple BusyBox image here,and then what we are going to do is,so we are going to check from our use init containerin user management pod thatwhether my MySQL service is up or not.So everyone, every time,in a whileloop we are going to say NetCat hyphen Z MySQL,which is nothing but the MySQL cluster AP serviceand then 3 3 0 6 port.So I'll keep checking regularly until and unless it is up.So once it is up I can say MySQL DB server has startedand then this task will be completed.The init container task, whatever we have provided,it will be completed and then it will moveon to the containers present in the container section,which is nothing but our user management REST step.Okay.So let's copy this stuff herefrom wherever we have, everything.So let me copy these things.All right.So, and paste it.Okay.So under init containers.So we have the name init DB,and the image is BusyBox image we are using,and the command we are going to useis a shell script with the NetCat, hyphen Z,under shell NetCat hyphen Z and then MySQL 3 3 0 6.So let me save thisand we have used the all other templatesas-is from our previous 0 5 0 1 sectionand we updated only user management microservicedeployment section with the init container.So now let's go ahead and then test it now.So you should be in 0 5 0 2.So let me go for 0 5 section, important conceptsand I should be in 0 5 0 2 Kubernetes init containers.Okay, so now let's see.The next step is to create the Kubernetes manifest,means like create all the Kubernetes objects.Okay.So, kubectl apply hyphen F kube manifest.Okay.So, now it needs to create the pods.So, let's see what happens.So, now we can watch the pods,kubectl get pods,and you can see that init container is running now.Okay, so we can even put in the watch mode,hyphen W means kubectl get pods,hyphen watchmode means whatever is happening.So, now MySQL got running.So, that now in init container should pick it,and then it should be successful,and then start the user management container next to that.Okay.So now see init container is successfuland then it is initializingthe user management container inside of that.So, pod is initializing inside that,and we'll wait for it to be in running status.So, it's running now.Okay.So, now let's see one more time,kubectl get pods,and our user management microservice should be running.So, now one thing we need to do here is,so, in the kubectl get pods output,you can see that there is no restart happenfor our microservice, okay?Because it waited for the MySQL container to come up,and then only it started the user managementREST app container insidethis user management microservice pod.Okay.So, now one thing important here,we need to see is describe the pod.Okay.So I'll say kubectl describe podand this complete pod information.Okay.So, copy and then paste.So, what we are going to see is,like we can see two types of containers present here.So let's come up, okay.So successfully assign the pod scheduling,and then to the default namespaceand then it has the container image,and then it created the init DB container,and then once it started and then it completed,then it started running the next containerwhich is user management microservice.Okay.So created that containerand then started that container.So, now the one thing we need to see hereis what all containers, right?So if these are the events,whatever we have seen, what happened.In addition to that, we canalso see init container here, right?So, which is the init DB container.So, it executed the command whatever wehave provided inside thatand verified that MySQL DB server has started or not.So reason is completed, you can see, right?It completed.So as soon as it completes, then it immediatelyterminates that container.Exit code is going to be zeroand then it'll move on to createthe user management REST app container next to that.Okay.So it created this containerand then started this respective container.So, this completes the init container concept,applied to our user management microservice.If you want even, we can access our health status pageand see that it is up and running.It's up and running now.Okay.So now let's go backand we have created and then tested.Let's go ahead and then delete that stuff.Okay.So copy and then I'll say clearand I can say kubectl delete hyphen Fand then kube manifest.So everything, whatever we have created,we are going to delete, okay?So in our next lecture we are going to see livenessand then readiness probes.Okay.So if you want more informationabout pod init containers,you can click on this and then read about those things.This is the direct Kubernetes documentation link,which will provide you more informationabout init containers.So, I'll see you in the next lecture.Until then, bye bye.Thank you.